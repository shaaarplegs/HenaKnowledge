{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.isCanvasElemSupported = exports.drawSvgOnCanvas = exports.browserDetails = exports.downloadCharts = void 0;\n\nvar _svgdecanvo = _interopRequireDefault(require(\"../_internal/vendors/svgtocanvas/src/svgdecanvo\"));\n\nvar _lib = require(\"@fusioncharts/core/src/lib\");\n\nvar _eventApi = require(\"@fusioncharts/core/src/event-api\");\n\nvar _ajax = _interopRequireDefault(require(\"@fusioncharts/core/src/ajax\"));\n\nvar win = window,\n    Image = win.Image,\n    doc = document,\n    UNDEF,\n    FORM = \"form\",\n    POST = \"POST\",\n    INPUT = \"input\",\n    HIDDEN = \"hidden\",\n    EXPORTACTION = {\n  DOWNLOAD: \"download\",\n  SAVE: \"save\",\n  DOWNLOADSAVE: \"download-save\"\n},\n    isCanvasElemSupported = function isCanvasElemSupported() {\n  var elem = doc.createElement(\"canvas\");\n  return !!(elem.getContext && elem.getContext(\"2d\"));\n},\n    getBrowserDetails = function getBrowserDetails() {\n  var userAgent = win.navigator.userAgent,\n      index;\n\n  if ((index = userAgent.indexOf(\"Edge\")) !== -1) {\n    return {\n      name: \"Edge\",\n      version: userAgent.substring(index + 5, index + 11)\n    };\n  }\n\n  if ((index = userAgent.indexOf(\"Chrome\")) !== -1) {\n    return {\n      name: \"Chrome\",\n      version: userAgent.substring(index + 7, index + 11)\n    };\n  }\n\n  if ((index = userAgent.indexOf(\"MSIE\")) !== -1) {\n    return {\n      name: \"ie\",\n      version: userAgent.substring(index + 5, index + 9)\n    };\n  }\n\n  if ((index = userAgent.indexOf(\"rv\")) !== -1 && userAgent.indexOf(\"Trident\") !== -1) {\n    return {\n      name: \"ie\",\n      version: userAgent.substring(index + 5, index + 9)\n    };\n  }\n\n  if ((index = userAgent.indexOf(\"Firefox\")) !== -1) {\n    return {\n      name: \"Firefox\",\n      version: userAgent.substring(index + 8, index + 12)\n    };\n  }\n\n  if ((index = userAgent.indexOf(\"Safari\")) !== -1) {\n    return {\n      name: \"Safari\",\n      version: userAgent.substring(index + 7, index + 11)\n    };\n  }\n\n  return {\n    name: \"default\",\n    version: \"Not Known\"\n  };\n},\n    browserDetails = getBrowserDetails(),\n    sendExportData = function sendExportData(postData, options) {\n  var item,\n      form,\n      frameid,\n      iframe,\n      ajax,\n      exportAction = options.exportAction,\n      exportTargetWindow = options.exportTargetWindow,\n      exportCallback = options.exportCallback,\n      chart = options.fusionCharts.apiInstance,\n      paper = options.paper,\n      chartId = options.chartId,\n      exportHandler = options.exportHandler,\n      parameters = postData.parameters,\n      exportFileName,\n      exportFormat,\n      exportIframe;\n\n  if (exportAction === EXPORTACTION.DOWNLOAD || exportAction === EXPORTACTION.DOWNLOADSAVE) {\n    if (/(webkit|gecko)/gi.test(win.navigator.userAgent) && exportTargetWindow === \"_self\") {\n      exportTargetWindow = frameid = chartId + \"export_iframe\";\n\n      if (!exportIframe) {\n        exportIframe = iframe = (0, _lib.createElement)(\"IFRAME\", {\n          name: frameid,\n          width: \"1px\",\n          height: \"1px\"\n        }, doc.body);\n        iframe.style.cssText = \"position:absolute;left:-10px;top:-10px;\";\n      }\n    }\n\n    form = (0, _lib.createElement)(FORM, {\n      method: POST,\n      action: exportHandler,\n      target: exportTargetWindow,\n      style: \"display:none;\"\n    }, doc.body);\n\n    for (item in postData) {\n      (0, _lib.createElement)(INPUT, {\n        type: HIDDEN,\n        name: item,\n        value: postData[item]\n      }, form);\n    }\n\n    form.submit();\n    doc.body.removeChild(form);\n    form = UNDEF;\n    exportFileName = parameters.match(/exportfilename=([^|]+)/)[1];\n    exportFormat = parameters.match(/exportformat=([^|]+)/)[1];\n    (0, _eventApi.triggerEvent)(\"exported\", chart, {\n      DOMId: chartId,\n      height: paper.height,\n      width: paper.width,\n      fileName: exportFileName + \".\" + exportFormat,\n      statusCode: UNDEF,\n      statusMessage: UNDEF,\n      notice: UNDEF\n    });\n    exportCallback && win[exportCallback] && typeof win[exportCallback] === \"function\" && win[exportCallback]({\n      statusCode: 1,\n      statusMessage: \"success\",\n      DOMId: chartId,\n      width: paper && paper.width,\n      height: paper && paper.height\n    });\n    return true;\n  }\n\n  ajax = new _ajax.default(function (resp) {\n    var responseObj = {};\n    resp.replace(new RegExp(\"([^?=&]+)(=([^&]*))?\", \"g\"), function ($0, $1, $2, $3) {\n      responseObj[$1] = $3;\n    });\n    exportCallback && win[exportCallback] && typeof win[exportCallback] === \"function\" && win[exportCallback](responseObj);\n    (0, _eventApi.triggerEvent)(\"exported\", chart, responseObj);\n  }, function (err) {\n    var responseObj = {\n      statusCode: 0,\n      statusMessage: \"failure\",\n      error: err,\n      DOMId: chartId,\n      width: paper && paper.width,\n      height: paper && paper.height\n    };\n    exportCallback && win[exportCallback] && typeof win[exportCallback] === \"function\" && win[exportCallback](responseObj);\n    (0, _eventApi.triggerEvent)(\"exported\", chart, responseObj, [responseObj]);\n  });\n\n  for (item in postData) {\n    postData.hasOwnProperty(item) && (postData[item] = encodeURIComponent(postData[item]));\n  }\n\n  ajax.post(exportHandler, postData);\n},\n    dataurlToBlob = function dataurlToBlob(dataURI) {\n  var byteString, mimeString, ia, i;\n\n  if (dataURI.split(\",\")[0].indexOf(\"base64\") >= 0) {\n    byteString = win.atob(dataURI.split(\",\")[1]);\n  } else {\n    byteString = win.unescape(dataURI.split(\",\")[1]);\n  }\n\n  mimeString = dataURI.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n  ia = new Uint8Array(byteString.length);\n\n  for (i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n\n  return new win.Blob([ia], {\n    type: mimeString\n  });\n},\n    makeClientSideDownload = function makeClientSideDownload(type, imageData, name, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var browser = getBrowserDetails(),\n      chartId = options.chartId,\n      exportCallback = options.exportCallback,\n      paper = options.paper,\n      blobObject,\n      a,\n      data = imageData;\n\n  if (browser.name === \"Chrome\" || browser.name === \"Firefox\" || browser.name === \"Safari\") {\n    if (type === \"blob\") {\n      data = win.URL.createObjectURL(data);\n    }\n\n    a = doc.createElement(\"a\");\n    a.download = name;\n    a.href = data;\n    doc.body.appendChild(a);\n\n    a.onclick = function () {\n      exportCallback && win[exportCallback] && typeof win[exportCallback] === \"function\" && win[exportCallback]({\n        statusCode: 1,\n        statusMessage: \"success\",\n        DOMId: chartId,\n        width: paper && paper.width,\n        height: paper && paper.height\n      });\n      a.parentNode.removeChild(a);\n    };\n\n    a.click();\n  } else if (browser.name === \"ie\" || browser.name === \"Edge\") {\n    if (win.navigator.msSaveBlob) {\n      if (type === \"url\") {\n        blobObject = dataurlToBlob(data);\n      } else {\n        blobObject = data;\n      }\n\n      if (win.navigator.msSaveBlob(blobObject, name)) {\n        exportCallback && win[exportCallback] && typeof win[exportCallback] === \"function\" && win[exportCallback]({\n          statusCode: 1,\n          statusMessage: \"success\",\n          DOMId: chartId,\n          width: paper && paper.width,\n          height: paper && paper.height\n        });\n      }\n    }\n  }\n},\n    byteLength = function byteLength(str) {\n  var s, code, i;\n  s = str.length;\n\n  for (i = str.length - 1; i >= 0; i--) {\n    code = str.charCodeAt(i);\n\n    if (code > 127 && code <= 2047) {\n      s++;\n    } else if (code > 2047 && code <= 65535) {\n      s += 2;\n    }\n\n    if (code >= 56320 && code <= 57343) {\n      i--;\n    }\n  }\n\n  return s;\n},\n    isDataURITooLong = function isDataURITooLong(datauri) {\n  var maxChromeByteSize;\n\n  if (browserDetails.name.toLowerCase() === \"Chrome\".toLowerCase()) {\n    if (byteLength(datauri) > maxChromeByteSize) {\n      return true;\n    }\n  }\n\n  return false;\n},\n    downloadCharts = function downloadCharts(type, data, name, postData, options) {\n  var isMobileDevice = /Android|iPhone|iPad|iPod|Mobile/i.test(navigator.userAgent),\n      match = window.location.href.match(/:\\/\\/(www[0-9]?\\.)?((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])(?:[\\0-\\.0-9;-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+)/);\n\n  if (isMobileDevice && !match) {\n    sendMobileExportData(type, data, name, postData);\n  } else {\n    if (data && !isDataURITooLong(data)) {\n      makeClientSideDownload(type, data, name, options);\n    } else if (postData) {\n      sendExportData(postData, options);\n    }\n  }\n},\n    sendMobileExportData = function sendMobileExportData(type, data, name, postData) {\n  if (data && name) {\n    if (type === \"blob\") {\n      var reader = new FileReader();\n      reader.readAsDataURL(data);\n\n      reader.onloadend = function () {\n        var exportData = reader.result;\n        callWebViewBridge(exportData, name);\n      };\n    } else {\n      callWebViewBridge(data, name);\n    }\n  } else if (postData) {\n    var res = postData.parameters.split(\"|\"),\n        file = res[0].substr(res[0].indexOf(\"=\") + 1),\n        ext = res[1].substr(res[1].indexOf(\"=\") + 1),\n        fileNmae = file + \".\" + ext;\n    var sendData;\n\n    if (ext === \"svg\") {\n      sendData = \"data:image/svg+xml;base64,\" + win.btoa(win.unescape(encodeURIComponent(postData.stream)));\n    } else {\n      sendData = postData.stream;\n    }\n\n    callWebViewBridge(sendData, fileNmae);\n  }\n},\n    callWebViewBridge = function callWebViewBridge(data, name) {\n  var dataObj = {\n    edata: data,\n    name: name,\n    eventName: \"download\"\n  };\n  window.webViewBridge.send(null, dataObj);\n},\n    addSVGHeader = function addSVGHeader(svgStr) {\n  return '<?xml version=\"1.0\" standalone=\"no\"?>\\n      <!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\\n       \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"> ' + svgStr;\n},\n    svgStrToDataUrl = function svgStrToDataUrl(svgStr) {\n  var finalSvgStr = addSVGHeader(svgStr);\n  finalSvgStr = \"data:image/svg+xml;base64,\" + win.btoa(win.unescape(encodeURIComponent(finalSvgStr)));\n  return finalSvgStr;\n},\n    drawSvgOnCanvas = function drawSvgOnCanvas(options, callback) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      svg = _options.svg,\n      canvas = _options.canvas,\n      x = _options.x,\n      y = _options.y,\n      width = _options.width,\n      height = _options.height,\n      useCanvas = _options.useCanvas;\n\n  if (browserDetails.name === \"ie\" || browserDetails.name === \"Edge\" || useCanvas) {\n    new _svgdecanvo.default(svg, canvas, x, y, width, height, function () {\n      callback();\n    });\n  } else {\n    var ctx, image, svgDataURI;\n    svgDataURI = svgStrToDataUrl(svg);\n    ctx = canvas.getContext(\"2d\");\n    image = new Image();\n\n    image.onload = function () {\n      ctx.drawImage(image, x, y, width, height);\n      callback();\n    };\n\n    image.onerror = function () {\n      (0, _eventApi.raiseWarning)(this, \"\", \"run\", \"libSVGToCanvas:drawSvgOnCanvas\", \"Unable to load image for canvas drawing. Aborting attempt.\");\n    };\n\n    image.src = svgDataURI;\n  }\n};\n\nexports.drawSvgOnCanvas = drawSvgOnCanvas;\nexports.downloadCharts = downloadCharts;\nexports.browserDetails = browserDetails;\nexports.isCanvasElemSupported = isCanvasElemSupported;\nbrowserDetails.hasCanvas = isCanvasElemSupported();\nbrowserDetails.hasSvg = _lib.hasSVG;","map":{"version":3,"sources":["C:/Users/moham/OneDrive/Desktop/04_06_2021/henaknowledge/frontend v3/henaknowledgefrontend/node_modules/@fusioncharts/features/src/utils/lib-svg-to-canvas.js"],"names":["_interopRequireDefault","require","exports","__esModule","isCanvasElemSupported","drawSvgOnCanvas","browserDetails","downloadCharts","_svgdecanvo","_lib","_eventApi","_ajax","win","window","Image","doc","document","UNDEF","FORM","POST","INPUT","HIDDEN","EXPORTACTION","DOWNLOAD","SAVE","DOWNLOADSAVE","elem","createElement","getContext","getBrowserDetails","userAgent","navigator","index","indexOf","name","version","substring","sendExportData","postData","options","item","form","frameid","iframe","ajax","exportAction","exportTargetWindow","exportCallback","chart","fusionCharts","apiInstance","paper","chartId","exportHandler","parameters","exportFileName","exportFormat","exportIframe","test","width","height","body","style","cssText","method","action","target","type","value","submit","removeChild","match","triggerEvent","DOMId","fileName","statusCode","statusMessage","notice","default","resp","responseObj","replace","RegExp","$0","$1","$2","$3","err","error","hasOwnProperty","encodeURIComponent","post","dataurlToBlob","dataURI","byteString","mimeString","ia","i","split","atob","unescape","Uint8Array","length","charCodeAt","Blob","makeClientSideDownload","imageData","browser","blobObject","a","data","URL","createObjectURL","download","href","appendChild","onclick","parentNode","click","msSaveBlob","byteLength","str","s","code","isDataURITooLong","datauri","maxChromeByteSize","toLowerCase","isMobileDevice","location","sendMobileExportData","reader","FileReader","readAsDataURL","onloadend","exportData","result","callWebViewBridge","res","file","substr","ext","fileNmae","sendData","btoa","stream","dataObj","edata","eventName","webViewBridge","send","addSVGHeader","svgStr","svgStrToDataUrl","finalSvgStr","callback","_options","svg","canvas","x","y","useCanvas","ctx","image","svgDataURI","onload","drawImage","onerror","raiseWarning","src","hasCanvas","hasSvg","hasSVG"],"mappings":"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","sourcesContent":["\"use strict\";var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.isCanvasElemSupported=exports.drawSvgOnCanvas=exports.browserDetails=exports.downloadCharts=void 0;var _svgdecanvo=_interopRequireDefault(require(\"../_internal/vendors/svgtocanvas/src/svgdecanvo\"));var _lib=require(\"@fusioncharts/core/src/lib\");var _eventApi=require(\"@fusioncharts/core/src/event-api\");var _ajax=_interopRequireDefault(require(\"@fusioncharts/core/src/ajax\"));var win=window,Image=win.Image,doc=document,UNDEF,FORM=\"form\",POST=\"POST\",INPUT=\"input\",HIDDEN=\"hidden\",EXPORTACTION={DOWNLOAD:\"download\",SAVE:\"save\",DOWNLOADSAVE:\"download-save\"},isCanvasElemSupported=function isCanvasElemSupported(){var elem=doc.createElement(\"canvas\");return!!(elem.getContext&&elem.getContext(\"2d\"))},getBrowserDetails=function getBrowserDetails(){var userAgent=win.navigator.userAgent,index;if((index=userAgent.indexOf(\"Edge\"))!==-1){return{name:\"Edge\",version:userAgent.substring(index+5,index+11)}}if((index=userAgent.indexOf(\"Chrome\"))!==-1){return{name:\"Chrome\",version:userAgent.substring(index+7,index+11)}}if((index=userAgent.indexOf(\"MSIE\"))!==-1){return{name:\"ie\",version:userAgent.substring(index+5,index+9)}}if((index=userAgent.indexOf(\"rv\"))!==-1&&userAgent.indexOf(\"Trident\")!==-1){return{name:\"ie\",version:userAgent.substring(index+5,index+9)}}if((index=userAgent.indexOf(\"Firefox\"))!==-1){return{name:\"Firefox\",version:userAgent.substring(index+8,index+12)}}if((index=userAgent.indexOf(\"Safari\"))!==-1){return{name:\"Safari\",version:userAgent.substring(index+7,index+11)}}return{name:\"default\",version:\"Not Known\"}},browserDetails=getBrowserDetails(),sendExportData=function sendExportData(postData,options){var item,form,frameid,iframe,ajax,exportAction=options.exportAction,exportTargetWindow=options.exportTargetWindow,exportCallback=options.exportCallback,chart=options.fusionCharts.apiInstance,paper=options.paper,chartId=options.chartId,exportHandler=options.exportHandler,parameters=postData.parameters,exportFileName,exportFormat,exportIframe;if(exportAction===EXPORTACTION.DOWNLOAD||exportAction===EXPORTACTION.DOWNLOADSAVE){if(/(webkit|gecko)/gi.test(win.navigator.userAgent)&&exportTargetWindow===\"_self\"){exportTargetWindow=frameid=chartId+\"export_iframe\";if(!exportIframe){exportIframe=iframe=(0,_lib.createElement)(\"IFRAME\",{name:frameid,width:\"1px\",height:\"1px\"},doc.body);iframe.style.cssText=\"position:absolute;left:-10px;top:-10px;\"}}form=(0,_lib.createElement)(FORM,{method:POST,action:exportHandler,target:exportTargetWindow,style:\"display:none;\"},doc.body);for(item in postData){(0,_lib.createElement)(INPUT,{type:HIDDEN,name:item,value:postData[item]},form)}form.submit();doc.body.removeChild(form);form=UNDEF;exportFileName=parameters.match(/exportfilename=([^|]+)/)[1];exportFormat=parameters.match(/exportformat=([^|]+)/)[1];(0,_eventApi.triggerEvent)(\"exported\",chart,{DOMId:chartId,height:paper.height,width:paper.width,fileName:exportFileName+\".\"+exportFormat,statusCode:UNDEF,statusMessage:UNDEF,notice:UNDEF});exportCallback&&win[exportCallback]&&typeof win[exportCallback]===\"function\"&&win[exportCallback]({statusCode:1,statusMessage:\"success\",DOMId:chartId,width:paper&&paper.width,height:paper&&paper.height});return true}ajax=new _ajax.default((function(resp){var responseObj={};resp.replace(new RegExp(\"([^?=&]+)(=([^&]*))?\",\"g\"),(function($0,$1,$2,$3){responseObj[$1]=$3}));exportCallback&&win[exportCallback]&&typeof win[exportCallback]===\"function\"&&win[exportCallback](responseObj);(0,_eventApi.triggerEvent)(\"exported\",chart,responseObj)}),(function(err){var responseObj={statusCode:0,statusMessage:\"failure\",error:err,DOMId:chartId,width:paper&&paper.width,height:paper&&paper.height};exportCallback&&win[exportCallback]&&typeof win[exportCallback]===\"function\"&&win[exportCallback](responseObj);(0,_eventApi.triggerEvent)(\"exported\",chart,responseObj,[responseObj])}));for(item in postData){postData.hasOwnProperty(item)&&(postData[item]=encodeURIComponent(postData[item]))}ajax.post(exportHandler,postData)},dataurlToBlob=function dataurlToBlob(dataURI){var byteString,mimeString,ia,i;if(dataURI.split(\",\")[0].indexOf(\"base64\")>=0){byteString=win.atob(dataURI.split(\",\")[1])}else{byteString=win.unescape(dataURI.split(\",\")[1])}mimeString=dataURI.split(\",\")[0].split(\":\")[1].split(\";\")[0];ia=new Uint8Array(byteString.length);for(i=0;i<byteString.length;i++){ia[i]=byteString.charCodeAt(i)}return new win.Blob([ia],{type:mimeString})},makeClientSideDownload=function makeClientSideDownload(type,imageData,name,options){if(options===void 0){options={}}var browser=getBrowserDetails(),chartId=options.chartId,exportCallback=options.exportCallback,paper=options.paper,blobObject,a,data=imageData;if(browser.name===\"Chrome\"||browser.name===\"Firefox\"||browser.name===\"Safari\"){if(type===\"blob\"){data=win.URL.createObjectURL(data)}a=doc.createElement(\"a\");a.download=name;a.href=data;doc.body.appendChild(a);a.onclick=function(){exportCallback&&win[exportCallback]&&typeof win[exportCallback]===\"function\"&&win[exportCallback]({statusCode:1,statusMessage:\"success\",DOMId:chartId,width:paper&&paper.width,height:paper&&paper.height});a.parentNode.removeChild(a)};a.click()}else if(browser.name===\"ie\"||browser.name===\"Edge\"){if(win.navigator.msSaveBlob){if(type===\"url\"){blobObject=dataurlToBlob(data)}else{blobObject=data}if(win.navigator.msSaveBlob(blobObject,name)){exportCallback&&win[exportCallback]&&typeof win[exportCallback]===\"function\"&&win[exportCallback]({statusCode:1,statusMessage:\"success\",DOMId:chartId,width:paper&&paper.width,height:paper&&paper.height})}}}},byteLength=function byteLength(str){var s,code,i;s=str.length;for(i=str.length-1;i>=0;i--){code=str.charCodeAt(i);if(code>127&&code<=2047){s++}else if(code>2047&&code<=65535){s+=2}if(code>=56320&&code<=57343){i--}}return s},isDataURITooLong=function isDataURITooLong(datauri){var maxChromeByteSize;if(browserDetails.name.toLowerCase()===\"Chrome\".toLowerCase()){if(byteLength(datauri)>maxChromeByteSize){return true}}return false},downloadCharts=function downloadCharts(type,data,name,postData,options){var isMobileDevice=/Android|iPhone|iPad|iPod|Mobile/i.test(navigator.userAgent),match=window.location.href.match(/:\\/\\/(www[0-9]?\\.)?((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])(?:[\\0-\\.0-9;-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+)/);if(isMobileDevice&&!match){sendMobileExportData(type,data,name,postData)}else{if(data&&!isDataURITooLong(data)){makeClientSideDownload(type,data,name,options)}else if(postData){sendExportData(postData,options)}}},sendMobileExportData=function sendMobileExportData(type,data,name,postData){if(data&&name){if(type===\"blob\"){var reader=new FileReader;reader.readAsDataURL(data);reader.onloadend=function(){var exportData=reader.result;callWebViewBridge(exportData,name)}}else{callWebViewBridge(data,name)}}else if(postData){var res=postData.parameters.split(\"|\"),file=res[0].substr(res[0].indexOf(\"=\")+1),ext=res[1].substr(res[1].indexOf(\"=\")+1),fileNmae=file+\".\"+ext;var sendData;if(ext===\"svg\"){sendData=\"data:image/svg+xml;base64,\"+win.btoa(win.unescape(encodeURIComponent(postData.stream)))}else{sendData=postData.stream}callWebViewBridge(sendData,fileNmae)}},callWebViewBridge=function callWebViewBridge(data,name){var dataObj={edata:data,name:name,eventName:\"download\"};window.webViewBridge.send(null,dataObj)},addSVGHeader=function addSVGHeader(svgStr){return'<?xml version=\"1.0\" standalone=\"no\"?>\\n      <!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\\n       \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"> '+svgStr},svgStrToDataUrl=function svgStrToDataUrl(svgStr){var finalSvgStr=addSVGHeader(svgStr);finalSvgStr=\"data:image/svg+xml;base64,\"+win.btoa(win.unescape(encodeURIComponent(finalSvgStr)));return finalSvgStr},drawSvgOnCanvas=function drawSvgOnCanvas(options,callback){if(options===void 0){options={}}var _options=options,svg=_options.svg,canvas=_options.canvas,x=_options.x,y=_options.y,width=_options.width,height=_options.height,useCanvas=_options.useCanvas;if(browserDetails.name===\"ie\"||browserDetails.name===\"Edge\"||useCanvas){new _svgdecanvo.default(svg,canvas,x,y,width,height,(function(){callback()}))}else{var ctx,image,svgDataURI;svgDataURI=svgStrToDataUrl(svg);ctx=canvas.getContext(\"2d\");image=new Image;image.onload=function(){ctx.drawImage(image,x,y,width,height);callback()};image.onerror=function(){(0,_eventApi.raiseWarning)(this,\"\",\"run\",\"libSVGToCanvas:drawSvgOnCanvas\",\"Unable to load image for canvas drawing. Aborting attempt.\")};image.src=svgDataURI}};exports.drawSvgOnCanvas=drawSvgOnCanvas;exports.downloadCharts=downloadCharts;exports.browserDetails=browserDetails;exports.isCanvasElemSupported=isCanvasElemSupported;browserDetails.hasCanvas=isCanvasElemSupported();browserDetails.hasSvg=_lib.hasSVG;"]},"metadata":{},"sourceType":"script"}