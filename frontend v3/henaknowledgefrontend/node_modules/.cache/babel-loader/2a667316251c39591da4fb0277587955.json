{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _dataSkippingFilters = _interopRequireDefault(require(\"./data-skipping-filters\"));\n\nvar _dataSkippingCharts = require(\"./data-skipping-charts\");\n\nvar _lib = require(\"@fusioncharts/core/src/lib\");\n\nvar ALLOWED_RATIO_FOR_SKIPPING = 1.5;\nvar hashMapping = [],\n    prevDataLen = 0,\n    skipConf = {},\n    dragHashMap = [];\n\nfunction elemHideDecider(prevDrawInfo) {\n  if (prevDrawInfo === void 0) {\n    prevDrawInfo = [];\n  }\n\n  return prevDrawInfo.filter(function (v) {\n    return !hashMapping[v];\n  });\n}\n\nfunction getBeforeSkippingDrawMap(_prevDataLen) {\n  if (_prevDataLen === void 0) {\n    _prevDataLen = 0;\n  }\n\n  return Array.from(new Array(_prevDataLen), function (val, idx) {\n    return idx;\n  });\n}\n\nfunction decideSkip(config) {\n  if (config === void 0) {\n    config = {};\n  }\n\n  var component = config.component,\n      type = config.compType,\n      data,\n      dataLen,\n      plotPerPixelRatio,\n      chartConfig = component.getFromEnv(\"chartConfig\"),\n      chartAttrs = component.getFromEnv(\"dataSource\").chart || {},\n      plotBinSize = (0, _lib.pluckNumber)(chartAttrs.plotbinsize, chartConfig.plotbinsize),\n      plotsPerBin,\n      effectiveLength;\n  skipConf.plotBinSize = plotBinSize;\n  skipConf.labelBinSize = (0, _lib.pluckNumber)(chartAttrs.labelbinsize, chartConfig.labelbinsize);\n  skipConf.jsonData = component.config.JSONData;\n\n  if (type === \"group\") {\n    data = skipConf.jsonData[0].data;\n    prevDataLen = component.config.stackValues && component.config.stackValues.length || 0;\n  } else if (type === \"dataset\") {\n    data = skipConf.jsonData.data;\n    prevDataLen = component.components.data && component.components.data.length || 0;\n  }\n\n  dataLen = data && data.length;\n  hashMapping = [];\n  skipConf.width = effectiveLength = component.getFromEnv(\"chart\").isBar ? config.height || component.getFromEnv(\"chartHeight\") : config.width || component.getFromEnv(\"chartWidth\");\n  plotPerPixelRatio = dataLen / effectiveLength;\n  plotsPerBin = Math.floor(plotPerPixelRatio * plotBinSize);\n\n  if (plotPerPixelRatio >= ALLOWED_RATIO_FOR_SKIPPING && plotsPerBin > 1) {\n    skipConf.plotsPerBin = plotsPerBin;\n    skipConf.noOfPlotBins = Math.ceil(dataLen / skipConf.plotsPerBin);\n    return true;\n  }\n\n  return false;\n}\n\nfunction plotDrawIndices(filter, data) {\n  var startIndex = 0,\n      endIndex = 0,\n      plotsToBeDrawn = [];\n\n  for (var i = 1; i < skipConf.noOfPlotBins; ++i) {\n    startIndex = endIndex;\n    endIndex += skipConf.plotsPerBin;\n    filter(startIndex, endIndex - 1, data, dragHashMap, plotsToBeDrawn);\n  }\n\n  filter(endIndex, data.length - 1, data, dragHashMap, plotsToBeDrawn);\n  dragHashMap = [];\n  return plotsToBeDrawn;\n}\n\nfunction labelDrawIndices(plotIndices) {\n  var labelVsPlotBinRatio = skipConf.labelBinSize / skipConf.plotBinSize,\n      drawableLabelIndices = [],\n      labelHashMap = [],\n      i,\n      len = plotIndices.length;\n\n  for (i = 0; i < len; i++) {\n    if (!(i % labelVsPlotBinRatio)) {\n      drawableLabelIndices.push(plotIndices[i]);\n      labelHashMap[plotIndices[i]] = true;\n    }\n  }\n\n  return {\n    drawableLabelIndices: drawableLabelIndices,\n    labelHashMap: labelHashMap\n  };\n}\n\nfunction skippingTool(config) {\n  var _filterType = _dataSkippingCharts.filterType[config.datasetType],\n      component = config.component,\n      prevSkipInfo = component.getSkippingInfo && component.getSkippingInfo(),\n      prevDrawInfo = prevSkipInfo && prevSkipInfo.draw.slice(0),\n      prevLabelInfo = prevSkipInfo && (prevSkipInfo.labelDraw || []).slice(0),\n      skipInfo = {},\n      stackDataArray = [],\n      i,\n      j,\n      sum,\n      nDataset,\n      labelDrawInfo,\n      catLen = component.getFromEnv(\"xAxis\").getTicksLen(),\n      stackData;\n  !(prevDrawInfo && prevDrawInfo.length) && (prevDrawInfo = getBeforeSkippingDrawMap(prevDataLen));\n  !(prevLabelInfo && prevLabelInfo.length) && (prevLabelInfo = prevDrawInfo);\n  dragHashMap = prevSkipInfo && prevSkipInfo.dragHashMap;\n\n  if (component.getName() === \"cartesianStackGroup\") {\n    nDataset = skipConf.jsonData.length;\n\n    for (i = 0; i < catLen; ++i) {\n      sum = 0;\n\n      for (j = 0; j < nDataset; ++j) {\n        stackData = skipConf.jsonData[j].data;\n        sum += Number(stackData[i] ? stackData[i].value : 0);\n      }\n\n      stackDataArray.push({\n        value: sum\n      });\n    }\n\n    skipInfo.draw = plotDrawIndices((0, _dataSkippingFilters.default)(_filterType), stackDataArray);\n  } else {\n    skipInfo.draw = plotDrawIndices((0, _dataSkippingFilters.default)(_filterType), skipConf.jsonData.data);\n  }\n\n  skipInfo.draw.forEach(function (element) {\n    hashMapping[element] = true;\n  });\n  skipInfo.drawOnlyMap = hashMapping;\n  skipInfo.hide = elemHideDecider(prevDrawInfo);\n  labelDrawInfo = labelDrawIndices(skipInfo.draw);\n  skipInfo.labelDraw = labelDrawInfo.drawableLabelIndices;\n  hashMapping = skipInfo.labelDrawOnlyMap = labelDrawInfo.labelHashMap;\n  skipInfo.hideLabel = elemHideDecider(prevLabelInfo);\n  skipInfo.plotsPerBin = skipConf.plotsPerBin;\n  skipInfo.skippingApplied = true;\n  skipInfo.dragHashMap = [];\n  skipInfo.prevDrawInfo = prevDrawInfo.slice(0);\n  return skipInfo;\n}\n\nfunction updateDragMap(config) {\n  if (config === void 0) {\n    config = {};\n  }\n\n  var component = config.component,\n      eventArgs = config.eventArgs,\n      skipInfo = component.getSkippingInfo && component.getSkippingInfo() || {};\n  eventArgs && (skipInfo.dragHashMap[eventArgs.dataIndex] = eventArgs.endValue);\n}\n\nfunction dataSkipping(config) {\n  if (config === void 0) {\n    config = {};\n  }\n\n  var component = config.component;\n\n  if (decideSkip(config)) {\n    component.setSkippingInfo && component.setSkippingInfo(skippingTool(config));\n  } else {\n    component.setSkippingInfo && component.setSkippingInfo();\n  }\n}\n\nvar _default = {\n  dataSkipping: dataSkipping,\n  updateDragMap: updateDragMap\n};\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/moham/OneDrive/Desktop/04_06_2021/henaknowledge/frontend v3/henaknowledgefrontend/node_modules/@fusioncharts/features/src/data-skipping/data-skipping-ext.js"],"names":["_interopRequireDefault","require","exports","__esModule","default","_dataSkippingFilters","_dataSkippingCharts","_lib","ALLOWED_RATIO_FOR_SKIPPING","hashMapping","prevDataLen","skipConf","dragHashMap","elemHideDecider","prevDrawInfo","filter","v","getBeforeSkippingDrawMap","_prevDataLen","Array","from","val","idx","decideSkip","config","component","type","compType","data","dataLen","plotPerPixelRatio","chartConfig","getFromEnv","chartAttrs","chart","plotBinSize","pluckNumber","plotbinsize","plotsPerBin","effectiveLength","labelBinSize","labelbinsize","jsonData","JSONData","stackValues","length","components","width","isBar","height","Math","floor","noOfPlotBins","ceil","plotDrawIndices","startIndex","endIndex","plotsToBeDrawn","i","labelDrawIndices","plotIndices","labelVsPlotBinRatio","drawableLabelIndices","labelHashMap","len","push","skippingTool","_filterType","filterType","datasetType","prevSkipInfo","getSkippingInfo","draw","slice","prevLabelInfo","labelDraw","skipInfo","stackDataArray","j","sum","nDataset","labelDrawInfo","catLen","getTicksLen","stackData","getName","Number","value","forEach","element","drawOnlyMap","hide","labelDrawOnlyMap","hideLabel","skippingApplied","updateDragMap","eventArgs","dataIndex","endValue","dataSkipping","setSkippingInfo","_default"],"mappings":"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","sourcesContent":["\"use strict\";var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.default=void 0;var _dataSkippingFilters=_interopRequireDefault(require(\"./data-skipping-filters\"));var _dataSkippingCharts=require(\"./data-skipping-charts\");var _lib=require(\"@fusioncharts/core/src/lib\");var ALLOWED_RATIO_FOR_SKIPPING=1.5;var hashMapping=[],prevDataLen=0,skipConf={},dragHashMap=[];function elemHideDecider(prevDrawInfo){if(prevDrawInfo===void 0){prevDrawInfo=[]}return prevDrawInfo.filter((function(v){return!hashMapping[v]}))}function getBeforeSkippingDrawMap(_prevDataLen){if(_prevDataLen===void 0){_prevDataLen=0}return Array.from(new Array(_prevDataLen),(function(val,idx){return idx}))}function decideSkip(config){if(config===void 0){config={}}var component=config.component,type=config.compType,data,dataLen,plotPerPixelRatio,chartConfig=component.getFromEnv(\"chartConfig\"),chartAttrs=component.getFromEnv(\"dataSource\").chart||{},plotBinSize=(0,_lib.pluckNumber)(chartAttrs.plotbinsize,chartConfig.plotbinsize),plotsPerBin,effectiveLength;skipConf.plotBinSize=plotBinSize;skipConf.labelBinSize=(0,_lib.pluckNumber)(chartAttrs.labelbinsize,chartConfig.labelbinsize);skipConf.jsonData=component.config.JSONData;if(type===\"group\"){data=skipConf.jsonData[0].data;prevDataLen=component.config.stackValues&&component.config.stackValues.length||0}else if(type===\"dataset\"){data=skipConf.jsonData.data;prevDataLen=component.components.data&&component.components.data.length||0}dataLen=data&&data.length;hashMapping=[];skipConf.width=effectiveLength=component.getFromEnv(\"chart\").isBar?config.height||component.getFromEnv(\"chartHeight\"):config.width||component.getFromEnv(\"chartWidth\");plotPerPixelRatio=dataLen/effectiveLength;plotsPerBin=Math.floor(plotPerPixelRatio*plotBinSize);if(plotPerPixelRatio>=ALLOWED_RATIO_FOR_SKIPPING&&plotsPerBin>1){skipConf.plotsPerBin=plotsPerBin;skipConf.noOfPlotBins=Math.ceil(dataLen/skipConf.plotsPerBin);return true}return false}function plotDrawIndices(filter,data){var startIndex=0,endIndex=0,plotsToBeDrawn=[];for(var i=1;i<skipConf.noOfPlotBins;++i){startIndex=endIndex;endIndex+=skipConf.plotsPerBin;filter(startIndex,endIndex-1,data,dragHashMap,plotsToBeDrawn)}filter(endIndex,data.length-1,data,dragHashMap,plotsToBeDrawn);dragHashMap=[];return plotsToBeDrawn}function labelDrawIndices(plotIndices){var labelVsPlotBinRatio=skipConf.labelBinSize/skipConf.plotBinSize,drawableLabelIndices=[],labelHashMap=[],i,len=plotIndices.length;for(i=0;i<len;i++){if(!(i%labelVsPlotBinRatio)){drawableLabelIndices.push(plotIndices[i]);labelHashMap[plotIndices[i]]=true}}return{drawableLabelIndices:drawableLabelIndices,labelHashMap:labelHashMap}}function skippingTool(config){var _filterType=_dataSkippingCharts.filterType[config.datasetType],component=config.component,prevSkipInfo=component.getSkippingInfo&&component.getSkippingInfo(),prevDrawInfo=prevSkipInfo&&prevSkipInfo.draw.slice(0),prevLabelInfo=prevSkipInfo&&(prevSkipInfo.labelDraw||[]).slice(0),skipInfo={},stackDataArray=[],i,j,sum,nDataset,labelDrawInfo,catLen=component.getFromEnv(\"xAxis\").getTicksLen(),stackData;!(prevDrawInfo&&prevDrawInfo.length)&&(prevDrawInfo=getBeforeSkippingDrawMap(prevDataLen));!(prevLabelInfo&&prevLabelInfo.length)&&(prevLabelInfo=prevDrawInfo);dragHashMap=prevSkipInfo&&prevSkipInfo.dragHashMap;if(component.getName()===\"cartesianStackGroup\"){nDataset=skipConf.jsonData.length;for(i=0;i<catLen;++i){sum=0;for(j=0;j<nDataset;++j){stackData=skipConf.jsonData[j].data;sum+=Number(stackData[i]?stackData[i].value:0)}stackDataArray.push({value:sum})}skipInfo.draw=plotDrawIndices((0,_dataSkippingFilters.default)(_filterType),stackDataArray)}else{skipInfo.draw=plotDrawIndices((0,_dataSkippingFilters.default)(_filterType),skipConf.jsonData.data)}skipInfo.draw.forEach((function(element){hashMapping[element]=true}));skipInfo.drawOnlyMap=hashMapping;skipInfo.hide=elemHideDecider(prevDrawInfo);labelDrawInfo=labelDrawIndices(skipInfo.draw);skipInfo.labelDraw=labelDrawInfo.drawableLabelIndices;hashMapping=skipInfo.labelDrawOnlyMap=labelDrawInfo.labelHashMap;skipInfo.hideLabel=elemHideDecider(prevLabelInfo);skipInfo.plotsPerBin=skipConf.plotsPerBin;skipInfo.skippingApplied=true;skipInfo.dragHashMap=[];skipInfo.prevDrawInfo=prevDrawInfo.slice(0);return skipInfo}function updateDragMap(config){if(config===void 0){config={}}var component=config.component,eventArgs=config.eventArgs,skipInfo=component.getSkippingInfo&&component.getSkippingInfo()||{};eventArgs&&(skipInfo.dragHashMap[eventArgs.dataIndex]=eventArgs.endValue)}function dataSkipping(config){if(config===void 0){config={}}var component=config.component;if(decideSkip(config)){component.setSkippingInfo&&component.setSkippingInfo(skippingTool(config))}else{component.setSkippingInfo&&component.setSkippingInfo()}}var _default={dataSkipping:dataSkipping,updateDragMap:updateDragMap};exports.default=_default;"]},"metadata":{},"sourceType":"script"}