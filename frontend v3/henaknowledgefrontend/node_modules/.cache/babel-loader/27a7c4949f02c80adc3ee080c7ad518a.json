{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _componentBase = _interopRequireWildcard(require(\"./component-base\"));\n\nvar _lib = require(\"../lib\");\n\nvar _schedular = require(\"../schedular\");\n\nvar addEventOnAllGraphics = function addEventOnAllGraphics(component, eventType, listener) {\n  var callBack;\n\n  if (eventType && listener) {\n    callBack = function callBack(element) {\n      !element._skipEvents && element.on && element.on(eventType, listener);\n    };\n\n    _mapSubFnForward(component.getGraphicalElement(), callBack);\n  }\n},\n    removeEventFromAllGraphics = function removeEventFromAllGraphics(component, eventType, listener) {\n  var callBack;\n\n  if (eventType && listener) {\n    callBack = function callBack(element) {\n      !element._skipEvents && element.off && element.off(eventType, listener);\n    };\n\n    _mapSubFnForward(component.getGraphicalElement(), callBack);\n  }\n},\n    _mapSubFnBackward = function _mapSubFnBackward(sub, callback) {\n  if (sub && sub.hasOwnProperty && callback && callback.call) {\n    var currLabel, label, elemStore, i;\n\n    for (label in sub) {\n      currLabel = sub[label];\n      elemStore = currLabel.elemStore;\n\n      for (i = elemStore && elemStore.length - 1; i >= 0; i--) {\n        if (callback(elemStore[i], label, i)) {\n          break;\n        }\n      }\n    }\n  }\n},\n    _mapSubFnForward = function _mapSubFnForward(sub, callback) {\n  if (sub && sub.hasOwnProperty && callback && callback.call) {\n    var currLabel, ii, label, elemStore, i;\n\n    for (label in sub) {\n      currLabel = sub[label];\n      elemStore = currLabel.elemStore;\n\n      for (i = 0, ii = elemStore && elemStore.length; i < ii; i++) {\n        if (callback(elemStore[i], label, i)) {\n          break;\n        }\n      }\n    }\n  }\n},\n    _getDifferentialAttributes = function _getDifferentialAttributes(newAttrs, existingAttrs, existingCss) {\n  if (existingCss === void 0) {\n    existingCss = {};\n  }\n\n  var derivedAttrs, currAttr, existingAttr, attr;\n\n  for (attr in newAttrs) {\n    currAttr = newAttrs[attr];\n    existingAttr = (0, _lib.pluck)(existingAttrs[attr], existingCss[attr]);\n\n    if (existingAttr !== _lib.UNDEF) {\n      if (currAttr instanceof Array) {\n        if (attr === \"text-bound\") {\n          derivedAttrs || (derivedAttrs = {});\n          derivedAttrs[attr] = currAttr;\n          derivedAttrs.x = newAttrs.x;\n          derivedAttrs.y = newAttrs.y;\n        } else if (currAttr.toString().replace(/,/g, \"\") !== existingAttr.toString().replace(/,/g, \"\")) {\n          derivedAttrs || (derivedAttrs = {});\n          derivedAttrs[attr] = currAttr;\n        }\n      } else if (typeof currAttr === \"string\") {\n        if (currAttr.replace(/,/g, \"\") !== existingAttr.toString().replace(/,/g, \"\")) {\n          derivedAttrs || (derivedAttrs = {});\n          derivedAttrs[attr] = currAttr;\n        }\n      } else {\n        if (currAttr !== existingAttr) {\n          derivedAttrs || (derivedAttrs = {});\n          derivedAttrs[attr] = currAttr;\n        }\n      }\n    } else {\n      derivedAttrs || (derivedAttrs = {});\n      derivedAttrs[attr] = currAttr;\n    }\n  }\n\n  return derivedAttrs;\n};\n\nvar SmartRenderer = function (_ComponentBase) {\n  (0, _inheritsLoose2.default)(SmartRenderer, _ComponentBase);\n\n  function SmartRenderer(id) {\n    var _this;\n\n    _this = _ComponentBase.call(this, id) || this;\n    var smartRenderer = (0, _assertThisInitialized2.default)(_this);\n    smartRenderer._version = 2;\n    smartRenderer._id = id;\n    smartRenderer._componentStore = {};\n    smartRenderer._oldComponentStore = [];\n    smartRenderer.fireEvent(\"instantiated\");\n\n    smartRenderer.__setDefaultConfig();\n\n    return _this;\n  }\n\n  var _proto = SmartRenderer.prototype;\n\n  _proto.isDrawingRequired = function isDrawingRequired() {\n    return this;\n  };\n\n  _proto.syncDraw = function syncDraw() {\n    var component = this,\n        isRemoved = component.getState(\"removed\");\n\n    if (component.isDrawingRequired() || isRemoved) {\n      component.fireEvent(\"predraw\");\n      component.removeJob(\"draw\");\n\n      component._resetGraphicalStore();\n\n      isRemoved ? component.addJob(\"dispose-component\", function () {\n        return component._dispose();\n      }, _schedular.priorityList.postRender) : component.draw && component.draw();\n      component.childrenSyncDraw();\n\n      component._removeUnusedGraphics();\n\n      component.fireEvent(\"drawn\");\n    }\n  };\n\n  _proto._remove = function _remove() {\n    var component = this,\n        childComponents;\n    component.onRemove && component.onRemove();\n    component.setState(\"removed\", true);\n    childComponents = component.getChildren();\n\n    if (childComponents) {\n      component._mapChildren(function (child) {\n        child.onRemove && child.onRemove();\n        child && child.setState(\"removed\", true);\n      }, true);\n    }\n  };\n\n  _proto.setDimension = function setDimension(width, height) {\n    this.config.width = width;\n    this.config.height = height;\n  };\n\n  _proto.setTranslation = function setTranslation(x, y) {\n    var config = this.config;\n    config._translateX = x;\n    config._translateY = y;\n    config.translate = \"t\" + x + \",\" + y;\n  };\n\n  _proto.getTranslation = function getTranslation() {\n    return {\n      x: this.config._translateX,\n      y: this.config._translateY\n    };\n  };\n\n  _proto._resetGraphicalStore = function _resetGraphicalStore() {\n    var smartRenderer = this;\n    smartRenderer._oldGraphicalStore = smartRenderer._graphicalStore;\n    smartRenderer._graphicalStore = {};\n  };\n\n  _proto._getLastUsedElem = function _getLastUsedElem() {\n    return this.config.lastElemUsed;\n  };\n\n  _proto.addGraphicalElement = function addGraphicalElement(inputConfiguration, skipEvents) {\n    if (inputConfiguration === void 0) {\n      inputConfiguration = {};\n    }\n\n    if (skipEvents === void 0) {\n      skipEvents = false;\n    }\n\n    var smartRenderer = this,\n        label = inputConfiguration.label,\n        store = smartRenderer._graphicalStore[label] || (smartRenderer._graphicalStore[label] = {\n      elemStore: [],\n      idMap: {},\n      indexMap: {},\n      lastIndexUsed: -1\n    }),\n        source,\n        updatedCss,\n        containerConfig,\n        newElem = true,\n        oldStore = smartRenderer._oldGraphicalStore && smartRenderer._oldGraphicalStore[label],\n        newIndex = store.lastIndexUsed += 1,\n        oldIndex,\n        elem,\n        updatedAttributes = inputConfiguration.attr,\n        id = inputConfiguration.id;\n\n    if (oldStore) {\n      if (id && oldStore.idMap[id] !== _lib.UNDEF) {\n        oldIndex = oldStore.idMap[id];\n        elem = oldStore.elemStore[oldIndex];\n        delete oldStore.elemStore[oldIndex];\n        delete oldStore.indexMap[oldIndex];\n        delete oldStore.idMap[id];\n      } else if (oldStore.elemStore[newIndex]) {\n        if (!oldStore.indexMap[newIndex]) {\n          elem = oldStore.elemStore[newIndex];\n          delete oldStore.elemStore[newIndex];\n        }\n      }\n    }\n\n    if (inputConfiguration.el === \"text\" && inputConfiguration.css) {\n      (0, _lib.removeHtmlAttrs)(inputConfiguration.css);\n    }\n\n    if (elem) {\n      inputConfiguration.el = elem;\n      newElem = false;\n\n      if (updatedAttributes = _getDifferentialAttributes(inputConfiguration.attr, elem.attrs)) {\n        inputConfiguration.attr = updatedAttributes;\n      }\n\n      if (inputConfiguration.css && (updatedCss = _getDifferentialAttributes(inputConfiguration.css, elem.attrs, elem.styles))) {\n        inputConfiguration.css = updatedCss;\n      }\n    }\n\n    if (containerConfig = inputConfiguration.container) {\n      source = containerConfig.isParent ? smartRenderer.getLinkedParent() : smartRenderer;\n      inputConfiguration.container = source.getGraphicalElement(containerConfig.id, containerConfig.label) || source.getChildContainer(containerConfig.id);\n    } else {\n      inputConfiguration.container = smartRenderer.getFromEnv(\"chart-container\");\n    }\n\n    (updatedAttributes || updatedCss) && (elem = smartRenderer.getFromEnv(\"animationManager\").setAnimation(inputConfiguration));\n    store.elemStore[newIndex] = elem;\n\n    if (id) {\n      if (store.idMap[id]) {\n        delete store.indexMap[store.idMap[id]];\n        delete store.idMap[id];\n      }\n\n      store.idMap[id] = newIndex;\n      store.indexMap[newIndex] = id;\n    }\n\n    smartRenderer.fireEvent(\"graphicalelementattached\", {\n      element: elem\n    });\n    elem._skipEvents = skipEvents;\n    inputConfiguration.shadow && elem.shadow(inputConfiguration.shadow);\n    inputConfiguration.outlineText !== _lib.UNDEF && elem.outlineText(inputConfiguration.outlineText, (0, _lib.convertColor)((0, _lib.pluck)(inputConfiguration.css.fill, inputConfiguration.attr.fill)));\n    inputConfiguration.tooltext !== _lib.UNDEF && smartRenderer.getFromEnv(\"toolTipController\").enableToolTip(elem, inputConfiguration.tooltext);\n    smartRenderer.config.lastElemUsed = elem;\n    !skipEvents && newElem && (0, _componentBase.addAllEventsOnGraphic)(elem, smartRenderer._middleListeners, smartRenderer);\n  };\n\n  _proto.removeGraphicalElement = function removeGraphicalElement(info, label) {\n    var smartRenderer = this,\n        graphics = smartRenderer._graphicalStore,\n        currLabelGraphics,\n        element,\n        found;\n\n    if (typeof info === \"object\") {\n      _mapSubFnBackward(graphics, function (child, currLabel, i) {\n        if (info === child) {\n          found = true;\n\n          smartRenderer._setRemoveAnim(child, currLabel);\n\n          currLabelGraphics = graphics[currLabel];\n          currLabelGraphics.elemStore.splice(i, 1);\n          delete currLabelGraphics.idMap[currLabelGraphics.indexMap[i]];\n          delete currLabelGraphics.indexMap[i];\n          return true;\n        }\n      });\n    } else {\n      _mapSubFnBackward(graphics, function (child, currentLabel, i) {\n        currLabelGraphics = graphics[currentLabel];\n\n        if (currLabelGraphics.indexMap[i] === info && (label ? label === currentLabel : true)) {\n          found = true;\n\n          smartRenderer._setRemoveAnim(child, currentLabel);\n\n          currLabelGraphics.elemStore.splice(i, 1);\n          delete currLabelGraphics.idMap[currLabelGraphics.indexMap[i]];\n          delete currLabelGraphics.indexMap[i];\n          return true;\n        }\n      });\n    }\n\n    if (found) {\n      this.fireEvent(\"graphicalelementremoved\", {\n        element: element\n      });\n    }\n  };\n\n  _proto.getChildContainer = function getChildContainer(name) {\n    return this.getGraphicalElement(_lib.UNDEF, name);\n  };\n\n  _proto._removeUnusedGraphics = function _removeUnusedGraphics() {\n    var smartRenderer = this,\n        graphics = smartRenderer._oldGraphicalStore,\n        currLabelGraphics;\n\n    _mapSubFnBackward(graphics, function (child, currLabel, i) {\n      if (child) {\n        smartRenderer._setRemoveAnim(child, currLabel);\n\n        currLabelGraphics = graphics[currLabel];\n        delete currLabelGraphics.idMap[currLabelGraphics.indexMap[i]];\n        delete currLabelGraphics.indexMap[i];\n      }\n    });\n  };\n\n  _proto.getGraphicalElement = function getGraphicalElement(id, label) {\n    var currLabel,\n        currLabelGraphics,\n        elem,\n        i,\n        graphics = this._graphicalStore;\n\n    if (!label && !id) {\n      return graphics;\n    }\n\n    if (!label) {\n      _mapSubFnForward(graphics, function () {\n        i = arguments[2];\n        currLabelGraphics = graphics[arguments[1]];\n\n        if (currLabelGraphics.idMap[i] === id) {\n          elem = currLabelGraphics.elemStore[i];\n          return true;\n        }\n      });\n\n      return elem;\n    }\n\n    currLabel = graphics[label];\n\n    if (!id) {\n      return currLabel && currLabel.elemStore && currLabel.elemStore[0];\n    }\n\n    return currLabel && currLabel.elemStore && currLabel.elemStore[currLabel.idMap[id]];\n  };\n\n  _proto.addEventListener = function addEventListener(eventType, callback, options) {\n    var superOutput = _ComponentBase.prototype.addEventListener.call(this, eventType, callback, options);\n\n    if (superOutput === true) {\n      addEventOnAllGraphics(this, eventType, this._middleListeners[eventType]);\n      return callback;\n    } else if (superOutput) {\n      return callback;\n    }\n\n    return false;\n  };\n\n  _proto.removeEventListener = function removeEventListener(eventType, callback) {\n    if (_ComponentBase.prototype.removeEventListener.call(this, eventType, callback)) {\n      removeEventFromAllGraphics(this, eventType, this._middleListeners[eventType]);\n    }\n  };\n\n  _proto._dispose = function _dispose() {\n    var component = this,\n        itemName,\n        i,\n        eventType,\n        listenersArr;\n\n    if (component && component !== window && component._disposing !== true) {\n      component._disposing = true;\n      component.fireEvent(\"beforeremove\");\n\n      if (component._extListeners) {\n        for (eventType in component._extListeners) {\n          listenersArr = component._extListeners[eventType];\n\n          for (i = listenersArr.length - 1; i >= 0; i--) {\n            if (listenersArr[i].component && listenersArr[i].component.addEventListener) {\n              listenersArr[i].component.removeEventListener(eventType, listenersArr[i].fn);\n            }\n          }\n        }\n      }\n\n      component.removeAllJobs();\n\n      if (component._linkedParent && component._linkedParent.getComponentVersion() === 1) {\n        component._linkedParent._detachChild(component);\n      }\n\n      if (component.getFromEnv(\"paper\") && !component.getFromEnv(\"paper\").removed) {\n        _mapSubFnForward(component.getGraphicalElement(), component.__instantRemoveFn);\n      }\n\n      for (itemName in component) {\n        if (component.hasOwnProperty(itemName)) {\n          delete component[itemName];\n        }\n      }\n\n      component.fireEvent(\"removed\");\n    }\n  };\n\n  _proto.configure = function configure(dataObj) {\n    this._resetComponentStore();\n\n    _ComponentBase.prototype.configure.call(this, dataObj);\n  };\n\n  _proto._resetComponentStore = function _resetComponentStore() {\n    var smartRenderer = this;\n\n    smartRenderer._oldComponentStore.push(smartRenderer._componentStore);\n\n    smartRenderer._componentStore = {};\n  };\n\n  _proto._mapChildren = function _mapChildren(callback, backWord) {\n    if (backWord) {\n      _mapSubFnBackward(this.getChildren(), callback);\n    } else {\n      _mapSubFnForward(this.getChildren(), callback);\n    }\n  };\n\n  _proto.attachChild = function attachChild(Component, componentType, id) {\n    var smartRenderer = this,\n        store = smartRenderer._componentStore[componentType] || (smartRenderer._componentStore[componentType] = {\n      elemStore: [],\n      idMap: {},\n      indexMap: {},\n      lastIndexUsed: -1\n    }),\n        oldStore = smartRenderer._oldComponentStore && smartRenderer._oldComponentStore.length && smartRenderer._oldComponentStore[smartRenderer._oldComponentStore.length - 1][componentType],\n        newIndex = store.lastIndexUsed += 1,\n        oldIndex,\n        comp;\n\n    if (oldStore) {\n      var oldStoreElems = oldStore.elemStore,\n          oldIndexedElem = oldStoreElems[newIndex];\n\n      if (id && oldStore.idMap[id] !== _lib.UNDEF) {\n        oldIndex = oldStore.idMap[id];\n        comp = oldStoreElems[oldIndex];\n        delete oldStoreElems[oldIndex];\n        delete oldStore.indexMap[oldIndex];\n        delete oldStore.idMap[id];\n      } else if (oldIndexedElem && oldIndexedElem.constructor === Component) {\n        if (!oldStore.indexMap[newIndex]) {\n          comp = oldIndexedElem;\n          delete oldStoreElems[newIndex];\n        }\n      }\n    }\n\n    if (!comp) {\n      comp = new Component(id);\n    }\n\n    store.elemStore[newIndex] = comp;\n\n    if (id) {\n      store.idMap[id] = newIndex;\n      store.indexMap[newIndex] = id;\n    }\n\n    comp._setLinkedParent(smartRenderer);\n\n    return comp;\n  };\n\n  _proto.childrenSyncDraw = function childrenSyncDraw() {\n    var component = this;\n\n    component._mapChildren(function (child) {\n      child && child.draw && child.syncDraw();\n    });\n\n    component._removeUnusedChildren();\n  };\n\n  _proto._removeUnusedChildren = function _removeUnusedChildren() {\n    var smartRenderer = this,\n        oldStore = smartRenderer._oldComponentStore,\n        l = oldStore.length,\n        i = 0,\n        iteratorFn = function iteratorFn(child) {\n      if (child) {\n        child._remove();\n\n        child.syncDraw();\n\n        child._setLinkedParent(_lib.UNDEF);\n      }\n    };\n\n    for (; i < l; i += 1) {\n      _mapSubFnBackward(oldStore[i], iteratorFn);\n    }\n\n    smartRenderer._oldComponentStore.length = 0;\n  };\n\n  _proto.getChild = function getChild(id, componentType) {\n    var returnChild;\n\n    this._searchChildren(id, function (foundChild) {\n      returnChild = foundChild;\n    }, componentType);\n\n    return returnChild;\n  };\n\n  _proto._searchChildren = function _searchChildren(id, cb, _componentType) {\n    var componentStore = this._componentStore,\n        foundAt,\n        indexMap,\n        foundComp,\n        componentType = _componentType;\n\n    if (id) {\n      _mapSubFnBackward(componentStore, function (child, currentComponentType, i) {\n        indexMap = componentStore[currentComponentType].indexMap;\n\n        if (indexMap[i] === id && (componentType ? componentType === currentComponentType : true)) {\n          foundComp = child;\n          foundAt = i;\n          componentType = currentComponentType;\n          return true;\n        }\n      });\n    } else {\n      foundComp = componentStore[componentType] && componentStore[componentType].elemStore;\n    }\n\n    if (foundComp) {\n      return cb(foundComp, foundAt, componentType);\n    }\n  };\n\n  _proto.getChildren = function getChildren(componentType) {\n    return componentType ? this._componentStore[componentType] && this._componentStore[componentType].elemStore : this._componentStore;\n  };\n\n  _proto._detachChild = function _detachChild() {\n    return this;\n  };\n\n  return SmartRenderer;\n}(_componentBase.default);\n\nvar _default = SmartRenderer;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/moham/OneDrive/Desktop/04_06_2021/henaknowledge/frontend v3/henaknowledgefrontend/node_modules/@fusioncharts/core/src/component-interface/smart-renderer.js"],"names":["_interopRequireWildcard","require","_interopRequireDefault","exports","__esModule","default","_assertThisInitialized2","_inheritsLoose2","_componentBase","_lib","_schedular","addEventOnAllGraphics","component","eventType","listener","callBack","element","_skipEvents","on","_mapSubFnForward","getGraphicalElement","removeEventFromAllGraphics","off","_mapSubFnBackward","sub","callback","hasOwnProperty","call","currLabel","label","elemStore","i","length","ii","_getDifferentialAttributes","newAttrs","existingAttrs","existingCss","derivedAttrs","currAttr","existingAttr","attr","pluck","UNDEF","Array","x","y","toString","replace","SmartRenderer","_ComponentBase","id","_this","smartRenderer","_version","_id","_componentStore","_oldComponentStore","fireEvent","__setDefaultConfig","_proto","prototype","isDrawingRequired","syncDraw","isRemoved","getState","removeJob","_resetGraphicalStore","addJob","_dispose","priorityList","postRender","draw","childrenSyncDraw","_removeUnusedGraphics","_remove","childComponents","onRemove","setState","getChildren","_mapChildren","child","setDimension","width","height","config","setTranslation","_translateX","_translateY","translate","getTranslation","_oldGraphicalStore","_graphicalStore","_getLastUsedElem","lastElemUsed","addGraphicalElement","inputConfiguration","skipEvents","store","idMap","indexMap","lastIndexUsed","source","updatedCss","containerConfig","newElem","oldStore","newIndex","oldIndex","elem","updatedAttributes","el","css","removeHtmlAttrs","attrs","styles","container","isParent","getLinkedParent","getChildContainer","getFromEnv","setAnimation","shadow","outlineText","convertColor","fill","tooltext","enableToolTip","addAllEventsOnGraphic","_middleListeners","removeGraphicalElement","info","graphics","currLabelGraphics","found","_setRemoveAnim","splice","currentLabel","name","arguments","addEventListener","options","superOutput","removeEventListener","itemName","listenersArr","window","_disposing","_extListeners","fn","removeAllJobs","_linkedParent","getComponentVersion","_detachChild","removed","__instantRemoveFn","configure","dataObj","_resetComponentStore","push","backWord","attachChild","Component","componentType","comp","oldStoreElems","oldIndexedElem","constructor","_setLinkedParent","_removeUnusedChildren","l","iteratorFn","getChild","returnChild","_searchChildren","foundChild","cb","_componentType","componentStore","foundAt","foundComp","currentComponentType","_default"],"mappings":"AAAA;;AAAa,IAAIA,uBAAuB,GAACC,OAAO,CAAC,+CAAD,CAAnC;;AAAqF,IAAIC,sBAAsB,GAACD,OAAO,CAAC,8CAAD,CAAlC;;AAAmFE,OAAO,CAACC,UAAR,GAAmB,IAAnB;AAAwBD,OAAO,CAACE,OAAR,GAAgB,KAAK,CAArB;;AAAuB,IAAIC,uBAAuB,GAACJ,sBAAsB,CAACD,OAAO,CAAC,8CAAD,CAAR,CAAlD;;AAA4G,IAAIM,eAAe,GAACL,sBAAsB,CAACD,OAAO,CAAC,sCAAD,CAAR,CAA1C;;AAA4F,IAAIO,cAAc,GAACR,uBAAuB,CAACC,OAAO,CAAC,kBAAD,CAAR,CAA1C;;AAAwE,IAAIQ,IAAI,GAACR,OAAO,CAAC,QAAD,CAAhB;;AAA2B,IAAIS,UAAU,GAACT,OAAO,CAAC,cAAD,CAAtB;;AAAuC,IAAIU,qBAAqB,GAAC,SAASA,qBAAT,CAA+BC,SAA/B,EAAyCC,SAAzC,EAAmDC,QAAnD,EAA4D;AAAC,MAAIC,QAAJ;;AAAa,MAAGF,SAAS,IAAEC,QAAd,EAAuB;AAACC,IAAAA,QAAQ,GAAC,SAASA,QAAT,CAAkBC,OAAlB,EAA0B;AAAC,OAACA,OAAO,CAACC,WAAT,IAAsBD,OAAO,CAACE,EAA9B,IAAkCF,OAAO,CAACE,EAAR,CAAWL,SAAX,EAAqBC,QAArB,CAAlC;AAAiE,KAArG;;AAAsGK,IAAAA,gBAAgB,CAACP,SAAS,CAACQ,mBAAV,EAAD,EAAiCL,QAAjC,CAAhB;AAA2D;AAAC,CAA9R;AAAA,IAA+RM,0BAA0B,GAAC,SAASA,0BAAT,CAAoCT,SAApC,EAA8CC,SAA9C,EAAwDC,QAAxD,EAAiE;AAAC,MAAIC,QAAJ;;AAAa,MAAGF,SAAS,IAAEC,QAAd,EAAuB;AAACC,IAAAA,QAAQ,GAAC,SAASA,QAAT,CAAkBC,OAAlB,EAA0B;AAAC,OAACA,OAAO,CAACC,WAAT,IAAsBD,OAAO,CAACM,GAA9B,IAAmCN,OAAO,CAACM,GAAR,CAAYT,SAAZ,EAAsBC,QAAtB,CAAnC;AAAmE,KAAvG;;AAAwGK,IAAAA,gBAAgB,CAACP,SAAS,CAACQ,mBAAV,EAAD,EAAiCL,QAAjC,CAAhB;AAA2D;AAAC,CAArkB;AAAA,IAAskBQ,iBAAiB,GAAC,SAASA,iBAAT,CAA2BC,GAA3B,EAA+BC,QAA/B,EAAwC;AAAC,MAAGD,GAAG,IAAEA,GAAG,CAACE,cAAT,IAAyBD,QAAzB,IAAmCA,QAAQ,CAACE,IAA/C,EAAoD;AAAC,QAAIC,SAAJ,EAAcC,KAAd,EAAoBC,SAApB,EAA8BC,CAA9B;;AAAgC,SAAIF,KAAJ,IAAaL,GAAb,EAAiB;AAACI,MAAAA,SAAS,GAACJ,GAAG,CAACK,KAAD,CAAb;AAAqBC,MAAAA,SAAS,GAACF,SAAS,CAACE,SAApB;;AAA8B,WAAIC,CAAC,GAACD,SAAS,IAAEA,SAAS,CAACE,MAAV,GAAiB,CAAlC,EAAoCD,CAAC,IAAE,CAAvC,EAAyCA,CAAC,EAA1C,EAA6C;AAAC,YAAGN,QAAQ,CAACK,SAAS,CAACC,CAAD,CAAV,EAAcF,KAAd,EAAoBE,CAApB,CAAX,EAAkC;AAAC;AAAM;AAAC;AAAC;AAAC;AAAC,CAAt3B;AAAA,IAAu3BZ,gBAAgB,GAAC,SAASA,gBAAT,CAA0BK,GAA1B,EAA8BC,QAA9B,EAAuC;AAAC,MAAGD,GAAG,IAAEA,GAAG,CAACE,cAAT,IAAyBD,QAAzB,IAAmCA,QAAQ,CAACE,IAA/C,EAAoD;AAAC,QAAIC,SAAJ,EAAcK,EAAd,EAAiBJ,KAAjB,EAAuBC,SAAvB,EAAiCC,CAAjC;;AAAmC,SAAIF,KAAJ,IAAaL,GAAb,EAAiB;AAACI,MAAAA,SAAS,GAACJ,GAAG,CAACK,KAAD,CAAb;AAAqBC,MAAAA,SAAS,GAACF,SAAS,CAACE,SAApB;;AAA8B,WAAIC,CAAC,GAAC,CAAF,EAAIE,EAAE,GAACH,SAAS,IAAEA,SAAS,CAACE,MAAhC,EAAuCD,CAAC,GAACE,EAAzC,EAA4CF,CAAC,EAA7C,EAAgD;AAAC,YAAGN,QAAQ,CAACK,SAAS,CAACC,CAAD,CAAV,EAAcF,KAAd,EAAoBE,CAApB,CAAX,EAAkC;AAAC;AAAM;AAAC;AAAC;AAAC;AAAC,CAA3qC;AAAA,IAA4qCG,0BAA0B,GAAC,SAASA,0BAAT,CAAoCC,QAApC,EAA6CC,aAA7C,EAA2DC,WAA3D,EAAuE;AAAC,MAAGA,WAAW,KAAG,KAAK,CAAtB,EAAwB;AAACA,IAAAA,WAAW,GAAC,EAAZ;AAAe;;AAAA,MAAIC,YAAJ,EAAiBC,QAAjB,EAA0BC,YAA1B,EAAuCC,IAAvC;;AAA4C,OAAIA,IAAJ,IAAYN,QAAZ,EAAqB;AAACI,IAAAA,QAAQ,GAACJ,QAAQ,CAACM,IAAD,CAAjB;AAAwBD,IAAAA,YAAY,GAAC,CAAC,GAAE/B,IAAI,CAACiC,KAAR,EAAeN,aAAa,CAACK,IAAD,CAA5B,EAAmCJ,WAAW,CAACI,IAAD,CAA9C,CAAb;;AAAmE,QAAGD,YAAY,KAAG/B,IAAI,CAACkC,KAAvB,EAA6B;AAAC,UAAGJ,QAAQ,YAAYK,KAAvB,EAA6B;AAAC,YAAGH,IAAI,KAAG,YAAV,EAAuB;AAACH,UAAAA,YAAY,KAAGA,YAAY,GAAC,EAAhB,CAAZ;AAAgCA,UAAAA,YAAY,CAACG,IAAD,CAAZ,GAAmBF,QAAnB;AAA4BD,UAAAA,YAAY,CAACO,CAAb,GAAeV,QAAQ,CAACU,CAAxB;AAA0BP,UAAAA,YAAY,CAACQ,CAAb,GAAeX,QAAQ,CAACW,CAAxB;AAA0B,SAAxI,MAA6I,IAAGP,QAAQ,CAACQ,QAAT,GAAoBC,OAApB,CAA4B,IAA5B,EAAiC,EAAjC,MAAuCR,YAAY,CAACO,QAAb,GAAwBC,OAAxB,CAAgC,IAAhC,EAAqC,EAArC,CAA1C,EAAmF;AAACV,UAAAA,YAAY,KAAGA,YAAY,GAAC,EAAhB,CAAZ;AAAgCA,UAAAA,YAAY,CAACG,IAAD,CAAZ,GAAmBF,QAAnB;AAA4B;AAAC,OAA5T,MAAiU,IAAG,OAAOA,QAAP,KAAkB,QAArB,EAA8B;AAAC,YAAGA,QAAQ,CAACS,OAAT,CAAiB,IAAjB,EAAsB,EAAtB,MAA4BR,YAAY,CAACO,QAAb,GAAwBC,OAAxB,CAAgC,IAAhC,EAAqC,EAArC,CAA/B,EAAwE;AAACV,UAAAA,YAAY,KAAGA,YAAY,GAAC,EAAhB,CAAZ;AAAgCA,UAAAA,YAAY,CAACG,IAAD,CAAZ,GAAmBF,QAAnB;AAA4B;AAAC,OAArK,MAAyK;AAAC,YAAGA,QAAQ,KAAGC,YAAd,EAA2B;AAACF,UAAAA,YAAY,KAAGA,YAAY,GAAC,EAAhB,CAAZ;AAAgCA,UAAAA,YAAY,CAACG,IAAD,CAAZ,GAAmBF,QAAnB;AAA4B;AAAC;AAAC,KAAnmB,MAAumB;AAACD,MAAAA,YAAY,KAAGA,YAAY,GAAC,EAAhB,CAAZ;AAAgCA,MAAAA,YAAY,CAACG,IAAD,CAAZ,GAAmBF,QAAnB;AAA4B;AAAC;;AAAA,SAAOD,YAAP;AAAoB,CAA7oE;;AAA8oE,IAAIW,aAAa,GAAC,UAASC,cAAT,EAAwB;AAAC,GAAC,GAAE3C,eAAe,CAACF,OAAnB,EAA4B4C,aAA5B,EAA0CC,cAA1C;;AAA0D,WAASD,aAAT,CAAuBE,EAAvB,EAA0B;AAAC,QAAIC,KAAJ;;AAAUA,IAAAA,KAAK,GAACF,cAAc,CAACvB,IAAf,CAAoB,IAApB,EAAyBwB,EAAzB,KAA8B,IAApC;AAAyC,QAAIE,aAAa,GAAC,CAAC,GAAE/C,uBAAuB,CAACD,OAA3B,EAAoC+C,KAApC,CAAlB;AAA6DC,IAAAA,aAAa,CAACC,QAAd,GAAuB,CAAvB;AAAyBD,IAAAA,aAAa,CAACE,GAAd,GAAkBJ,EAAlB;AAAqBE,IAAAA,aAAa,CAACG,eAAd,GAA8B,EAA9B;AAAiCH,IAAAA,aAAa,CAACI,kBAAd,GAAiC,EAAjC;AAAoCJ,IAAAA,aAAa,CAACK,SAAd,CAAwB,cAAxB;;AAAwCL,IAAAA,aAAa,CAACM,kBAAd;;AAAmC,WAAOP,KAAP;AAAa;;AAAA,MAAIQ,MAAM,GAACX,aAAa,CAACY,SAAzB;;AAAmCD,EAAAA,MAAM,CAACE,iBAAP,GAAyB,SAASA,iBAAT,GAA4B;AAAC,WAAO,IAAP;AAAY,GAAlE;;AAAmEF,EAAAA,MAAM,CAACG,QAAP,GAAgB,SAASA,QAAT,GAAmB;AAAC,QAAInD,SAAS,GAAC,IAAd;AAAA,QAAmBoD,SAAS,GAACpD,SAAS,CAACqD,QAAV,CAAmB,SAAnB,CAA7B;;AAA2D,QAAGrD,SAAS,CAACkD,iBAAV,MAA+BE,SAAlC,EAA4C;AAACpD,MAAAA,SAAS,CAAC8C,SAAV,CAAoB,SAApB;AAA+B9C,MAAAA,SAAS,CAACsD,SAAV,CAAoB,MAApB;;AAA4BtD,MAAAA,SAAS,CAACuD,oBAAV;;AAAiCH,MAAAA,SAAS,GAACpD,SAAS,CAACwD,MAAV,CAAiB,mBAAjB,EAAsC,YAAU;AAAC,eAAOxD,SAAS,CAACyD,QAAV,EAAP;AAA4B,OAA7E,EAA+E3D,UAAU,CAAC4D,YAAX,CAAwBC,UAAvG,CAAD,GAAoH3D,SAAS,CAAC4D,IAAV,IAAgB5D,SAAS,CAAC4D,IAAV,EAA7I;AAA8J5D,MAAAA,SAAS,CAAC6D,gBAAV;;AAA6B7D,MAAAA,SAAS,CAAC8D,qBAAV;;AAAkC9D,MAAAA,SAAS,CAAC8C,SAAV,CAAoB,OAApB;AAA6B;AAAC,GAAne;;AAAoeE,EAAAA,MAAM,CAACe,OAAP,GAAe,SAASA,OAAT,GAAkB;AAAC,QAAI/D,SAAS,GAAC,IAAd;AAAA,QAAmBgE,eAAnB;AAAmChE,IAAAA,SAAS,CAACiE,QAAV,IAAoBjE,SAAS,CAACiE,QAAV,EAApB;AAAyCjE,IAAAA,SAAS,CAACkE,QAAV,CAAmB,SAAnB,EAA6B,IAA7B;AAAmCF,IAAAA,eAAe,GAAChE,SAAS,CAACmE,WAAV,EAAhB;;AAAwC,QAAGH,eAAH,EAAmB;AAAChE,MAAAA,SAAS,CAACoE,YAAV,CAAwB,UAASC,KAAT,EAAe;AAACA,QAAAA,KAAK,CAACJ,QAAN,IAAgBI,KAAK,CAACJ,QAAN,EAAhB;AAAiCI,QAAAA,KAAK,IAAEA,KAAK,CAACH,QAAN,CAAe,SAAf,EAAyB,IAAzB,CAAP;AAAsC,OAA/G,EAAiH,IAAjH;AAAuH;AAAC,GAArU;;AAAsUlB,EAAAA,MAAM,CAACsB,YAAP,GAAoB,SAASA,YAAT,CAAsBC,KAAtB,EAA4BC,MAA5B,EAAmC;AAAC,SAAKC,MAAL,CAAYF,KAAZ,GAAkBA,KAAlB;AAAwB,SAAKE,MAAL,CAAYD,MAAZ,GAAmBA,MAAnB;AAA0B,GAA1G;;AAA2GxB,EAAAA,MAAM,CAAC0B,cAAP,GAAsB,SAASA,cAAT,CAAwBzC,CAAxB,EAA0BC,CAA1B,EAA4B;AAAC,QAAIuC,MAAM,GAAC,KAAKA,MAAhB;AAAuBA,IAAAA,MAAM,CAACE,WAAP,GAAmB1C,CAAnB;AAAqBwC,IAAAA,MAAM,CAACG,WAAP,GAAmB1C,CAAnB;AAAqBuC,IAAAA,MAAM,CAACI,SAAP,GAAiB,MAAI5C,CAAJ,GAAM,GAAN,GAAUC,CAA3B;AAA6B,GAAjJ;;AAAkJc,EAAAA,MAAM,CAAC8B,cAAP,GAAsB,SAASA,cAAT,GAAyB;AAAC,WAAM;AAAC7C,MAAAA,CAAC,EAAC,KAAKwC,MAAL,CAAYE,WAAf;AAA2BzC,MAAAA,CAAC,EAAC,KAAKuC,MAAL,CAAYG;AAAzC,KAAN;AAA4D,GAA5G;;AAA6G5B,EAAAA,MAAM,CAACO,oBAAP,GAA4B,SAASA,oBAAT,GAA+B;AAAC,QAAId,aAAa,GAAC,IAAlB;AAAuBA,IAAAA,aAAa,CAACsC,kBAAd,GAAiCtC,aAAa,CAACuC,eAA/C;AAA+DvC,IAAAA,aAAa,CAACuC,eAAd,GAA8B,EAA9B;AAAiC,GAAnL;;AAAoLhC,EAAAA,MAAM,CAACiC,gBAAP,GAAwB,SAASA,gBAAT,GAA2B;AAAC,WAAO,KAAKR,MAAL,CAAYS,YAAnB;AAAgC,GAApF;;AAAqFlC,EAAAA,MAAM,CAACmC,mBAAP,GAA2B,SAASA,mBAAT,CAA6BC,kBAA7B,EAAgDC,UAAhD,EAA2D;AAAC,QAAGD,kBAAkB,KAAG,KAAK,CAA7B,EAA+B;AAACA,MAAAA,kBAAkB,GAAC,EAAnB;AAAsB;;AAAA,QAAGC,UAAU,KAAG,KAAK,CAArB,EAAuB;AAACA,MAAAA,UAAU,GAAC,KAAX;AAAiB;;AAAA,QAAI5C,aAAa,GAAC,IAAlB;AAAA,QAAuBxB,KAAK,GAACmE,kBAAkB,CAACnE,KAAhD;AAAA,QAAsDqE,KAAK,GAAC7C,aAAa,CAACuC,eAAd,CAA8B/D,KAA9B,MAAuCwB,aAAa,CAACuC,eAAd,CAA8B/D,KAA9B,IAAqC;AAACC,MAAAA,SAAS,EAAC,EAAX;AAAcqE,MAAAA,KAAK,EAAC,EAApB;AAAuBC,MAAAA,QAAQ,EAAC,EAAhC;AAAmCC,MAAAA,aAAa,EAAC,CAAC;AAAlD,KAA5E,CAA5D;AAAA,QAA8LC,MAA9L;AAAA,QAAqMC,UAArM;AAAA,QAAgNC,eAAhN;AAAA,QAAgOC,OAAO,GAAC,IAAxO;AAAA,QAA6OC,QAAQ,GAACrD,aAAa,CAACsC,kBAAd,IAAkCtC,aAAa,CAACsC,kBAAd,CAAiC9D,KAAjC,CAAxR;AAAA,QAAgU8E,QAAQ,GAACT,KAAK,CAACG,aAAN,IAAqB,CAA9V;AAAA,QAAgWO,QAAhW;AAAA,QAAyWC,IAAzW;AAAA,QAA8WC,iBAAiB,GAACd,kBAAkB,CAACvD,IAAnZ;AAAA,QAAwZU,EAAE,GAAC6C,kBAAkB,CAAC7C,EAA9a;;AAAib,QAAGuD,QAAH,EAAY;AAAC,UAAGvD,EAAE,IAAEuD,QAAQ,CAACP,KAAT,CAAehD,EAAf,MAAqB1C,IAAI,CAACkC,KAAjC,EAAuC;AAACiE,QAAAA,QAAQ,GAACF,QAAQ,CAACP,KAAT,CAAehD,EAAf,CAAT;AAA4B0D,QAAAA,IAAI,GAACH,QAAQ,CAAC5E,SAAT,CAAmB8E,QAAnB,CAAL;AAAkC,eAAOF,QAAQ,CAAC5E,SAAT,CAAmB8E,QAAnB,CAAP;AAAoC,eAAOF,QAAQ,CAACN,QAAT,CAAkBQ,QAAlB,CAAP;AAAmC,eAAOF,QAAQ,CAACP,KAAT,CAAehD,EAAf,CAAP;AAA0B,OAAvM,MAA4M,IAAGuD,QAAQ,CAAC5E,SAAT,CAAmB6E,QAAnB,CAAH,EAAgC;AAAC,YAAG,CAACD,QAAQ,CAACN,QAAT,CAAkBO,QAAlB,CAAJ,EAAgC;AAACE,UAAAA,IAAI,GAACH,QAAQ,CAAC5E,SAAT,CAAmB6E,QAAnB,CAAL;AAAkC,iBAAOD,QAAQ,CAAC5E,SAAT,CAAmB6E,QAAnB,CAAP;AAAoC;AAAC;AAAC;;AAAA,QAAGX,kBAAkB,CAACe,EAAnB,KAAwB,MAAxB,IAAgCf,kBAAkB,CAACgB,GAAtD,EAA0D;AAAC,OAAC,GAAEvG,IAAI,CAACwG,eAAR,EAAyBjB,kBAAkB,CAACgB,GAA5C;AAAiD;;AAAA,QAAGH,IAAH,EAAQ;AAACb,MAAAA,kBAAkB,CAACe,EAAnB,GAAsBF,IAAtB;AAA2BJ,MAAAA,OAAO,GAAC,KAAR;;AAAc,UAAGK,iBAAiB,GAAC5E,0BAA0B,CAAC8D,kBAAkB,CAACvD,IAApB,EAAyBoE,IAAI,CAACK,KAA9B,CAA/C,EAAoF;AAAClB,QAAAA,kBAAkB,CAACvD,IAAnB,GAAwBqE,iBAAxB;AAA0C;;AAAA,UAAGd,kBAAkB,CAACgB,GAAnB,KAAyBT,UAAU,GAACrE,0BAA0B,CAAC8D,kBAAkB,CAACgB,GAApB,EAAwBH,IAAI,CAACK,KAA7B,EAAmCL,IAAI,CAACM,MAAxC,CAA9D,CAAH,EAAkH;AAACnB,QAAAA,kBAAkB,CAACgB,GAAnB,GAAuBT,UAAvB;AAAkC;AAAC;;AAAA,QAAGC,eAAe,GAACR,kBAAkB,CAACoB,SAAtC,EAAgD;AAACd,MAAAA,MAAM,GAACE,eAAe,CAACa,QAAhB,GAAyBhE,aAAa,CAACiE,eAAd,EAAzB,GAAyDjE,aAAhE;AAA8E2C,MAAAA,kBAAkB,CAACoB,SAAnB,GAA6Bd,MAAM,CAAClF,mBAAP,CAA2BoF,eAAe,CAACrD,EAA3C,EAA8CqD,eAAe,CAAC3E,KAA9D,KAAsEyE,MAAM,CAACiB,iBAAP,CAAyBf,eAAe,CAACrD,EAAzC,CAAnG;AAAgJ,KAA/Q,MAAmR;AAAC6C,MAAAA,kBAAkB,CAACoB,SAAnB,GAA6B/D,aAAa,CAACmE,UAAd,CAAyB,iBAAzB,CAA7B;AAAyE;;AAAA,KAACV,iBAAiB,IAAEP,UAApB,MAAkCM,IAAI,GAACxD,aAAa,CAACmE,UAAd,CAAyB,kBAAzB,EAA6CC,YAA7C,CAA0DzB,kBAA1D,CAAvC;AAAsHE,IAAAA,KAAK,CAACpE,SAAN,CAAgB6E,QAAhB,IAA0BE,IAA1B;;AAA+B,QAAG1D,EAAH,EAAM;AAAC,UAAG+C,KAAK,CAACC,KAAN,CAAYhD,EAAZ,CAAH,EAAmB;AAAC,eAAO+C,KAAK,CAACE,QAAN,CAAeF,KAAK,CAACC,KAAN,CAAYhD,EAAZ,CAAf,CAAP;AAAuC,eAAO+C,KAAK,CAACC,KAAN,CAAYhD,EAAZ,CAAP;AAAuB;;AAAA+C,MAAAA,KAAK,CAACC,KAAN,CAAYhD,EAAZ,IAAgBwD,QAAhB;AAAyBT,MAAAA,KAAK,CAACE,QAAN,CAAeO,QAAf,IAAyBxD,EAAzB;AAA4B;;AAAAE,IAAAA,aAAa,CAACK,SAAd,CAAwB,0BAAxB,EAAmD;AAAC1C,MAAAA,OAAO,EAAC6F;AAAT,KAAnD;AAAmEA,IAAAA,IAAI,CAAC5F,WAAL,GAAiBgF,UAAjB;AAA4BD,IAAAA,kBAAkB,CAAC0B,MAAnB,IAA2Bb,IAAI,CAACa,MAAL,CAAY1B,kBAAkB,CAAC0B,MAA/B,CAA3B;AAAkE1B,IAAAA,kBAAkB,CAAC2B,WAAnB,KAAiClH,IAAI,CAACkC,KAAtC,IAA6CkE,IAAI,CAACc,WAAL,CAAiB3B,kBAAkB,CAAC2B,WAApC,EAAgD,CAAC,GAAElH,IAAI,CAACmH,YAAR,EAAsB,CAAC,GAAEnH,IAAI,CAACiC,KAAR,EAAesD,kBAAkB,CAACgB,GAAnB,CAAuBa,IAAtC,EAA2C7B,kBAAkB,CAACvD,IAAnB,CAAwBoF,IAAnE,CAAtB,CAAhD,CAA7C;AAA8L7B,IAAAA,kBAAkB,CAAC8B,QAAnB,KAA8BrH,IAAI,CAACkC,KAAnC,IAA0CU,aAAa,CAACmE,UAAd,CAAyB,mBAAzB,EAA8CO,aAA9C,CAA4DlB,IAA5D,EAAiEb,kBAAkB,CAAC8B,QAApF,CAA1C;AAAwIzE,IAAAA,aAAa,CAACgC,MAAd,CAAqBS,YAArB,GAAkCe,IAAlC;AAAuC,KAACZ,UAAD,IAAaQ,OAAb,IAAsB,CAAC,GAAEjG,cAAc,CAACwH,qBAAlB,EAAyCnB,IAAzC,EAA8CxD,aAAa,CAAC4E,gBAA5D,EAA6E5E,aAA7E,CAAtB;AAAkH,GAA7nF;;AAA8nFO,EAAAA,MAAM,CAACsE,sBAAP,GAA8B,SAASA,sBAAT,CAAgCC,IAAhC,EAAqCtG,KAArC,EAA2C;AAAC,QAAIwB,aAAa,GAAC,IAAlB;AAAA,QAAuB+E,QAAQ,GAAC/E,aAAa,CAACuC,eAA9C;AAAA,QAA8DyC,iBAA9D;AAAA,QAAgFrH,OAAhF;AAAA,QAAwFsH,KAAxF;;AAA8F,QAAG,OAAOH,IAAP,KAAc,QAAjB,EAA0B;AAAC5G,MAAAA,iBAAiB,CAAC6G,QAAD,EAAW,UAASnD,KAAT,EAAerD,SAAf,EAAyBG,CAAzB,EAA2B;AAAC,YAAGoG,IAAI,KAAGlD,KAAV,EAAgB;AAACqD,UAAAA,KAAK,GAAC,IAAN;;AAAWjF,UAAAA,aAAa,CAACkF,cAAd,CAA6BtD,KAA7B,EAAmCrD,SAAnC;;AAA8CyG,UAAAA,iBAAiB,GAACD,QAAQ,CAACxG,SAAD,CAA1B;AAAsCyG,UAAAA,iBAAiB,CAACvG,SAAlB,CAA4B0G,MAA5B,CAAmCzG,CAAnC,EAAqC,CAArC;AAAwC,iBAAOsG,iBAAiB,CAAClC,KAAlB,CAAwBkC,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,CAAxB,CAAP;AAA8D,iBAAOsG,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,CAAP;AAAqC,iBAAO,IAAP;AAAY;AAAC,OAA/S,CAAjB;AAAmU,KAA9V,MAAkW;AAACR,MAAAA,iBAAiB,CAAC6G,QAAD,EAAW,UAASnD,KAAT,EAAewD,YAAf,EAA4B1G,CAA5B,EAA8B;AAACsG,QAAAA,iBAAiB,GAACD,QAAQ,CAACK,YAAD,CAA1B;;AAAyC,YAAGJ,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,MAAgCoG,IAAhC,KAAuCtG,KAAK,GAACA,KAAK,KAAG4G,YAAT,GAAsB,IAAlE,CAAH,EAA2E;AAACH,UAAAA,KAAK,GAAC,IAAN;;AAAWjF,UAAAA,aAAa,CAACkF,cAAd,CAA6BtD,KAA7B,EAAmCwD,YAAnC;;AAAiDJ,UAAAA,iBAAiB,CAACvG,SAAlB,CAA4B0G,MAA5B,CAAmCzG,CAAnC,EAAqC,CAArC;AAAwC,iBAAOsG,iBAAiB,CAAClC,KAAlB,CAAwBkC,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,CAAxB,CAAP;AAA8D,iBAAOsG,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,CAAP;AAAqC,iBAAO,IAAP;AAAY;AAAC,OAAnX,CAAjB;AAAuY;;AAAA,QAAGuG,KAAH,EAAS;AAAC,WAAK5E,SAAL,CAAe,yBAAf,EAAyC;AAAC1C,QAAAA,OAAO,EAACA;AAAT,OAAzC;AAA4D;AAAC,GAAz9B;;AAA09B4C,EAAAA,MAAM,CAAC2D,iBAAP,GAAyB,SAASA,iBAAT,CAA2BmB,IAA3B,EAAgC;AAAC,WAAO,KAAKtH,mBAAL,CAAyBX,IAAI,CAACkC,KAA9B,EAAoC+F,IAApC,CAAP;AAAiD,GAA3G;;AAA4G9E,EAAAA,MAAM,CAACc,qBAAP,GAA6B,SAASA,qBAAT,GAAgC;AAAC,QAAIrB,aAAa,GAAC,IAAlB;AAAA,QAAuB+E,QAAQ,GAAC/E,aAAa,CAACsC,kBAA9C;AAAA,QAAiE0C,iBAAjE;;AAAmF9G,IAAAA,iBAAiB,CAAC6G,QAAD,EAAW,UAASnD,KAAT,EAAerD,SAAf,EAAyBG,CAAzB,EAA2B;AAAC,UAAGkD,KAAH,EAAS;AAAC5B,QAAAA,aAAa,CAACkF,cAAd,CAA6BtD,KAA7B,EAAmCrD,SAAnC;;AAA8CyG,QAAAA,iBAAiB,GAACD,QAAQ,CAACxG,SAAD,CAA1B;AAAsC,eAAOyG,iBAAiB,CAAClC,KAAlB,CAAwBkC,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,CAAxB,CAAP;AAA8D,eAAOsG,iBAAiB,CAACjC,QAAlB,CAA2BrE,CAA3B,CAAP;AAAqC;AAAC,KAAzO,CAAjB;AAA6P,GAA9Y;;AAA+Y6B,EAAAA,MAAM,CAACxC,mBAAP,GAA2B,SAASA,mBAAT,CAA6B+B,EAA7B,EAAgCtB,KAAhC,EAAsC;AAAC,QAAID,SAAJ;AAAA,QAAcyG,iBAAd;AAAA,QAAgCxB,IAAhC;AAAA,QAAqC9E,CAArC;AAAA,QAAuCqG,QAAQ,GAAC,KAAKxC,eAArD;;AAAqE,QAAG,CAAC/D,KAAD,IAAQ,CAACsB,EAAZ,EAAe;AAAC,aAAOiF,QAAP;AAAgB;;AAAA,QAAG,CAACvG,KAAJ,EAAU;AAACV,MAAAA,gBAAgB,CAACiH,QAAD,EAAW,YAAU;AAACrG,QAAAA,CAAC,GAAC4G,SAAS,CAAC,CAAD,CAAX;AAAeN,QAAAA,iBAAiB,GAACD,QAAQ,CAACO,SAAS,CAAC,CAAD,CAAV,CAA1B;;AAAyC,YAAGN,iBAAiB,CAAClC,KAAlB,CAAwBpE,CAAxB,MAA6BoB,EAAhC,EAAmC;AAAC0D,UAAAA,IAAI,GAACwB,iBAAiB,CAACvG,SAAlB,CAA4BC,CAA5B,CAAL;AAAoC,iBAAO,IAAP;AAAY;AAAC,OAAnK,CAAhB;;AAAsL,aAAO8E,IAAP;AAAY;;AAAAjF,IAAAA,SAAS,GAACwG,QAAQ,CAACvG,KAAD,CAAlB;;AAA0B,QAAG,CAACsB,EAAJ,EAAO;AAAC,aAAOvB,SAAS,IAAEA,SAAS,CAACE,SAArB,IAAgCF,SAAS,CAACE,SAAV,CAAoB,CAApB,CAAvC;AAA8D;;AAAA,WAAOF,SAAS,IAAEA,SAAS,CAACE,SAArB,IAAgCF,SAAS,CAACE,SAAV,CAAoBF,SAAS,CAACuE,KAAV,CAAgBhD,EAAhB,CAApB,CAAvC;AAAgF,GAApiB;;AAAqiBS,EAAAA,MAAM,CAACgF,gBAAP,GAAwB,SAASA,gBAAT,CAA0B/H,SAA1B,EAAoCY,QAApC,EAA6CoH,OAA7C,EAAqD;AAAC,QAAIC,WAAW,GAAC5F,cAAc,CAACW,SAAf,CAAyB+E,gBAAzB,CAA0CjH,IAA1C,CAA+C,IAA/C,EAAoDd,SAApD,EAA8DY,QAA9D,EAAuEoH,OAAvE,CAAhB;;AAAgG,QAAGC,WAAW,KAAG,IAAjB,EAAsB;AAACnI,MAAAA,qBAAqB,CAAC,IAAD,EAAME,SAAN,EAAgB,KAAKoH,gBAAL,CAAsBpH,SAAtB,CAAhB,CAArB;AAAuE,aAAOY,QAAP;AAAgB,KAA9G,MAAmH,IAAGqH,WAAH,EAAe;AAAC,aAAOrH,QAAP;AAAgB;;AAAA,WAAO,KAAP;AAAa,GAA9U;;AAA+UmC,EAAAA,MAAM,CAACmF,mBAAP,GAA2B,SAASA,mBAAT,CAA6BlI,SAA7B,EAAuCY,QAAvC,EAAgD;AAAC,QAAGyB,cAAc,CAACW,SAAf,CAAyBkF,mBAAzB,CAA6CpH,IAA7C,CAAkD,IAAlD,EAAuDd,SAAvD,EAAiEY,QAAjE,CAAH,EAA8E;AAACJ,MAAAA,0BAA0B,CAAC,IAAD,EAAMR,SAAN,EAAgB,KAAKoH,gBAAL,CAAsBpH,SAAtB,CAAhB,CAA1B;AAA4E;AAAC,GAAxO;;AAAyO+C,EAAAA,MAAM,CAACS,QAAP,GAAgB,SAASA,QAAT,GAAmB;AAAC,QAAIzD,SAAS,GAAC,IAAd;AAAA,QAAmBoI,QAAnB;AAAA,QAA4BjH,CAA5B;AAAA,QAA8BlB,SAA9B;AAAA,QAAwCoI,YAAxC;;AAAqD,QAAGrI,SAAS,IAAEA,SAAS,KAAGsI,MAAvB,IAA+BtI,SAAS,CAACuI,UAAV,KAAuB,IAAzD,EAA8D;AAACvI,MAAAA,SAAS,CAACuI,UAAV,GAAqB,IAArB;AAA0BvI,MAAAA,SAAS,CAAC8C,SAAV,CAAoB,cAApB;;AAAoC,UAAG9C,SAAS,CAACwI,aAAb,EAA2B;AAAC,aAAIvI,SAAJ,IAAiBD,SAAS,CAACwI,aAA3B,EAAyC;AAACH,UAAAA,YAAY,GAACrI,SAAS,CAACwI,aAAV,CAAwBvI,SAAxB,CAAb;;AAAgD,eAAIkB,CAAC,GAACkH,YAAY,CAACjH,MAAb,GAAoB,CAA1B,EAA4BD,CAAC,IAAE,CAA/B,EAAiCA,CAAC,EAAlC,EAAqC;AAAC,gBAAGkH,YAAY,CAAClH,CAAD,CAAZ,CAAgBnB,SAAhB,IAA2BqI,YAAY,CAAClH,CAAD,CAAZ,CAAgBnB,SAAhB,CAA0BgI,gBAAxD,EAAyE;AAACK,cAAAA,YAAY,CAAClH,CAAD,CAAZ,CAAgBnB,SAAhB,CAA0BmI,mBAA1B,CAA8ClI,SAA9C,EAAwDoI,YAAY,CAAClH,CAAD,CAAZ,CAAgBsH,EAAxE;AAA4E;AAAC;AAAC;AAAC;;AAAAzI,MAAAA,SAAS,CAAC0I,aAAV;;AAA0B,UAAG1I,SAAS,CAAC2I,aAAV,IAAyB3I,SAAS,CAAC2I,aAAV,CAAwBC,mBAAxB,OAAgD,CAA5E,EAA8E;AAAC5I,QAAAA,SAAS,CAAC2I,aAAV,CAAwBE,YAAxB,CAAqC7I,SAArC;AAAgD;;AAAA,UAAGA,SAAS,CAAC4G,UAAV,CAAqB,OAArB,KAA+B,CAAC5G,SAAS,CAAC4G,UAAV,CAAqB,OAArB,EAA8BkC,OAAjE,EAAyE;AAACvI,QAAAA,gBAAgB,CAACP,SAAS,CAACQ,mBAAV,EAAD,EAAiCR,SAAS,CAAC+I,iBAA3C,CAAhB;AAA8E;;AAAA,WAAIX,QAAJ,IAAgBpI,SAAhB,EAA0B;AAAC,YAAGA,SAAS,CAACc,cAAV,CAAyBsH,QAAzB,CAAH,EAAsC;AAAC,iBAAOpI,SAAS,CAACoI,QAAD,CAAhB;AAA2B;AAAC;;AAAApI,MAAAA,SAAS,CAAC8C,SAAV,CAAoB,SAApB;AAA+B;AAAC,GAA17B;;AAA27BE,EAAAA,MAAM,CAACgG,SAAP,GAAiB,SAASA,SAAT,CAAmBC,OAAnB,EAA2B;AAAC,SAAKC,oBAAL;;AAA4B5G,IAAAA,cAAc,CAACW,SAAf,CAAyB+F,SAAzB,CAAmCjI,IAAnC,CAAwC,IAAxC,EAA6CkI,OAA7C;AAAsD,GAA/H;;AAAgIjG,EAAAA,MAAM,CAACkG,oBAAP,GAA4B,SAASA,oBAAT,GAA+B;AAAC,QAAIzG,aAAa,GAAC,IAAlB;;AAAuBA,IAAAA,aAAa,CAACI,kBAAd,CAAiCsG,IAAjC,CAAsC1G,aAAa,CAACG,eAApD;;AAAqEH,IAAAA,aAAa,CAACG,eAAd,GAA8B,EAA9B;AAAiC,GAAzL;;AAA0LI,EAAAA,MAAM,CAACoB,YAAP,GAAoB,SAASA,YAAT,CAAsBvD,QAAtB,EAA+BuI,QAA/B,EAAwC;AAAC,QAAGA,QAAH,EAAY;AAACzI,MAAAA,iBAAiB,CAAC,KAAKwD,WAAL,EAAD,EAAoBtD,QAApB,CAAjB;AAA+C,KAA5D,MAAgE;AAACN,MAAAA,gBAAgB,CAAC,KAAK4D,WAAL,EAAD,EAAoBtD,QAApB,CAAhB;AAA8C;AAAC,GAA7K;;AAA8KmC,EAAAA,MAAM,CAACqG,WAAP,GAAmB,SAASA,WAAT,CAAqBC,SAArB,EAA+BC,aAA/B,EAA6ChH,EAA7C,EAAgD;AAAC,QAAIE,aAAa,GAAC,IAAlB;AAAA,QAAuB6C,KAAK,GAAC7C,aAAa,CAACG,eAAd,CAA8B2G,aAA9B,MAA+C9G,aAAa,CAACG,eAAd,CAA8B2G,aAA9B,IAA6C;AAACrI,MAAAA,SAAS,EAAC,EAAX;AAAcqE,MAAAA,KAAK,EAAC,EAApB;AAAuBC,MAAAA,QAAQ,EAAC,EAAhC;AAAmCC,MAAAA,aAAa,EAAC,CAAC;AAAlD,KAA5F,CAA7B;AAAA,QAA+KK,QAAQ,GAACrD,aAAa,CAACI,kBAAd,IAAkCJ,aAAa,CAACI,kBAAd,CAAiCzB,MAAnE,IAA2EqB,aAAa,CAACI,kBAAd,CAAiCJ,aAAa,CAACI,kBAAd,CAAiCzB,MAAjC,GAAwC,CAAzE,EAA4EmI,aAA5E,CAAnQ;AAAA,QAA8VxD,QAAQ,GAACT,KAAK,CAACG,aAAN,IAAqB,CAA5X;AAAA,QAA8XO,QAA9X;AAAA,QAAuYwD,IAAvY;;AAA4Y,QAAG1D,QAAH,EAAY;AAAC,UAAI2D,aAAa,GAAC3D,QAAQ,CAAC5E,SAA3B;AAAA,UAAqCwI,cAAc,GAACD,aAAa,CAAC1D,QAAD,CAAjE;;AAA4E,UAAGxD,EAAE,IAAEuD,QAAQ,CAACP,KAAT,CAAehD,EAAf,MAAqB1C,IAAI,CAACkC,KAAjC,EAAuC;AAACiE,QAAAA,QAAQ,GAACF,QAAQ,CAACP,KAAT,CAAehD,EAAf,CAAT;AAA4BiH,QAAAA,IAAI,GAACC,aAAa,CAACzD,QAAD,CAAlB;AAA6B,eAAOyD,aAAa,CAACzD,QAAD,CAApB;AAA+B,eAAOF,QAAQ,CAACN,QAAT,CAAkBQ,QAAlB,CAAP;AAAmC,eAAOF,QAAQ,CAACP,KAAT,CAAehD,EAAf,CAAP;AAA0B,OAA7L,MAAkM,IAAGmH,cAAc,IAAEA,cAAc,CAACC,WAAf,KAA6BL,SAAhD,EAA0D;AAAC,YAAG,CAACxD,QAAQ,CAACN,QAAT,CAAkBO,QAAlB,CAAJ,EAAgC;AAACyD,UAAAA,IAAI,GAACE,cAAL;AAAoB,iBAAOD,aAAa,CAAC1D,QAAD,CAApB;AAA+B;AAAC;AAAC;;AAAA,QAAG,CAACyD,IAAJ,EAAS;AAACA,MAAAA,IAAI,GAAC,IAAIF,SAAJ,CAAc/G,EAAd,CAAL;AAAuB;;AAAA+C,IAAAA,KAAK,CAACpE,SAAN,CAAgB6E,QAAhB,IAA0ByD,IAA1B;;AAA+B,QAAGjH,EAAH,EAAM;AAAC+C,MAAAA,KAAK,CAACC,KAAN,CAAYhD,EAAZ,IAAgBwD,QAAhB;AAAyBT,MAAAA,KAAK,CAACE,QAAN,CAAeO,QAAf,IAAyBxD,EAAzB;AAA4B;;AAAAiH,IAAAA,IAAI,CAACI,gBAAL,CAAsBnH,aAAtB;;AAAqC,WAAO+G,IAAP;AAAY,GAAziC;;AAA0iCxG,EAAAA,MAAM,CAACa,gBAAP,GAAwB,SAASA,gBAAT,GAA2B;AAAC,QAAI7D,SAAS,GAAC,IAAd;;AAAmBA,IAAAA,SAAS,CAACoE,YAAV,CAAwB,UAASC,KAAT,EAAe;AAACA,MAAAA,KAAK,IAAEA,KAAK,CAACT,IAAb,IAAmBS,KAAK,CAAClB,QAAN,EAAnB;AAAoC,KAA5E;;AAA+EnD,IAAAA,SAAS,CAAC6J,qBAAV;AAAkC,GAAxL;;AAAyL7G,EAAAA,MAAM,CAAC6G,qBAAP,GAA6B,SAASA,qBAAT,GAAgC;AAAC,QAAIpH,aAAa,GAAC,IAAlB;AAAA,QAAuBqD,QAAQ,GAACrD,aAAa,CAACI,kBAA9C;AAAA,QAAiEiH,CAAC,GAAChE,QAAQ,CAAC1E,MAA5E;AAAA,QAAmFD,CAAC,GAAC,CAArF;AAAA,QAAuF4I,UAAU,GAAC,SAASA,UAAT,CAAoB1F,KAApB,EAA0B;AAAC,UAAGA,KAAH,EAAS;AAACA,QAAAA,KAAK,CAACN,OAAN;;AAAgBM,QAAAA,KAAK,CAAClB,QAAN;;AAAiBkB,QAAAA,KAAK,CAACuF,gBAAN,CAAuB/J,IAAI,CAACkC,KAA5B;AAAmC;AAAC,KAA5M;;AAA6M,WAAKZ,CAAC,GAAC2I,CAAP,EAAS3I,CAAC,IAAE,CAAZ,EAAc;AAACR,MAAAA,iBAAiB,CAACmF,QAAQ,CAAC3E,CAAD,CAAT,EAAa4I,UAAb,CAAjB;AAA0C;;AAAAtH,IAAAA,aAAa,CAACI,kBAAd,CAAiCzB,MAAjC,GAAwC,CAAxC;AAA0C,GAA9W;;AAA+W4B,EAAAA,MAAM,CAACgH,QAAP,GAAgB,SAASA,QAAT,CAAkBzH,EAAlB,EAAqBgH,aAArB,EAAmC;AAAC,QAAIU,WAAJ;;AAAgB,SAAKC,eAAL,CAAqB3H,EAArB,EAAyB,UAAS4H,UAAT,EAAoB;AAACF,MAAAA,WAAW,GAACE,UAAZ;AAAuB,KAArE,EAAuEZ,aAAvE;;AAAsF,WAAOU,WAAP;AAAmB,GAA7K;;AAA8KjH,EAAAA,MAAM,CAACkH,eAAP,GAAuB,SAASA,eAAT,CAAyB3H,EAAzB,EAA4B6H,EAA5B,EAA+BC,cAA/B,EAA8C;AAAC,QAAIC,cAAc,GAAC,KAAK1H,eAAxB;AAAA,QAAwC2H,OAAxC;AAAA,QAAgD/E,QAAhD;AAAA,QAAyDgF,SAAzD;AAAA,QAAmEjB,aAAa,GAACc,cAAjF;;AAAgG,QAAG9H,EAAH,EAAM;AAAC5B,MAAAA,iBAAiB,CAAC2J,cAAD,EAAiB,UAASjG,KAAT,EAAeoG,oBAAf,EAAoCtJ,CAApC,EAAsC;AAACqE,QAAAA,QAAQ,GAAC8E,cAAc,CAACG,oBAAD,CAAd,CAAqCjF,QAA9C;;AAAuD,YAAGA,QAAQ,CAACrE,CAAD,CAAR,KAAcoB,EAAd,KAAmBgH,aAAa,GAACA,aAAa,KAAGkB,oBAAjB,GAAsC,IAAtE,CAAH,EAA+E;AAACD,UAAAA,SAAS,GAACnG,KAAV;AAAgBkG,UAAAA,OAAO,GAACpJ,CAAR;AAAUoI,UAAAA,aAAa,GAACkB,oBAAd;AAAmC,iBAAO,IAAP;AAAY;AAAC,OAAzQ,CAAjB;AAA6R,KAApS,MAAwS;AAACD,MAAAA,SAAS,GAACF,cAAc,CAACf,aAAD,CAAd,IAA+Be,cAAc,CAACf,aAAD,CAAd,CAA8BrI,SAAvE;AAAiF;;AAAA,QAAGsJ,SAAH,EAAa;AAAC,aAAOJ,EAAE,CAACI,SAAD,EAAWD,OAAX,EAAmBhB,aAAnB,CAAT;AAA2C;AAAC,GAA1lB;;AAA2lBvG,EAAAA,MAAM,CAACmB,WAAP,GAAmB,SAASA,WAAT,CAAqBoF,aAArB,EAAmC;AAAC,WAAOA,aAAa,GAAC,KAAK3G,eAAL,CAAqB2G,aAArB,KAAqC,KAAK3G,eAAL,CAAqB2G,aAArB,EAAoCrI,SAA1E,GAAoF,KAAK0B,eAA7G;AAA6H,GAApL;;AAAqLI,EAAAA,MAAM,CAAC6F,YAAP,GAAoB,SAASA,YAAT,GAAuB;AAAC,WAAO,IAAP;AAAY,GAAxD;;AAAyD,SAAOxG,aAAP;AAAqB,CAA7lW,CAA8lWzC,cAAc,CAACH,OAA7mW,CAAlB;;AAAwoW,IAAIiL,QAAQ,GAACrI,aAAb;AAA2B9C,OAAO,CAACE,OAAR,GAAgBiL,QAAhB","sourcesContent":["\"use strict\";var _interopRequireWildcard=require(\"@babel/runtime/helpers/interopRequireWildcard\");var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.default=void 0;var _assertThisInitialized2=_interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));var _inheritsLoose2=_interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));var _componentBase=_interopRequireWildcard(require(\"./component-base\"));var _lib=require(\"../lib\");var _schedular=require(\"../schedular\");var addEventOnAllGraphics=function addEventOnAllGraphics(component,eventType,listener){var callBack;if(eventType&&listener){callBack=function callBack(element){!element._skipEvents&&element.on&&element.on(eventType,listener)};_mapSubFnForward(component.getGraphicalElement(),callBack)}},removeEventFromAllGraphics=function removeEventFromAllGraphics(component,eventType,listener){var callBack;if(eventType&&listener){callBack=function callBack(element){!element._skipEvents&&element.off&&element.off(eventType,listener)};_mapSubFnForward(component.getGraphicalElement(),callBack)}},_mapSubFnBackward=function _mapSubFnBackward(sub,callback){if(sub&&sub.hasOwnProperty&&callback&&callback.call){var currLabel,label,elemStore,i;for(label in sub){currLabel=sub[label];elemStore=currLabel.elemStore;for(i=elemStore&&elemStore.length-1;i>=0;i--){if(callback(elemStore[i],label,i)){break}}}}},_mapSubFnForward=function _mapSubFnForward(sub,callback){if(sub&&sub.hasOwnProperty&&callback&&callback.call){var currLabel,ii,label,elemStore,i;for(label in sub){currLabel=sub[label];elemStore=currLabel.elemStore;for(i=0,ii=elemStore&&elemStore.length;i<ii;i++){if(callback(elemStore[i],label,i)){break}}}}},_getDifferentialAttributes=function _getDifferentialAttributes(newAttrs,existingAttrs,existingCss){if(existingCss===void 0){existingCss={}}var derivedAttrs,currAttr,existingAttr,attr;for(attr in newAttrs){currAttr=newAttrs[attr];existingAttr=(0,_lib.pluck)(existingAttrs[attr],existingCss[attr]);if(existingAttr!==_lib.UNDEF){if(currAttr instanceof Array){if(attr===\"text-bound\"){derivedAttrs||(derivedAttrs={});derivedAttrs[attr]=currAttr;derivedAttrs.x=newAttrs.x;derivedAttrs.y=newAttrs.y}else if(currAttr.toString().replace(/,/g,\"\")!==existingAttr.toString().replace(/,/g,\"\")){derivedAttrs||(derivedAttrs={});derivedAttrs[attr]=currAttr}}else if(typeof currAttr===\"string\"){if(currAttr.replace(/,/g,\"\")!==existingAttr.toString().replace(/,/g,\"\")){derivedAttrs||(derivedAttrs={});derivedAttrs[attr]=currAttr}}else{if(currAttr!==existingAttr){derivedAttrs||(derivedAttrs={});derivedAttrs[attr]=currAttr}}}else{derivedAttrs||(derivedAttrs={});derivedAttrs[attr]=currAttr}}return derivedAttrs};var SmartRenderer=function(_ComponentBase){(0,_inheritsLoose2.default)(SmartRenderer,_ComponentBase);function SmartRenderer(id){var _this;_this=_ComponentBase.call(this,id)||this;var smartRenderer=(0,_assertThisInitialized2.default)(_this);smartRenderer._version=2;smartRenderer._id=id;smartRenderer._componentStore={};smartRenderer._oldComponentStore=[];smartRenderer.fireEvent(\"instantiated\");smartRenderer.__setDefaultConfig();return _this}var _proto=SmartRenderer.prototype;_proto.isDrawingRequired=function isDrawingRequired(){return this};_proto.syncDraw=function syncDraw(){var component=this,isRemoved=component.getState(\"removed\");if(component.isDrawingRequired()||isRemoved){component.fireEvent(\"predraw\");component.removeJob(\"draw\");component._resetGraphicalStore();isRemoved?component.addJob(\"dispose-component\",(function(){return component._dispose()}),_schedular.priorityList.postRender):component.draw&&component.draw();component.childrenSyncDraw();component._removeUnusedGraphics();component.fireEvent(\"drawn\")}};_proto._remove=function _remove(){var component=this,childComponents;component.onRemove&&component.onRemove();component.setState(\"removed\",true);childComponents=component.getChildren();if(childComponents){component._mapChildren((function(child){child.onRemove&&child.onRemove();child&&child.setState(\"removed\",true)}),true)}};_proto.setDimension=function setDimension(width,height){this.config.width=width;this.config.height=height};_proto.setTranslation=function setTranslation(x,y){var config=this.config;config._translateX=x;config._translateY=y;config.translate=\"t\"+x+\",\"+y};_proto.getTranslation=function getTranslation(){return{x:this.config._translateX,y:this.config._translateY}};_proto._resetGraphicalStore=function _resetGraphicalStore(){var smartRenderer=this;smartRenderer._oldGraphicalStore=smartRenderer._graphicalStore;smartRenderer._graphicalStore={}};_proto._getLastUsedElem=function _getLastUsedElem(){return this.config.lastElemUsed};_proto.addGraphicalElement=function addGraphicalElement(inputConfiguration,skipEvents){if(inputConfiguration===void 0){inputConfiguration={}}if(skipEvents===void 0){skipEvents=false}var smartRenderer=this,label=inputConfiguration.label,store=smartRenderer._graphicalStore[label]||(smartRenderer._graphicalStore[label]={elemStore:[],idMap:{},indexMap:{},lastIndexUsed:-1}),source,updatedCss,containerConfig,newElem=true,oldStore=smartRenderer._oldGraphicalStore&&smartRenderer._oldGraphicalStore[label],newIndex=store.lastIndexUsed+=1,oldIndex,elem,updatedAttributes=inputConfiguration.attr,id=inputConfiguration.id;if(oldStore){if(id&&oldStore.idMap[id]!==_lib.UNDEF){oldIndex=oldStore.idMap[id];elem=oldStore.elemStore[oldIndex];delete oldStore.elemStore[oldIndex];delete oldStore.indexMap[oldIndex];delete oldStore.idMap[id]}else if(oldStore.elemStore[newIndex]){if(!oldStore.indexMap[newIndex]){elem=oldStore.elemStore[newIndex];delete oldStore.elemStore[newIndex]}}}if(inputConfiguration.el===\"text\"&&inputConfiguration.css){(0,_lib.removeHtmlAttrs)(inputConfiguration.css)}if(elem){inputConfiguration.el=elem;newElem=false;if(updatedAttributes=_getDifferentialAttributes(inputConfiguration.attr,elem.attrs)){inputConfiguration.attr=updatedAttributes}if(inputConfiguration.css&&(updatedCss=_getDifferentialAttributes(inputConfiguration.css,elem.attrs,elem.styles))){inputConfiguration.css=updatedCss}}if(containerConfig=inputConfiguration.container){source=containerConfig.isParent?smartRenderer.getLinkedParent():smartRenderer;inputConfiguration.container=source.getGraphicalElement(containerConfig.id,containerConfig.label)||source.getChildContainer(containerConfig.id)}else{inputConfiguration.container=smartRenderer.getFromEnv(\"chart-container\")}(updatedAttributes||updatedCss)&&(elem=smartRenderer.getFromEnv(\"animationManager\").setAnimation(inputConfiguration));store.elemStore[newIndex]=elem;if(id){if(store.idMap[id]){delete store.indexMap[store.idMap[id]];delete store.idMap[id]}store.idMap[id]=newIndex;store.indexMap[newIndex]=id}smartRenderer.fireEvent(\"graphicalelementattached\",{element:elem});elem._skipEvents=skipEvents;inputConfiguration.shadow&&elem.shadow(inputConfiguration.shadow);inputConfiguration.outlineText!==_lib.UNDEF&&elem.outlineText(inputConfiguration.outlineText,(0,_lib.convertColor)((0,_lib.pluck)(inputConfiguration.css.fill,inputConfiguration.attr.fill)));inputConfiguration.tooltext!==_lib.UNDEF&&smartRenderer.getFromEnv(\"toolTipController\").enableToolTip(elem,inputConfiguration.tooltext);smartRenderer.config.lastElemUsed=elem;!skipEvents&&newElem&&(0,_componentBase.addAllEventsOnGraphic)(elem,smartRenderer._middleListeners,smartRenderer)};_proto.removeGraphicalElement=function removeGraphicalElement(info,label){var smartRenderer=this,graphics=smartRenderer._graphicalStore,currLabelGraphics,element,found;if(typeof info===\"object\"){_mapSubFnBackward(graphics,(function(child,currLabel,i){if(info===child){found=true;smartRenderer._setRemoveAnim(child,currLabel);currLabelGraphics=graphics[currLabel];currLabelGraphics.elemStore.splice(i,1);delete currLabelGraphics.idMap[currLabelGraphics.indexMap[i]];delete currLabelGraphics.indexMap[i];return true}}))}else{_mapSubFnBackward(graphics,(function(child,currentLabel,i){currLabelGraphics=graphics[currentLabel];if(currLabelGraphics.indexMap[i]===info&&(label?label===currentLabel:true)){found=true;smartRenderer._setRemoveAnim(child,currentLabel);currLabelGraphics.elemStore.splice(i,1);delete currLabelGraphics.idMap[currLabelGraphics.indexMap[i]];delete currLabelGraphics.indexMap[i];return true}}))}if(found){this.fireEvent(\"graphicalelementremoved\",{element:element})}};_proto.getChildContainer=function getChildContainer(name){return this.getGraphicalElement(_lib.UNDEF,name)};_proto._removeUnusedGraphics=function _removeUnusedGraphics(){var smartRenderer=this,graphics=smartRenderer._oldGraphicalStore,currLabelGraphics;_mapSubFnBackward(graphics,(function(child,currLabel,i){if(child){smartRenderer._setRemoveAnim(child,currLabel);currLabelGraphics=graphics[currLabel];delete currLabelGraphics.idMap[currLabelGraphics.indexMap[i]];delete currLabelGraphics.indexMap[i]}}))};_proto.getGraphicalElement=function getGraphicalElement(id,label){var currLabel,currLabelGraphics,elem,i,graphics=this._graphicalStore;if(!label&&!id){return graphics}if(!label){_mapSubFnForward(graphics,(function(){i=arguments[2];currLabelGraphics=graphics[arguments[1]];if(currLabelGraphics.idMap[i]===id){elem=currLabelGraphics.elemStore[i];return true}}));return elem}currLabel=graphics[label];if(!id){return currLabel&&currLabel.elemStore&&currLabel.elemStore[0]}return currLabel&&currLabel.elemStore&&currLabel.elemStore[currLabel.idMap[id]]};_proto.addEventListener=function addEventListener(eventType,callback,options){var superOutput=_ComponentBase.prototype.addEventListener.call(this,eventType,callback,options);if(superOutput===true){addEventOnAllGraphics(this,eventType,this._middleListeners[eventType]);return callback}else if(superOutput){return callback}return false};_proto.removeEventListener=function removeEventListener(eventType,callback){if(_ComponentBase.prototype.removeEventListener.call(this,eventType,callback)){removeEventFromAllGraphics(this,eventType,this._middleListeners[eventType])}};_proto._dispose=function _dispose(){var component=this,itemName,i,eventType,listenersArr;if(component&&component!==window&&component._disposing!==true){component._disposing=true;component.fireEvent(\"beforeremove\");if(component._extListeners){for(eventType in component._extListeners){listenersArr=component._extListeners[eventType];for(i=listenersArr.length-1;i>=0;i--){if(listenersArr[i].component&&listenersArr[i].component.addEventListener){listenersArr[i].component.removeEventListener(eventType,listenersArr[i].fn)}}}}component.removeAllJobs();if(component._linkedParent&&component._linkedParent.getComponentVersion()===1){component._linkedParent._detachChild(component)}if(component.getFromEnv(\"paper\")&&!component.getFromEnv(\"paper\").removed){_mapSubFnForward(component.getGraphicalElement(),component.__instantRemoveFn)}for(itemName in component){if(component.hasOwnProperty(itemName)){delete component[itemName]}}component.fireEvent(\"removed\")}};_proto.configure=function configure(dataObj){this._resetComponentStore();_ComponentBase.prototype.configure.call(this,dataObj)};_proto._resetComponentStore=function _resetComponentStore(){var smartRenderer=this;smartRenderer._oldComponentStore.push(smartRenderer._componentStore);smartRenderer._componentStore={}};_proto._mapChildren=function _mapChildren(callback,backWord){if(backWord){_mapSubFnBackward(this.getChildren(),callback)}else{_mapSubFnForward(this.getChildren(),callback)}};_proto.attachChild=function attachChild(Component,componentType,id){var smartRenderer=this,store=smartRenderer._componentStore[componentType]||(smartRenderer._componentStore[componentType]={elemStore:[],idMap:{},indexMap:{},lastIndexUsed:-1}),oldStore=smartRenderer._oldComponentStore&&smartRenderer._oldComponentStore.length&&smartRenderer._oldComponentStore[smartRenderer._oldComponentStore.length-1][componentType],newIndex=store.lastIndexUsed+=1,oldIndex,comp;if(oldStore){var oldStoreElems=oldStore.elemStore,oldIndexedElem=oldStoreElems[newIndex];if(id&&oldStore.idMap[id]!==_lib.UNDEF){oldIndex=oldStore.idMap[id];comp=oldStoreElems[oldIndex];delete oldStoreElems[oldIndex];delete oldStore.indexMap[oldIndex];delete oldStore.idMap[id]}else if(oldIndexedElem&&oldIndexedElem.constructor===Component){if(!oldStore.indexMap[newIndex]){comp=oldIndexedElem;delete oldStoreElems[newIndex]}}}if(!comp){comp=new Component(id)}store.elemStore[newIndex]=comp;if(id){store.idMap[id]=newIndex;store.indexMap[newIndex]=id}comp._setLinkedParent(smartRenderer);return comp};_proto.childrenSyncDraw=function childrenSyncDraw(){var component=this;component._mapChildren((function(child){child&&child.draw&&child.syncDraw()}));component._removeUnusedChildren()};_proto._removeUnusedChildren=function _removeUnusedChildren(){var smartRenderer=this,oldStore=smartRenderer._oldComponentStore,l=oldStore.length,i=0,iteratorFn=function iteratorFn(child){if(child){child._remove();child.syncDraw();child._setLinkedParent(_lib.UNDEF)}};for(;i<l;i+=1){_mapSubFnBackward(oldStore[i],iteratorFn)}smartRenderer._oldComponentStore.length=0};_proto.getChild=function getChild(id,componentType){var returnChild;this._searchChildren(id,(function(foundChild){returnChild=foundChild}),componentType);return returnChild};_proto._searchChildren=function _searchChildren(id,cb,_componentType){var componentStore=this._componentStore,foundAt,indexMap,foundComp,componentType=_componentType;if(id){_mapSubFnBackward(componentStore,(function(child,currentComponentType,i){indexMap=componentStore[currentComponentType].indexMap;if(indexMap[i]===id&&(componentType?componentType===currentComponentType:true)){foundComp=child;foundAt=i;componentType=currentComponentType;return true}}))}else{foundComp=componentStore[componentType]&&componentStore[componentType].elemStore}if(foundComp){return cb(foundComp,foundAt,componentType)}};_proto.getChildren=function getChildren(componentType){return componentType?this._componentStore[componentType]&&this._componentStore[componentType].elemStore:this._componentStore};_proto._detachChild=function _detachChild(){return this};return SmartRenderer}(_componentBase.default);var _default=SmartRenderer;exports.default=_default;"]},"metadata":{},"sourceType":"script"}