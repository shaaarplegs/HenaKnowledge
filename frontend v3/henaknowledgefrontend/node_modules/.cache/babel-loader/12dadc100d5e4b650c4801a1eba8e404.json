{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _inputBase = _interopRequireDefault(require(\"./input-base\"));\n\nvar _lib = require(\"@fusioncharts/core/src/lib\");\n\nvar CHART_DRAW_TIMEOUT = 250;\n\nvar correctZoomRatio = function correctZoomRatio(val) {\n  if (val < 0) {\n    return -val;\n  }\n\n  return val;\n},\n    getZoomRange = function getZoomRange(axis, center, zoomTimes, isY, zoomLimit) {\n  var visibleRange = axis.getVisibleConfig(),\n      val = axis.getValue(center[isY ? \"y\" : \"x\"] + axis.getTranslation()),\n      left = val - visibleRange.minValue,\n      right = visibleRange.maxValue - val,\n      range = axis.config.axisRange;\n  return {\n    min: Math.round(Math.max(range.min, val - left / zoomTimes) * zoomLimit) / zoomLimit,\n    max: Math.round(Math.min(range.max, val + right / zoomTimes) * zoomLimit) / zoomLimit\n  };\n};\n\nvar InputPinchZoom = function (_Base) {\n  (0, _inheritsLoose2.default)(InputPinchZoom, _Base);\n\n  function InputPinchZoom() {\n    var _this;\n\n    _this = _Base.call(this) || this;\n    var input = (0, _assertThisInitialized2.default)(_this);\n    input.controlArr = [{\n      nativeInteraction: [\"fc-pinchstart\"],\n      callback: input.pinchstart.bind(input),\n      component: input\n    }, {\n      nativeInteraction: [\"fc-pinchmove\"],\n      callback: input.pinchmove.bind(input),\n      component: input\n    }];\n    return _this;\n  }\n\n  var _proto = InputPinchZoom.prototype;\n\n  _proto.getName = function getName() {\n    return \"pinchZoom\";\n  };\n\n  _proto.configure = function configure() {\n    _Base.prototype.configure.call(this);\n\n    this.enable();\n  };\n\n  _proto.getCenter = function getCenter(touch1, touch2) {\n    var chart = this.getFromEnv(\"chart\"),\n        coord = (0, _lib.getMouseCoordinate)(chart.getLinkedItem(\"container\"), {\n      pageX: (touch1.pageX + touch2.pageX) / 2,\n      pageY: (touch1.pageY + touch2.pageY) / 2\n    }, chart);\n    return {\n      x: coord.chartX,\n      y: coord.chartY\n    };\n  };\n\n  _proto.pinchmove = function pinchmove(e) {\n    var input = this,\n        data = e.originalEvent.data,\n        distanceX = data.distanceX,\n        distanceY = data.distanceY,\n        config = input.config,\n        touchConfig = config.touchConfig,\n        zoomRatioX,\n        zoomRatioY,\n        events = {},\n        zoomed = false,\n        axisZoomed,\n        startX,\n        endX,\n        eventArgs = {},\n        startY,\n        endY,\n        chart = input.getFromEnv(\"chart\"),\n        axesObArr = input.getFromEnv(\"axesObArr\"),\n        level,\n        zoomLimit = Math.pow(10, config.zoomDecimalLimit) || 1,\n        container = chart.getChildContainer().plotGroup;\n    zoomRatioX = correctZoomRatio(distanceX / touchConfig.distanceX);\n    zoomRatioY = correctZoomRatio(distanceY / touchConfig.distanceY);\n    axesObArr.forEach(function () {\n      container.transform(\"\");\n      container.scale(zoomRatioX, zoomRatioY, touchConfig.center.x, touchConfig.center.y);\n    });\n    clearTimeout(config.chartDraw);\n    config.chartDraw = setTimeout(function () {\n      container.transform(\"\");\n      axesObArr.forEach(function (axisOb) {\n        var axis = axisOb.axis,\n            zoomRange = getZoomRange(axis, touchConfig.center, axisOb.isY ? zoomRatioY : zoomRatioX, axisOb.isY, zoomLimit),\n            min = zoomRange.min,\n            max = zoomRange.max,\n            stack = axisOb.stack,\n            visibleConfig = axis.getVisibleConfig(),\n            axisLimits = axis.getLimit(),\n            stackLength = stack.length - 1,\n            lastState = stack[stackLength],\n            isNoZoom = Math.floor(min) === axisLimits.min && Math.ceil(max) === axisLimits.max,\n            isMaxZoomed = axis.getZoom() >= zoomLimit;\n\n        if (lastState) {\n          if (isNoZoom) {\n            axisOb.stack = [];\n            events.zoomout = true;\n          } else if (lastState.minValue > min && lastState.maxValue < max) {\n            while (lastState && lastState.minValue > min && lastState.maxValue < max) {\n              stack.pop();\n              lastState = stack[--stackLength];\n            }\n\n            events.zoomout = true;\n          } else {\n            if (!isMaxZoomed) {\n              stack.push(visibleConfig);\n              events.zoomin = true;\n            }\n          }\n        } else if (!isNoZoom) {\n          if (!isMaxZoomed) {\n            stack.push(visibleConfig);\n            events.zoomin = true;\n          }\n        }\n\n        if (axisOb.isY) {\n          startY = min;\n          endY = max;\n        } else {\n          startX = min;\n          endX = max;\n          eventArgs = input.constructor._getZoomInfo(startX, endX, axis);\n        }\n\n        level = axisOb.stack.length + 1;\n        axisZoomed = axis.setVisibleConfig(min, max);\n        zoomed = zoomed || axisZoomed;\n      });\n\n      if (zoomed) {\n        events.zoomout && input._raiseZoomEvents(\"zoomout\", \"zoomedout\", Object.assign(eventArgs, {\n          level: level,\n          startX: startX,\n          endX: endX,\n          startY: startY,\n          endY: endY\n        }));\n        events.zoomin && input._raiseZoomEvents(\"zoomin\", \"zoomedin\", Object.assign(eventArgs, {\n          level: level,\n          startX: startX,\n          endX: endX,\n          startY: startY,\n          endY: endY\n        }));\n      }\n\n      config.chartDraw = null;\n    }, CHART_DRAW_TIMEOUT);\n  };\n\n  _proto.pinchstart = function pinchstart(e) {\n    var input = this,\n        axis,\n        data = e.originalEvent.data,\n        touchConfig = data;\n    this.getFromEnv(\"animationManager\").setAnimationState(\"touch\");\n    touchConfig.center = input.getCenter(data.finger0, data.finger1);\n    input.config.touchConfig = data;\n    input.getFromEnv(\"axesObArr\").forEach(function (axisOb) {\n      axis = axisOb.axis;\n      axisOb.visibleConfig = axis.getVisibleConfig();\n      axisOb.centerVal = axis.getValue(axisOb.isY ? touchConfig.center.y : touchConfig.center.x);\n    });\n  };\n\n  _proto.setControl = function setControl() {\n    var input = this,\n        manager = input.getLinkedParent(),\n        controlArr = input.controlArr;\n    manager.releaseControl(controlArr);\n\n    if (input.isEnabled()) {\n      manager.getControl(controlArr);\n    }\n  };\n\n  return InputPinchZoom;\n}(_inputBase.default);\n\nvar _default = InputPinchZoom;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/moham/OneDrive/Desktop/04_06_2021/henaknowledge/frontend v3/henaknowledgefrontend/node_modules/@fusioncharts/features/src/input-ext/input-pinch-zoom.js"],"names":["_interopRequireDefault","require","exports","__esModule","default","_assertThisInitialized2","_inheritsLoose2","_inputBase","_lib","CHART_DRAW_TIMEOUT","correctZoomRatio","val","getZoomRange","axis","center","zoomTimes","isY","zoomLimit","visibleRange","getVisibleConfig","getValue","getTranslation","left","minValue","right","maxValue","range","config","axisRange","min","Math","round","max","InputPinchZoom","_Base","_this","call","input","controlArr","nativeInteraction","callback","pinchstart","bind","component","pinchmove","_proto","prototype","getName","configure","enable","getCenter","touch1","touch2","chart","getFromEnv","coord","getMouseCoordinate","getLinkedItem","pageX","pageY","x","chartX","y","chartY","e","data","originalEvent","distanceX","distanceY","touchConfig","zoomRatioX","zoomRatioY","events","zoomed","axisZoomed","startX","endX","eventArgs","startY","endY","axesObArr","level","pow","zoomDecimalLimit","container","getChildContainer","plotGroup","forEach","transform","scale","clearTimeout","chartDraw","setTimeout","axisOb","zoomRange","stack","visibleConfig","axisLimits","getLimit","stackLength","length","lastState","isNoZoom","floor","ceil","isMaxZoomed","getZoom","zoomout","pop","push","zoomin","constructor","_getZoomInfo","setVisibleConfig","_raiseZoomEvents","Object","assign","setAnimationState","finger0","finger1","centerVal","setControl","manager","getLinkedParent","releaseControl","isEnabled","getControl","_default"],"mappings":"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","sourcesContent":["\"use strict\";var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.default=void 0;var _assertThisInitialized2=_interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));var _inheritsLoose2=_interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));var _inputBase=_interopRequireDefault(require(\"./input-base\"));var _lib=require(\"@fusioncharts/core/src/lib\");var CHART_DRAW_TIMEOUT=250;var correctZoomRatio=function correctZoomRatio(val){if(val<0){return-val}return val},getZoomRange=function getZoomRange(axis,center,zoomTimes,isY,zoomLimit){var visibleRange=axis.getVisibleConfig(),val=axis.getValue(center[isY?\"y\":\"x\"]+axis.getTranslation()),left=val-visibleRange.minValue,right=visibleRange.maxValue-val,range=axis.config.axisRange;return{min:Math.round(Math.max(range.min,val-left/zoomTimes)*zoomLimit)/zoomLimit,max:Math.round(Math.min(range.max,val+right/zoomTimes)*zoomLimit)/zoomLimit}};var InputPinchZoom=function(_Base){(0,_inheritsLoose2.default)(InputPinchZoom,_Base);function InputPinchZoom(){var _this;_this=_Base.call(this)||this;var input=(0,_assertThisInitialized2.default)(_this);input.controlArr=[{nativeInteraction:[\"fc-pinchstart\"],callback:input.pinchstart.bind(input),component:input},{nativeInteraction:[\"fc-pinchmove\"],callback:input.pinchmove.bind(input),component:input}];return _this}var _proto=InputPinchZoom.prototype;_proto.getName=function getName(){return\"pinchZoom\"};_proto.configure=function configure(){_Base.prototype.configure.call(this);this.enable()};_proto.getCenter=function getCenter(touch1,touch2){var chart=this.getFromEnv(\"chart\"),coord=(0,_lib.getMouseCoordinate)(chart.getLinkedItem(\"container\"),{pageX:(touch1.pageX+touch2.pageX)/2,pageY:(touch1.pageY+touch2.pageY)/2},chart);return{x:coord.chartX,y:coord.chartY}};_proto.pinchmove=function pinchmove(e){var input=this,data=e.originalEvent.data,distanceX=data.distanceX,distanceY=data.distanceY,config=input.config,touchConfig=config.touchConfig,zoomRatioX,zoomRatioY,events={},zoomed=false,axisZoomed,startX,endX,eventArgs={},startY,endY,chart=input.getFromEnv(\"chart\"),axesObArr=input.getFromEnv(\"axesObArr\"),level,zoomLimit=Math.pow(10,config.zoomDecimalLimit)||1,container=chart.getChildContainer().plotGroup;zoomRatioX=correctZoomRatio(distanceX/touchConfig.distanceX);zoomRatioY=correctZoomRatio(distanceY/touchConfig.distanceY);axesObArr.forEach((function(){container.transform(\"\");container.scale(zoomRatioX,zoomRatioY,touchConfig.center.x,touchConfig.center.y)}));clearTimeout(config.chartDraw);config.chartDraw=setTimeout((function(){container.transform(\"\");axesObArr.forEach((function(axisOb){var axis=axisOb.axis,zoomRange=getZoomRange(axis,touchConfig.center,axisOb.isY?zoomRatioY:zoomRatioX,axisOb.isY,zoomLimit),min=zoomRange.min,max=zoomRange.max,stack=axisOb.stack,visibleConfig=axis.getVisibleConfig(),axisLimits=axis.getLimit(),stackLength=stack.length-1,lastState=stack[stackLength],isNoZoom=Math.floor(min)===axisLimits.min&&Math.ceil(max)===axisLimits.max,isMaxZoomed=axis.getZoom()>=zoomLimit;if(lastState){if(isNoZoom){axisOb.stack=[];events.zoomout=true}else if(lastState.minValue>min&&lastState.maxValue<max){while(lastState&&lastState.minValue>min&&lastState.maxValue<max){stack.pop();lastState=stack[--stackLength]}events.zoomout=true}else{if(!isMaxZoomed){stack.push(visibleConfig);events.zoomin=true}}}else if(!isNoZoom){if(!isMaxZoomed){stack.push(visibleConfig);events.zoomin=true}}if(axisOb.isY){startY=min;endY=max}else{startX=min;endX=max;eventArgs=input.constructor._getZoomInfo(startX,endX,axis)}level=axisOb.stack.length+1;axisZoomed=axis.setVisibleConfig(min,max);zoomed=zoomed||axisZoomed}));if(zoomed){events.zoomout&&input._raiseZoomEvents(\"zoomout\",\"zoomedout\",Object.assign(eventArgs,{level:level,startX:startX,endX:endX,startY:startY,endY:endY}));events.zoomin&&input._raiseZoomEvents(\"zoomin\",\"zoomedin\",Object.assign(eventArgs,{level:level,startX:startX,endX:endX,startY:startY,endY:endY}))}config.chartDraw=null}),CHART_DRAW_TIMEOUT)};_proto.pinchstart=function pinchstart(e){var input=this,axis,data=e.originalEvent.data,touchConfig=data;this.getFromEnv(\"animationManager\").setAnimationState(\"touch\");touchConfig.center=input.getCenter(data.finger0,data.finger1);input.config.touchConfig=data;input.getFromEnv(\"axesObArr\").forEach((function(axisOb){axis=axisOb.axis;axisOb.visibleConfig=axis.getVisibleConfig();axisOb.centerVal=axis.getValue(axisOb.isY?touchConfig.center.y:touchConfig.center.x)}))};_proto.setControl=function setControl(){var input=this,manager=input.getLinkedParent(),controlArr=input.controlArr;manager.releaseControl(controlArr);if(input.isEnabled()){manager.getControl(controlArr)}};return InputPinchZoom}(_inputBase.default);var _default=InputPinchZoom;exports.default=_default;"]},"metadata":{},"sourceType":"script"}