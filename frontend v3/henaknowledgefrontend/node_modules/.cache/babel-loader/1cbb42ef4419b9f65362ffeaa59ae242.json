{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _index = require(\"@fusioncharts/core/src/component-interface/index.js\");\n\nvar _index2 = require(\"@fusioncharts/core/src/dependency-manager/index.js\");\n\nvar _lib = require(\"@fusioncharts/core/src/lib\");\n\nvar _arrayHasContent = _interopRequireDefault(require(\"@fusioncharts/utils/src/type/array-has-content.js\"));\n\nvar _exportUtils = require(\"../utils/export-utils.js\");\n\nvar _jpegToPdf = require(\"../utils/jpeg-to-pdf.js\");\n\nvar _libSvgToCanvas = require(\"../utils/lib-svg-to-canvas.js\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar copyExportOptions = function copyExportOptions(object) {\n  var newObject = {},\n      key;\n\n  for (key in object) {\n    newObject[key.toLowerCase()] = object[key];\n  }\n\n  return newObject;\n},\n    DEFAULT_BG_COLOR = \"#FFFFFF\";\n\nvar isObject = function isObject(obj) {\n  return typeof obj === \"object\";\n},\n    getBackgroundColor = function getBackgroundColor(chartInstance) {\n  if (chartInstance.jsVars.transparent || (0, _lib.pluckNumber)(chartInstance.options.containerBackgroundOpacity, 1) === 0) {\n    return _lib.BLANKSTRING;\n  }\n\n  return chartInstance.options.containerBackgroundColor || DEFAULT_BG_COLOR;\n},\n    getBackgroundAlpha = function getBackgroundAlpha(chartInstance) {\n  if (chartInstance.jsVars.transparent) {\n    return 0;\n  }\n\n  return (0, _lib.pluckNumber)(chartInstance.options.containerBackgroundOpacity, 1) + \"\";\n},\n    IMAGEDATA = \"IMAGE-DATA\",\n    xAttrRegx = /\\s\\bx\\b=['\"][^'\"]+?['\"]/gi,\n    yAttrRegx = /\\s\\by\\b=['\"][^'\"]+?['\"]/gi,\n    win = window,\n    doc = win.document,\n    DEFAULT_EXPORT_URL = win.location.protocol === \"https:\" ? \"https://export.api3.fusioncharts.com/\" : \"http://export.api3.fusioncharts.com/\",\n    DEFAULT_LOG_URL = win.location.protocol === \"https:\" ? \"https://export.api3.fusioncharts.com/api/v1.0/logs\" : \"http://export.api3.fusioncharts.com/api/v1.0/logs\",\n    isIOS = win.navigator.userAgent.match(/(iPad|iPhone|iPod)/g);\n\nvar ExportModule = function (_ComponentInterface) {\n  (0, _inheritsLoose2.default)(ExportModule, _ComponentInterface);\n\n  function ExportModule() {\n    var _this;\n\n    _this = _ComponentInterface.call(this) || this;\n    _this.config = {\n      exportOption: {},\n      chartConfig: {\n        caption: \"\",\n        subcaption: \"\",\n        width: \"\",\n        height: \"\"\n      }\n    };\n    return _this;\n  }\n\n  var _proto = ExportModule.prototype;\n\n  _proto.getName = function getName() {\n    return \"exportModule\";\n  };\n\n  _proto.getType = function getType() {\n    return \"extension\";\n  };\n\n  _proto.configureMenuBar = function configureMenuBar() {\n    var exporter = this,\n        toolbar = exporter.getFromEnv(\"toolbar\"),\n        isbtoaSupported = !!win.btoa,\n        exportString = \"Export As \",\n        chartObj = exporter.getFromEnv(\"chart\"),\n        exportFormats = exporter.getFromEnv(\"chart-attrib\").exportformats,\n        hamBurger = toolbar.getChild(\"hamburgerMenu-\" + toolbar.getId() + \"-\" + chartObj.getId() + \"-0\"),\n        exportTypes,\n        exportParam,\n        type,\n        excelexport = (0, _index2.getDep)(\"Excelexport\"),\n        i,\n        length,\n        fn,\n        exportMap = {\n      PNG: exportString + _exportUtils.EXPORTFORMAT.PNG.toUpperCase(),\n      JPG: exportString + _exportUtils.EXPORTFORMAT.JPG.toUpperCase(),\n      PDF: exportString + _exportUtils.EXPORTFORMAT.PDF.toUpperCase(),\n      SVG: exportString + _exportUtils.EXPORTFORMAT.SVG.toUpperCase(),\n      CSV: exportString + _exportUtils.EXPORTFORMAT.CSV.toUpperCase(),\n      XLSX: exportString + _exportUtils.EXPORTFORMAT.XLSX.toUpperCase()\n    },\n        exportOptionObj,\n        list = [],\n        usrExportType,\n        iscustomExportFormatsOverwritesXlsx;\n\n    if (exporter.config.exportOption.exportenabled) {\n      fn = function fn(exportTypeName) {\n        return function () {\n          exporter.config.exportOption.exportformat = exportTypeName;\n          exporter.exportChart({});\n        };\n      };\n\n      if (exportFormats) {\n        exportTypes = exportFormats.split(\"|\");\n\n        for (i = 0, length = exportTypes.length; i < length; i++) {\n          exportParam = exportTypes[i].split(\"=\");\n          type = (0, _lib.trimString)(exportParam[0].toUpperCase());\n\n          if (type.toLowerCase() === _exportUtils.EXPORTFORMAT.XLSX) {\n            iscustomExportFormatsOverwritesXlsx = true;\n          }\n\n          exportMap[type] && (exportMap[type] = exportParam[1] || exportMap[type]);\n          exportMap[type] && (usrExportType || (usrExportType = {})) && (usrExportType[type] = true);\n        }\n      }\n\n      exporter.config.exportOption.exportformats = _objectSpread({}, exportMap);\n\n      for (type in exportMap) {\n        if (type === \"XLSX\" && (!isbtoaSupported || !excelexport || excelexport && excelexport.then) || usrExportType && !usrExportType[type]) {\n          continue;\n        }\n\n        if (type === \"CSV\" && !isbtoaSupported) {\n          continue;\n        }\n\n        exportOptionObj = {\n          name: exportMap[type],\n          handler: fn(type),\n          action: \"click\"\n        };\n        list.push(exportOptionObj);\n      }\n\n      hamBurger.appendInMenu(list);\n\n      if (isbtoaSupported && excelexport && excelexport.then) {\n        excelexport.then(function () {\n          if (!exportFormats || iscustomExportFormatsOverwritesXlsx) {\n            hamBurger.appendInMenu([{\n              name: exportMap.XLSX,\n              handler: fn(\"XLSX\"),\n              action: \"click\"\n            }]);\n            hamBurger.asyncDraw();\n          }\n        });\n      }\n    }\n  };\n\n  _proto.configure = function configure(options) {\n    var chartInstance = this.getFromEnv(\"chartInstance\"),\n        exportConfig = this.config,\n        exportChartConfig = exportConfig.chartConfig,\n        exportOption = exportConfig.exportOption,\n        config = options.chartConfig;\n    config.caption && (exportChartConfig.caption = (0, _lib.pluck)(config.caption, \"\"));\n    config.subcaption && (exportChartConfig.subcaption = (0, _lib.pluck)(config.subcaption, \"\"));\n    exportOption.exportenabled = (0, _lib.pluckNumber)(config.exportenabled, 0);\n    exportOption.exportshowmenuitem = (0, _lib.pluckNumber)(config.exportshowmenuitem, 1);\n    exportOption.exportformat = (0, _lib.pluck)(config.exportformat, _exportUtils.EXPORTFORMAT.PNG);\n    exportOption.exporthandler = (0, _lib.pluck)(config.html5exporthandler, config.exporthandler, DEFAULT_EXPORT_URL);\n\n    exportOption.exportaction = function () {\n      var exportAction;\n\n      if (config.exportaction && typeof config.exportaction === \"string\") {\n        exportAction = config.exportaction.toLowerCase();\n        return [_exportUtils.EXPORTACTION.DOWNLOAD, _exportUtils.EXPORTACTION.SAVE, _exportUtils.EXPORTACTION.DOWNLOADSAVE].indexOf(exportAction) >= 0 ? exportAction : _exportUtils.EXPORTACTION.DOWNLOAD;\n      }\n\n      return _exportUtils.EXPORTACTION.DOWNLOAD;\n    }();\n\n    exportOption.exporttargetwindow = (0, _lib.pluck)(config.exporttargetwindow, isIOS ? \"_parent\" : \"_self\");\n    exportOption.exportfilename = (0, _lib.pluck)(config.exportfilename, \"FusionCharts\");\n    exportOption.exportparameters = (0, _lib.pluck)(config.exportparameters, \"\");\n    exportOption.exportcallback = (0, _lib.pluck)(config.exportcallback, \"\");\n    exportOption.exportwithimages = (0, _lib.pluckNumber)(config.exportwithimages, 1);\n\n    exportOption.exportmode = function () {\n      var exportMode;\n\n      if (typeof config.exportatclientside !== \"undefined\") {\n        exportMode = {\n          1: _exportUtils.EXPORTMODE.AUTO,\n          0: _exportUtils.EXPORTMODE.AUTO\n        }[config.exportatclientside];\n      }\n\n      exportMode = config.exportmode || exportMode || _exportUtils.EXPORTMODE.AUTO;\n      exportMode = exportMode.toLowerCase();\n      return exportMode;\n    }();\n\n    exportOption.logenabled = (0, _lib.pluckNumber)(config.logenabled, 0);\n    exportOption.loghandler = (0, _lib.pluck)(config.html5loghandler, config.loghandler, DEFAULT_LOG_URL);\n\n    exportOption.logmode = function () {\n      var logMode = config.logmode;\n\n      if (typeof logMode !== \"undefined\" && typeof logMode === \"string\" && logMode.toUpperCase() in _exportUtils.LOGMODE) {\n        return _exportUtils.LOGMODE[logMode.toUpperCase()];\n      }\n\n      return _exportUtils.LOGMODE.AUTO;\n    }();\n\n    exportOption.bgcolor = getBackgroundColor(chartInstance);\n    exportOption.bgalpha = getBackgroundAlpha(chartInstance);\n\n    if (exportOption.exportshowmenuitem) {\n      this.configureMenuBar();\n    }\n  };\n\n  _proto.exportChart = function exportChart(exportOption) {\n    var self = this,\n        chartInstance = self.getFromEnv(\"chartInstance\"),\n        chart = self.getFromEnv(\"chart\"),\n        exportOptionsLowerKeys = isObject(exportOption) && copyExportOptions(exportOption) || {},\n        optionsExport = (0, _lib.extend2)((0, _lib.extend2)({}, self.config.exportOption), exportOptionsLowerKeys),\n        exportFormat = (optionsExport.exportformat || _exportUtils.EXPORTFORMAT.PNG).toLowerCase(),\n        exportHandler = optionsExport.exporthandler,\n        exportAction = optionsExport.exportaction,\n        exportTargetWindow = optionsExport.exporttargetwindow || \"\",\n        exportFileName = optionsExport.exportfilename,\n        exportParameters = optionsExport.exportparameters,\n        exportCallback = optionsExport.exportcallback,\n        exportWithImages = optionsExport.exportwithimages,\n        exportMode = optionsExport.exportmode,\n        logEnabled = optionsExport.logenabled,\n        logHandler = optionsExport.loghandler,\n        logMode = optionsExport.logmode,\n        xlsArr,\n        csv,\n        csvUri,\n        undef,\n        fireExportDataReadyEventOnChart = function fireExportDataReadyEventOnChart(postData) {\n      chart.fireChartInstanceEvent(\"exportDataReady\", postData);\n    };\n\n    chart.fireChartInstanceEvent(\"beforeExport\", optionsExport, undef, function () {\n      var chartId = chartInstance.id,\n          chartCaption = self.config.chartConfig.caption,\n          chartSubcaption = self.config.chartConfig.subcaption,\n          paper = this.apiInstance.getFromEnv(\"paper\"),\n          useCanvas = this.apiInstance.getFromEnv(\"core-options\")[\"export\"].useCanvas,\n          postData,\n          svg,\n          svgForClientSideExport,\n          menuBar = (0, _arrayHasContent.default)(chart.getChildren(\"chartMenuBar\")) ? chart.getChildren(\"chartMenuBar\")[0] : chart.getChildren(\"actionBar\")[0],\n          hamBurger = menuBar.getChild(\"hamburgerMenu-\" + menuBar.getId() + \"-\" + chart.getId() + \"-0\"),\n          containerGroup,\n          clientSideExportedEventsParam = {\n        DOMId: chartId,\n        height: paper.height,\n        width: paper.width,\n        fileName: exportFileName + \".\" + exportFormat,\n        statusCode: undef,\n        statusMessage: undef,\n        notice: undef\n      },\n          exportOptionObject = {\n        exportAction: exportAction,\n        exportTargetWindow: exportTargetWindow,\n        exportCallback: exportCallback,\n        fusionCharts: chartInstance,\n        paper: paper,\n        chartId: chartId,\n        exportHandler: exportHandler,\n        logEnabled: logEnabled,\n        logMode: logMode,\n        logHandler: logHandler\n      },\n          createPostDataForExport = function createPostDataForExport(streamType, streamValue, configuredExportAction) {\n        var _logEnabled;\n\n        _logEnabled = !!logEnabled;\n\n        if (logMode === _exportUtils.LOGMODE.CLIENT) {\n          _logEnabled = false;\n        }\n\n        return {\n          charttype: chartInstance.chartType(),\n          stream_type: streamType || \"\",\n          stream: streamValue || \"\",\n          meta_bgColor: optionsExport.bgcolor || \"\",\n          meta_bgAlpha: optionsExport.bgalpha || \"1\",\n          meta_DOMId: chartInstance.id,\n          meta_width: paper.width || self.config.chartConfig.width,\n          meta_height: paper.height || self.config.chartConfig.height,\n          chart_caption: chartCaption,\n          chart_sub_caption: chartSubcaption,\n          is_single_export: true,\n          is_full_version: !true,\n          version: _lib.PROJECT_VERSION,\n          user_time_zone: -new Date().getTimezoneOffset(),\n          log_enabled: _logEnabled,\n          parameters: [\"exportfilename=\" + exportFileName, \"exportformat=\" + exportFormat, \"exportaction=\" + (0, _exportUtils.createExportActionOldString)(exportAction), \"exportactionnew=\" + exportAction, \"configuredexportaction=\" + (configuredExportAction || exportAction), \"exportparameters=\" + exportParameters].join(\"|\")\n        };\n      },\n          createPostDataForLog = function createPostDataForLog() {\n        return {\n          chartType: chartInstance.chartType(),\n          chartCaption: chartCaption,\n          chartSubCaption: chartSubcaption,\n          isSingleExport: true,\n          isFullVersion: !true,\n          exportAction: exportAction,\n          userTimeZone: -new Date().getTimezoneOffset(),\n          exportFileName: [exportFileName, exportFormat].join(\".\"),\n          exportFormat: exportFormat,\n          version: _lib.PROJECT_VERSION\n        };\n      },\n          noPrepareAndExportData = function noPrepareAndExportData(svgToExport) {\n        (0, _libSvgToCanvas.downloadCharts)(null, null, null, createPostDataForExport(_exportUtils.EXPORTFORMAT.SVG, svgToExport), exportOptionObject);\n      },\n          prepareAndExportData = function prepareAndExportData(svgToExportURL) {\n        var canvas,\n            exportPostData,\n            svgToExport = svgToExportURL;\n\n        if (_libSvgToCanvas.browserDetails.hasCanvas && typeof win.btoa !== \"undefined\") {\n          canvas = doc.createElement(\"canvas\");\n          canvas.width = paper.width;\n          canvas.height = paper.height;\n          svgToExport = (0, _exportUtils.embedImagesWithNonDataURL)(svgToExport);\n          svgForClientSideExport = (0, _exportUtils.replaceImagesWithNonDataUrl)(svgForClientSideExport);\n\n          if ((0, _exportUtils.hasUndownloadableImage)(svgToExport) || exportFormat === _exportUtils.EXPORTFORMAT.SVG) {\n            exportPostData = createPostDataForExport(_exportUtils.EXPORTFORMAT.SVG, svgToExport);\n            (0, _libSvgToCanvas.downloadCharts)(null, null, null, exportPostData, exportOptionObject);\n          } else {\n            (0, _libSvgToCanvas.drawSvgOnCanvas)({\n              svg: svgForClientSideExport,\n              canvas: canvas,\n              x: 0,\n              y: 0,\n              width: paper.width,\n              height: paper.height,\n              useCanvas: useCanvas\n            }, function () {\n              var dataURI;\n\n              switch (exportFormat) {\n                case _exportUtils.EXPORTFORMAT.PNG:\n                  dataURI = canvas.toDataURL(\"image/png\");\n                  break;\n\n                case _exportUtils.EXPORTFORMAT.JPEG:\n                  dataURI = canvas.toDataURL(\"image/jpeg\");\n                  break;\n\n                case _exportUtils.EXPORTFORMAT.PDF:\n                  (0, _jpegToPdf.addImage)(canvas.toDataURL(\"image/jpeg\"), paper.height, paper.width);\n                  dataURI = (0, _jpegToPdf.getDataUrl)();\n                  break;\n\n                default:\n                  dataURI = canvas.toDataURL(\"image/jpeg\");\n                  break;\n              }\n\n              exportPostData = createPostDataForExport(IMAGEDATA, dataURI);\n              (0, _libSvgToCanvas.downloadCharts)(null, null, null, exportPostData, exportOptionObject);\n            });\n          }\n        } else {\n          noPrepareAndExportData(svgToExport);\n        }\n      },\n          getImageDataUrl = function getImageDataUrl(type, callback, exportOptions) {\n        var canvas;\n        canvas = doc.createElement(\"canvas\");\n        canvas.width = paper.width;\n        canvas.height = paper.height;\n        (0, _libSvgToCanvas.drawSvgOnCanvas)({\n          svg: svgForClientSideExport,\n          canvas: canvas,\n          x: 0,\n          y: 0,\n          width: paper.width,\n          height: paper.height,\n          useCanvas: useCanvas\n        }, function () {\n          switch (type) {\n            case _exportUtils.EXPORTFORMAT.PNG:\n              callback(type, canvas.toDataURL(\"image/png\"), exportFileName, exportOptions);\n              break;\n\n            case _exportUtils.EXPORTFORMAT.JPEG:\n              callback(type, canvas.toDataURL(\"image/jpeg\"), exportFileName, exportOptions);\n              break;\n\n            case _exportUtils.EXPORTFORMAT.PDF:\n              callback(type, canvas.toDataURL(\"image/jpeg\"), exportFileName, exportOptions);\n              break;\n\n            default:\n              callback(type, canvas.toDataURL(\"image/jpeg\"), exportFileName, exportOptions);\n              break;\n          }\n        });\n      },\n          prepareClientSideDownload = function prepareClientSideDownload(exportFrmt, userImageUrl, exprtFileName, downloadOptions, mode) {\n        var imageUrl = userImageUrl;\n\n        if (exportFrmt === _exportUtils.EXPORTFORMAT.PDF) {\n          (0, _jpegToPdf.addImage)(imageUrl, paper.height, paper.width);\n          imageUrl = (0, _jpegToPdf.getDataUrl)();\n        }\n\n        if (mode === _exportUtils.EXPORTMODE.AUTO) {\n          postData = createPostDataForExport(IMAGEDATA, imageUrl);\n        } else {\n          postData = null;\n        }\n\n        (0, _libSvgToCanvas.downloadCharts)(\"url\", imageUrl, exprtFileName + \".\" + exportFrmt, postData, downloadOptions);\n      },\n          saveAfterProcessingAtClientSide = function saveAfterProcessingAtClientSide(svgToExport, exportOptions, callback) {\n        var svgDataURI, callbackModified;\n\n        if (exportFormat === _exportUtils.EXPORTFORMAT.SVG) {\n          svgDataURI = (0, _exportUtils.svgStrToDataUrl)(svgToExport);\n          callback(svgDataURI, exportOptions);\n        } else {\n          callbackModified = function callbackModified() {\n            callback(arguments[1], exportOptions);\n          };\n\n          getImageDataUrl(exportFormat, callbackModified, exportOptions);\n        }\n      },\n          exportAtClientSide = function exportAtClientSide(svgToBeExported, exportOptions, mode) {\n        var svgDataURI, prepareClientSideDownloadModified;\n\n        if (exportFormat === _exportUtils.EXPORTFORMAT.SVG) {\n          svgDataURI = (0, _exportUtils.svgStrToDataUrl)(svgToBeExported);\n\n          if (mode === _exportUtils.EXPORTMODE.AUTO) {\n            postData = createPostDataForExport(IMAGEDATA, svgDataURI);\n          } else {\n            postData = null;\n          }\n\n          (0, _libSvgToCanvas.downloadCharts)(\"url\", svgDataURI, exportFileName + \".\" + exportFormat, postData, exportOptions);\n        } else {\n          prepareClientSideDownloadModified = function prepareClientSideDownloadModified() {\n            prepareClientSideDownload(arguments[0], arguments[1], arguments[2], arguments[3], mode);\n          };\n\n          getImageDataUrl(exportFormat, prepareClientSideDownloadModified, exportOptions);\n        }\n      },\n          createXlsArr = function createXlsArr() {\n        var count = 0;\n        xlsArr = [];\n        csv.replace(/[^\\r\\n]+/g, function (match) {\n          xlsArr[count] = [];\n          xlsArr[count] = match.split(/,(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/).map(function (x) {\n            return x.replace(/\"/g, _lib.BLANKSTRING);\n          });\n          count += 1;\n        });\n      },\n          raiseEventExportDataReady = fireExportDataReadyEventOnChart,\n          logSeparatelyIfLogModeCLient = function logSeparatelyIfLogModeCLient(mode) {\n        if (mode === _exportUtils.LOGMODE.CLIENT) {\n          (0, _exportUtils.logCharts)(createPostDataForLog(), exportOptionObject);\n        }\n      },\n          handleCSVandXLSXexport = function handleCSVandXLSXexport(uri, encodeStr) {\n        browserCanSelfDownload = typeof win.btoa !== \"undefined\" && (_libSvgToCanvas.browserDetails.name === \"Chrome\" || _libSvgToCanvas.browserDetails.name === \"Firefox\" || _libSvgToCanvas.browserDetails.name === \"Safari\" || _libSvgToCanvas.browserDetails.name === \"Edge\" || _libSvgToCanvas.browserDetails.name === \"ie\");\n\n        if (exportMode !== \"server\" && browserCanSelfDownload) {\n          if (exportAction === _exportUtils.EXPORTACTION.DOWNLOAD || exportAction === _exportUtils.EXPORTACTION.DOWNLOADSAVE) {\n            (0, _libSvgToCanvas.downloadCharts)(\"blob\", uri, exportFileName + \".\" + exportFormat, null, exportOptionObject);\n            chart.fireChartInstanceEvent(\"exported\", clientSideExportedEventsParam);\n          }\n\n          if (exportAction === _exportUtils.EXPORTACTION.SAVE || exportAction === _exportUtils.EXPORTACTION.DOWNLOADSAVE) {\n            configuredExportAction = exportAction;\n\n            if (exportAction === _exportUtils.EXPORTACTION.DOWNLOADSAVE) {\n              exportAction = _exportUtils.EXPORTACTION.SAVE;\n            }\n\n            postData = createPostDataForExport(IMAGEDATA, uri, configuredExportAction);\n            (0, _libSvgToCanvas.downloadCharts)(null, null, null, postData, exportOptionObject);\n            logSeparatelyIfLogModeCLient(logMode);\n          } else if (logMode !== _exportUtils.LOGMODE.SERVER) {\n            (0, _exportUtils.logCharts)(createPostDataForLog(), exportOptionObject);\n          }\n        } else {\n          var fileReader = new FileReader();\n\n          fileReader.onload = function serverSideExport(e) {\n            var tempUintArrayStr = _lib.BLANKSTRING,\n                bytes = new Uint8Array(e.target.result),\n                length = bytes.byteLength;\n\n            for (var i = 0; i < length; i++) {\n              tempUintArrayStr += String.fromCharCode(bytes[i]);\n            }\n\n            tempUintArrayStr = encodeStr + win.btoa(tempUintArrayStr);\n            (0, _libSvgToCanvas.downloadCharts)(null, null, null, createPostDataForExport(IMAGEDATA, tempUintArrayStr), exportOptionObject);\n            logSeparatelyIfLogModeCLient(logMode);\n          };\n\n          fileReader.readAsArrayBuffer(uri);\n        }\n      },\n          browserCanSelfDownload,\n          configuredExportAction,\n          exportJSONtoEXCEL,\n          dontCacheImages;\n\n      if (exportFormat === \"xlsx\") {\n        if (typeof win.btoa !== \"undefined\") {\n          csv = chartInstance.getCSVData();\n        } else {\n          chart.fireChartInstanceEvent(\"exportCancelled\", optionsExport);\n          return false;\n        }\n\n        raiseEventExportDataReady();\n        createXlsArr();\n        exportJSONtoEXCEL = (0, _index2.getDep)(\"ExcelExport\");\n        exportJSONtoEXCEL && exportJSONtoEXCEL(xlsArr).then(function (content) {\n          handleCSVandXLSXexport(content, \"data:application/vnd.ms-excel;base64,\");\n        });\n      } else if (exportFormat === \"csv\") {\n        if (typeof win.btoa !== \"undefined\") {\n          csv = chartInstance.getCSVData();\n        } else {\n          chart.fireChartInstanceEvent(\"exportCancelled\", optionsExport);\n          return false;\n        }\n\n        raiseEventExportDataReady();\n        csvUri = new Blob([csv], {\n          type: \"text/csv;base64;\"\n        });\n        handleCSVandXLSXexport(csvUri, \"data:text/csv;base64,\");\n      } else {\n        containerGroup = hamBurger.getChild(\"listContainer\").getLinkedParent().getGraphicalElement(\"button\", \"button\");\n        containerGroup && containerGroup.attr(\"visibility\", \"hidden\");\n        svg = paper.toSVG(exportWithImages);\n        svgForClientSideExport = paper.toSVG(exportWithImages && (0, _libSvgToCanvas.isCanvasElemSupported)());\n        svgForClientSideExport = svgForClientSideExport.replace(/&nbsp;/gi, \" \");\n        containerGroup && containerGroup.attr(\"visibility\", \"visible\");\n        svg = svg.replace(/(\\sd\\s*=\\s*[\"'])[M\\s\\d\\.]*([\"'])/gi, \"$1M 0 0 L 0 0$2\");\n        svg = svg.replace(/NS\\d+:/gi, \"xlink:\");\n        svg = svg.replace(/&nbsp;/gi, \" \");\n        svgForClientSideExport = svgForClientSideExport.replace(/NS\\d+:/gi, \"xlink:\");\n        svgForClientSideExport = svgForClientSideExport.replace(/(\\sd\\s*=\\s*[\"'])[M\\s\\d\\.]*([\"'])/gi, \"$1M 0 0 L 0 0$2\");\n        svgForClientSideExport = svgForClientSideExport.replace(/(xlink:title\\s*=\\s*)['\"].*?[\"']/gi, \"\");\n        svg = svg.replace(/[\\w\\-]+\\=\\\"undefined\\\"/gi, \"\");\n        svg = svg.replace(/(xlink:title\\s*=\\s*)['\"].*?[\"']/gi, \"\");\n        svg = svg.replace(/rgba\\(([^\\)]+)\\)/gi, function (RGBStr) {\n          return \"#\" + new _lib.RGBtoHex(RGBStr.split(\",\"));\n        });\n        svg = svg.replace(/<svg[^>]+/i, function (svgString) {\n          var str = svgString;\n\n          if (!str.match(/height/i) && (paper.height || self.config.chartConfig.height)) {\n            str += ' height=\"' + (paper.height || self.config.chartConfig.height) + '\"';\n          }\n\n          if (!str.match(/width/i) && (paper.width || self.config.chartConfig.width)) {\n            str += ' width=\"' + (paper.width || self.config.chartConfig.width) + '\"';\n          }\n\n          return str;\n        });\n        svg = svg.replace(/(([\\w]+\\-)?opacity\\s*=\\s*)['\"][\\d\\.]+e[\\-\\+][\\d]+[\"']/gi, '$1\"0.001\"');\n        svg = svg.replace(/(([\\w]+\\-)?opacity\\s*:\\s*)[\\d\\.]+e[\\-\\+][\\d]+/gi, \"$10.001\");\n        svg = svg.replace(/<text[^\\>]+/gi, function (text) {\n          var fullText = text;\n          fullText = fullText.replace(/stroke\\=[\\\"\\']([a-z0-9\\#]+)?[\\\"\\']/gi, \"\");\n          fullText = fullText.replace(/stroke\\s*\\:\\s*([a-z0-9\\#]+)?;?/gi, \"\");\n          fullText = fullText.replace(/stroke-width\\=[\\\"\\']([a-z0-9\\#]+)?[\\\"\\']/gi, \"\");\n          fullText = fullText.replace(/stroke-width\\s*\\:\\s*([a-z0-9\\#]+)?;?/gi, \"\");\n          fullText = fullText.replace(/stroke-opacity\\=[\\\"\\']([a-z0-9\\#]+)?[\\\"\\']/gi, \"\");\n          fullText = fullText.replace(/stroke-opacity\\s*\\:\\s*([a-z0-9\\#]+)?;?/gi, \"\");\n          fullText = fullText.replace(/(<text[^\\>]+fill\\=)([\\\"\\'][^\\\"\\']+[\\\"\\'])([^\\>]+)/gi, '$1$2 stroke=$2 stroke-width=\"0.2\"$3');\n          fullText = fullText.replace(/(<text[^\\>]+fill-opacity\\=)([\\\"\\'][^\\\"\\']+[\\\"\\'])([^\\>]+)/gi, \"$1$2 stroke-opacity=$2 $3\");\n          return fullText;\n        });\n        svg = svg.replace(/<(\\b[^<>s\\s]+\\b)[^\\>]+?opacity\\s*=\\s*['\"][^1][^\\>]+?(\\/>|>[\\s\\r\\n]*?<\\/\\1>)/gi, function (fullText, tagName) {\n          var recrXCommand = xAttrRegx.exec(fullText) || \"\",\n              recrYCommand = yAttrRegx.exec(fullText) || \"\",\n              prop;\n          prop = ' opacity=\"1\" stroke-opacity=\"1\" fill=\"#cccccc\" stroke-width=\"0\" r=\"0\" height=\"0.5\" width=\"0.5\" d=\"M 0 0 L 1 1\" />';\n          return fullText + \"<\" + tagName + recrXCommand + recrYCommand + prop;\n        });\n        svg = (0, _exportUtils.makeImageUrlsAbsolute)(svg);\n        svgForClientSideExport = (0, _exportUtils.makeImageUrlsAbsolute)(svgForClientSideExport);\n        dontCacheImages = exportMode === _exportUtils.EXPORTMODE.SERVER;\n        (0, _exportUtils.cacheAllImages)(svg, dontCacheImages, function () {\n          postData = createPostDataForExport(_exportUtils.EXPORTFORMAT.SVG, svg);\n          raiseEventExportDataReady(postData);\n          postData = null;\n          var configuredExptAction,\n              canBrowserSelfDownload = typeof win.btoa !== \"undefined\" && (_libSvgToCanvas.browserDetails.name === \"Chrome\" || _libSvgToCanvas.browserDetails.name === \"Firefox\" || _libSvgToCanvas.browserDetails.name === \"Safari\" || _libSvgToCanvas.browserDetails.name === \"Edge\" || _libSvgToCanvas.browserDetails.name === \"ie\");\n\n          if ((exportMode === _exportUtils.EXPORTMODE.CLIENT || exportMode === _exportUtils.EXPORTMODE.AUTO && !(0, _exportUtils.hasUndownloadableImage)(svg)) && canBrowserSelfDownload) {\n            svgForClientSideExport = (0, _exportUtils.replaceImagesWithNonDataUrl)(svgForClientSideExport);\n\n            if (exportAction === _exportUtils.EXPORTACTION.DOWNLOAD || exportAction === _exportUtils.EXPORTACTION.DOWNLOADSAVE) {\n              exportAtClientSide(svgForClientSideExport, exportOptionObject, exportMode);\n              chart.fireChartInstanceEvent(\"exported\", clientSideExportedEventsParam);\n            }\n\n            if (exportAction === _exportUtils.EXPORTACTION.SAVE || exportAction === _exportUtils.EXPORTACTION.DOWNLOADSAVE) {\n              configuredExptAction = exportAction;\n\n              if (exportAction === _exportUtils.EXPORTACTION.DOWNLOADSAVE) {\n                exportAction = _exportUtils.EXPORTACTION.SAVE;\n              }\n\n              saveAfterProcessingAtClientSide(svgForClientSideExport, exportOptionObject, function (dataUri, exportOptionObj) {\n                postData = createPostDataForExport(IMAGEDATA, dataUri, configuredExptAction);\n                (0, _libSvgToCanvas.downloadCharts)(null, null, null, postData, exportOptionObj);\n                logSeparatelyIfLogModeCLient(logMode);\n              });\n              chart.fireChartInstanceEvent(\"exported\", clientSideExportedEventsParam);\n            } else if (logMode !== _exportUtils.LOGMODE.SERVER) {\n              (0, _exportUtils.logCharts)(createPostDataForLog(), exportOptionObject);\n            }\n          } else if (exportMode === _exportUtils.EXPORTMODE.AUTO) {\n            prepareAndExportData(svg);\n            logSeparatelyIfLogModeCLient(logMode);\n          } else if (exportMode === _exportUtils.EXPORTMODE.SERVER) {\n            noPrepareAndExportData(svg);\n            logSeparatelyIfLogModeCLient(logMode);\n          }\n        });\n      }\n    }, function () {\n      chart.fireChartInstanceEvent(\"exportCancelled\", optionsExport);\n    });\n  };\n\n  return ExportModule;\n}(_index.ComponentInterface);\n\nexports.default = ExportModule;","map":{"version":3,"sources":["C:/Users/moham/OneDrive/Desktop/04_06_2021/henaknowledge/frontend v3/henaknowledgefrontend/node_modules/@fusioncharts/features/src/export-module/export.js"],"names":["_interopRequireDefault","require","exports","__esModule","default","_defineProperty2","_inheritsLoose2","_index","_index2","_lib","_arrayHasContent","_exportUtils","_jpegToPdf","_libSvgToCanvas","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","copyExportOptions","newObject","toLowerCase","DEFAULT_BG_COLOR","isObject","obj","getBackgroundColor","chartInstance","jsVars","transparent","pluckNumber","options","containerBackgroundOpacity","BLANKSTRING","containerBackgroundColor","getBackgroundAlpha","IMAGEDATA","xAttrRegx","yAttrRegx","win","window","doc","document","DEFAULT_EXPORT_URL","location","protocol","DEFAULT_LOG_URL","isIOS","navigator","userAgent","match","ExportModule","_ComponentInterface","_this","call","config","exportOption","chartConfig","caption","subcaption","width","height","_proto","prototype","getName","getType","configureMenuBar","exporter","toolbar","getFromEnv","isbtoaSupported","btoa","exportString","chartObj","exportFormats","exportformats","hamBurger","getChild","getId","exportTypes","exportParam","type","excelexport","getDep","fn","exportMap","PNG","EXPORTFORMAT","toUpperCase","JPG","PDF","SVG","CSV","XLSX","exportOptionObj","list","usrExportType","iscustomExportFormatsOverwritesXlsx","exportenabled","exportTypeName","exportformat","exportChart","split","trimString","then","name","handler","action","appendInMenu","asyncDraw","configure","exportConfig","exportChartConfig","pluck","exportshowmenuitem","exporthandler","html5exporthandler","exportaction","exportAction","EXPORTACTION","DOWNLOAD","SAVE","DOWNLOADSAVE","indexOf","exporttargetwindow","exportfilename","exportparameters","exportcallback","exportwithimages","exportmode","exportMode","exportatclientside","EXPORTMODE","AUTO","logenabled","loghandler","html5loghandler","logmode","logMode","LOGMODE","bgcolor","bgalpha","self","chart","exportOptionsLowerKeys","optionsExport","extend2","exportFormat","exportHandler","exportTargetWindow","exportFileName","exportParameters","exportCallback","exportWithImages","logEnabled","logHandler","xlsArr","csv","csvUri","undef","fireExportDataReadyEventOnChart","postData","fireChartInstanceEvent","chartId","id","chartCaption","chartSubcaption","paper","apiInstance","useCanvas","svg","svgForClientSideExport","menuBar","getChildren","containerGroup","clientSideExportedEventsParam","DOMId","fileName","statusCode","statusMessage","notice","exportOptionObject","fusionCharts","createPostDataForExport","streamType","streamValue","configuredExportAction","_logEnabled","CLIENT","charttype","chartType","stream_type","stream","meta_bgColor","meta_bgAlpha","meta_DOMId","meta_width","meta_height","chart_caption","chart_sub_caption","is_single_export","is_full_version","version","PROJECT_VERSION","user_time_zone","Date","getTimezoneOffset","log_enabled","parameters","createExportActionOldString","join","createPostDataForLog","chartSubCaption","isSingleExport","isFullVersion","userTimeZone","noPrepareAndExportData","svgToExport","downloadCharts","prepareAndExportData","svgToExportURL","canvas","exportPostData","browserDetails","hasCanvas","createElement","embedImagesWithNonDataURL","replaceImagesWithNonDataUrl","hasUndownloadableImage","drawSvgOnCanvas","x","y","dataURI","toDataURL","JPEG","addImage","getDataUrl","getImageDataUrl","callback","exportOptions","prepareClientSideDownload","exportFrmt","userImageUrl","exprtFileName","downloadOptions","mode","imageUrl","saveAfterProcessingAtClientSide","svgDataURI","callbackModified","svgStrToDataUrl","exportAtClientSide","svgToBeExported","prepareClientSideDownloadModified","createXlsArr","count","replace","map","raiseEventExportDataReady","logSeparatelyIfLogModeCLient","logCharts","handleCSVandXLSXexport","uri","encodeStr","browserCanSelfDownload","SERVER","fileReader","FileReader","onload","serverSideExport","e","tempUintArrayStr","bytes","Uint8Array","result","byteLength","String","fromCharCode","readAsArrayBuffer","exportJSONtoEXCEL","dontCacheImages","getCSVData","content","Blob","getLinkedParent","getGraphicalElement","attr","toSVG","isCanvasElemSupported","RGBStr","RGBtoHex","svgString","str","text","fullText","tagName","recrXCommand","exec","recrYCommand","prop","makeImageUrlsAbsolute","cacheAllImages","configuredExptAction","canBrowserSelfDownload","dataUri","ComponentInterface"],"mappings":"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","sourcesContent":["\"use strict\";var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.default=void 0;var _defineProperty2=_interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));var _inheritsLoose2=_interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));var _index=require(\"@fusioncharts/core/src/component-interface/index.js\");var _index2=require(\"@fusioncharts/core/src/dependency-manager/index.js\");var _lib=require(\"@fusioncharts/core/src/lib\");var _arrayHasContent=_interopRequireDefault(require(\"@fusioncharts/utils/src/type/array-has-content.js\"));var _exportUtils=require(\"../utils/export-utils.js\");var _jpegToPdf=require(\"../utils/jpeg-to-pdf.js\");var _libSvgToCanvas=require(\"../utils/lib-svg-to-canvas.js\");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){(0,_defineProperty2.default)(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}var copyExportOptions=function copyExportOptions(object){var newObject={},key;for(key in object){newObject[key.toLowerCase()]=object[key]}return newObject},DEFAULT_BG_COLOR=\"#FFFFFF\";var isObject=function isObject(obj){return typeof obj===\"object\"},getBackgroundColor=function getBackgroundColor(chartInstance){if(chartInstance.jsVars.transparent||(0,_lib.pluckNumber)(chartInstance.options.containerBackgroundOpacity,1)===0){return _lib.BLANKSTRING}return chartInstance.options.containerBackgroundColor||DEFAULT_BG_COLOR},getBackgroundAlpha=function getBackgroundAlpha(chartInstance){if(chartInstance.jsVars.transparent){return 0}return(0,_lib.pluckNumber)(chartInstance.options.containerBackgroundOpacity,1)+\"\"},IMAGEDATA=\"IMAGE-DATA\",xAttrRegx=/\\s\\bx\\b=['\"][^'\"]+?['\"]/gi,yAttrRegx=/\\s\\by\\b=['\"][^'\"]+?['\"]/gi,win=window,doc=win.document,DEFAULT_EXPORT_URL=win.location.protocol===\"https:\"?\"https://export.api3.fusioncharts.com/\":\"http://export.api3.fusioncharts.com/\",DEFAULT_LOG_URL=win.location.protocol===\"https:\"?\"https://export.api3.fusioncharts.com/api/v1.0/logs\":\"http://export.api3.fusioncharts.com/api/v1.0/logs\",isIOS=win.navigator.userAgent.match(/(iPad|iPhone|iPod)/g);var ExportModule=function(_ComponentInterface){(0,_inheritsLoose2.default)(ExportModule,_ComponentInterface);function ExportModule(){var _this;_this=_ComponentInterface.call(this)||this;_this.config={exportOption:{},chartConfig:{caption:\"\",subcaption:\"\",width:\"\",height:\"\"}};return _this}var _proto=ExportModule.prototype;_proto.getName=function getName(){return\"exportModule\"};_proto.getType=function getType(){return\"extension\"};_proto.configureMenuBar=function configureMenuBar(){var exporter=this,toolbar=exporter.getFromEnv(\"toolbar\"),isbtoaSupported=!!win.btoa,exportString=\"Export As \",chartObj=exporter.getFromEnv(\"chart\"),exportFormats=exporter.getFromEnv(\"chart-attrib\").exportformats,hamBurger=toolbar.getChild(\"hamburgerMenu-\"+toolbar.getId()+\"-\"+chartObj.getId()+\"-0\"),exportTypes,exportParam,type,excelexport=(0,_index2.getDep)(\"Excelexport\"),i,length,fn,exportMap={PNG:exportString+_exportUtils.EXPORTFORMAT.PNG.toUpperCase(),JPG:exportString+_exportUtils.EXPORTFORMAT.JPG.toUpperCase(),PDF:exportString+_exportUtils.EXPORTFORMAT.PDF.toUpperCase(),SVG:exportString+_exportUtils.EXPORTFORMAT.SVG.toUpperCase(),CSV:exportString+_exportUtils.EXPORTFORMAT.CSV.toUpperCase(),XLSX:exportString+_exportUtils.EXPORTFORMAT.XLSX.toUpperCase()},exportOptionObj,list=[],usrExportType,iscustomExportFormatsOverwritesXlsx;if(exporter.config.exportOption.exportenabled){fn=function fn(exportTypeName){return function(){exporter.config.exportOption.exportformat=exportTypeName;exporter.exportChart({})}};if(exportFormats){exportTypes=exportFormats.split(\"|\");for(i=0,length=exportTypes.length;i<length;i++){exportParam=exportTypes[i].split(\"=\");type=(0,_lib.trimString)(exportParam[0].toUpperCase());if(type.toLowerCase()===_exportUtils.EXPORTFORMAT.XLSX){iscustomExportFormatsOverwritesXlsx=true}exportMap[type]&&(exportMap[type]=exportParam[1]||exportMap[type]);exportMap[type]&&(usrExportType||(usrExportType={}))&&(usrExportType[type]=true)}}exporter.config.exportOption.exportformats=_objectSpread({},exportMap);for(type in exportMap){if(type===\"XLSX\"&&(!isbtoaSupported||!excelexport||excelexport&&excelexport.then)||usrExportType&&!usrExportType[type]){continue}if(type===\"CSV\"&&!isbtoaSupported){continue}exportOptionObj={name:exportMap[type],handler:fn(type),action:\"click\"};list.push(exportOptionObj)}hamBurger.appendInMenu(list);if(isbtoaSupported&&excelexport&&excelexport.then){excelexport.then((function(){if(!exportFormats||iscustomExportFormatsOverwritesXlsx){hamBurger.appendInMenu([{name:exportMap.XLSX,handler:fn(\"XLSX\"),action:\"click\"}]);hamBurger.asyncDraw()}}))}}};_proto.configure=function configure(options){var chartInstance=this.getFromEnv(\"chartInstance\"),exportConfig=this.config,exportChartConfig=exportConfig.chartConfig,exportOption=exportConfig.exportOption,config=options.chartConfig;config.caption&&(exportChartConfig.caption=(0,_lib.pluck)(config.caption,\"\"));config.subcaption&&(exportChartConfig.subcaption=(0,_lib.pluck)(config.subcaption,\"\"));exportOption.exportenabled=(0,_lib.pluckNumber)(config.exportenabled,0);exportOption.exportshowmenuitem=(0,_lib.pluckNumber)(config.exportshowmenuitem,1);exportOption.exportformat=(0,_lib.pluck)(config.exportformat,_exportUtils.EXPORTFORMAT.PNG);exportOption.exporthandler=(0,_lib.pluck)(config.html5exporthandler,config.exporthandler,DEFAULT_EXPORT_URL);exportOption.exportaction=function(){var exportAction;if(config.exportaction&&typeof config.exportaction===\"string\"){exportAction=config.exportaction.toLowerCase();return[_exportUtils.EXPORTACTION.DOWNLOAD,_exportUtils.EXPORTACTION.SAVE,_exportUtils.EXPORTACTION.DOWNLOADSAVE].indexOf(exportAction)>=0?exportAction:_exportUtils.EXPORTACTION.DOWNLOAD}return _exportUtils.EXPORTACTION.DOWNLOAD}();exportOption.exporttargetwindow=(0,_lib.pluck)(config.exporttargetwindow,isIOS?\"_parent\":\"_self\");exportOption.exportfilename=(0,_lib.pluck)(config.exportfilename,\"FusionCharts\");exportOption.exportparameters=(0,_lib.pluck)(config.exportparameters,\"\");exportOption.exportcallback=(0,_lib.pluck)(config.exportcallback,\"\");exportOption.exportwithimages=(0,_lib.pluckNumber)(config.exportwithimages,1);exportOption.exportmode=function(){var exportMode;if(typeof config.exportatclientside!==\"undefined\"){exportMode={1:_exportUtils.EXPORTMODE.AUTO,0:_exportUtils.EXPORTMODE.AUTO}[config.exportatclientside]}exportMode=config.exportmode||exportMode||_exportUtils.EXPORTMODE.AUTO;exportMode=exportMode.toLowerCase();return exportMode}();exportOption.logenabled=(0,_lib.pluckNumber)(config.logenabled,0);exportOption.loghandler=(0,_lib.pluck)(config.html5loghandler,config.loghandler,DEFAULT_LOG_URL);exportOption.logmode=function(){var logMode=config.logmode;if(typeof logMode!==\"undefined\"&&typeof logMode===\"string\"&&logMode.toUpperCase()in _exportUtils.LOGMODE){return _exportUtils.LOGMODE[logMode.toUpperCase()]}return _exportUtils.LOGMODE.AUTO}();exportOption.bgcolor=getBackgroundColor(chartInstance);exportOption.bgalpha=getBackgroundAlpha(chartInstance);if(exportOption.exportshowmenuitem){this.configureMenuBar()}};_proto.exportChart=function exportChart(exportOption){var self=this,chartInstance=self.getFromEnv(\"chartInstance\"),chart=self.getFromEnv(\"chart\"),exportOptionsLowerKeys=isObject(exportOption)&&copyExportOptions(exportOption)||{},optionsExport=(0,_lib.extend2)((0,_lib.extend2)({},self.config.exportOption),exportOptionsLowerKeys),exportFormat=(optionsExport.exportformat||_exportUtils.EXPORTFORMAT.PNG).toLowerCase(),exportHandler=optionsExport.exporthandler,exportAction=optionsExport.exportaction,exportTargetWindow=optionsExport.exporttargetwindow||\"\",exportFileName=optionsExport.exportfilename,exportParameters=optionsExport.exportparameters,exportCallback=optionsExport.exportcallback,exportWithImages=optionsExport.exportwithimages,exportMode=optionsExport.exportmode,logEnabled=optionsExport.logenabled,logHandler=optionsExport.loghandler,logMode=optionsExport.logmode,xlsArr,csv,csvUri,undef,fireExportDataReadyEventOnChart=function fireExportDataReadyEventOnChart(postData){chart.fireChartInstanceEvent(\"exportDataReady\",postData)};chart.fireChartInstanceEvent(\"beforeExport\",optionsExport,undef,(function(){var chartId=chartInstance.id,chartCaption=self.config.chartConfig.caption,chartSubcaption=self.config.chartConfig.subcaption,paper=this.apiInstance.getFromEnv(\"paper\"),useCanvas=this.apiInstance.getFromEnv(\"core-options\")[\"export\"].useCanvas,postData,svg,svgForClientSideExport,menuBar=(0,_arrayHasContent.default)(chart.getChildren(\"chartMenuBar\"))?chart.getChildren(\"chartMenuBar\")[0]:chart.getChildren(\"actionBar\")[0],hamBurger=menuBar.getChild(\"hamburgerMenu-\"+menuBar.getId()+\"-\"+chart.getId()+\"-0\"),containerGroup,clientSideExportedEventsParam={DOMId:chartId,height:paper.height,width:paper.width,fileName:exportFileName+\".\"+exportFormat,statusCode:undef,statusMessage:undef,notice:undef},exportOptionObject={exportAction:exportAction,exportTargetWindow:exportTargetWindow,exportCallback:exportCallback,fusionCharts:chartInstance,paper:paper,chartId:chartId,exportHandler:exportHandler,logEnabled:logEnabled,logMode:logMode,logHandler:logHandler},createPostDataForExport=function createPostDataForExport(streamType,streamValue,configuredExportAction){var _logEnabled;_logEnabled=!!logEnabled;if(logMode===_exportUtils.LOGMODE.CLIENT){_logEnabled=false}return{charttype:chartInstance.chartType(),stream_type:streamType||\"\",stream:streamValue||\"\",meta_bgColor:optionsExport.bgcolor||\"\",meta_bgAlpha:optionsExport.bgalpha||\"1\",meta_DOMId:chartInstance.id,meta_width:paper.width||self.config.chartConfig.width,meta_height:paper.height||self.config.chartConfig.height,chart_caption:chartCaption,chart_sub_caption:chartSubcaption,is_single_export:true,is_full_version:!true,version:_lib.PROJECT_VERSION,user_time_zone:-(new Date).getTimezoneOffset(),log_enabled:_logEnabled,parameters:[\"exportfilename=\"+exportFileName,\"exportformat=\"+exportFormat,\"exportaction=\"+(0,_exportUtils.createExportActionOldString)(exportAction),\"exportactionnew=\"+exportAction,\"configuredexportaction=\"+(configuredExportAction||exportAction),\"exportparameters=\"+exportParameters].join(\"|\")}},createPostDataForLog=function createPostDataForLog(){return{chartType:chartInstance.chartType(),chartCaption:chartCaption,chartSubCaption:chartSubcaption,isSingleExport:true,isFullVersion:!true,exportAction:exportAction,userTimeZone:-(new Date).getTimezoneOffset(),exportFileName:[exportFileName,exportFormat].join(\".\"),exportFormat:exportFormat,version:_lib.PROJECT_VERSION}},noPrepareAndExportData=function noPrepareAndExportData(svgToExport){(0,_libSvgToCanvas.downloadCharts)(null,null,null,createPostDataForExport(_exportUtils.EXPORTFORMAT.SVG,svgToExport),exportOptionObject)},prepareAndExportData=function prepareAndExportData(svgToExportURL){var canvas,exportPostData,svgToExport=svgToExportURL;if(_libSvgToCanvas.browserDetails.hasCanvas&&typeof win.btoa!==\"undefined\"){canvas=doc.createElement(\"canvas\");canvas.width=paper.width;canvas.height=paper.height;svgToExport=(0,_exportUtils.embedImagesWithNonDataURL)(svgToExport);svgForClientSideExport=(0,_exportUtils.replaceImagesWithNonDataUrl)(svgForClientSideExport);if((0,_exportUtils.hasUndownloadableImage)(svgToExport)||exportFormat===_exportUtils.EXPORTFORMAT.SVG){exportPostData=createPostDataForExport(_exportUtils.EXPORTFORMAT.SVG,svgToExport);(0,_libSvgToCanvas.downloadCharts)(null,null,null,exportPostData,exportOptionObject)}else{(0,_libSvgToCanvas.drawSvgOnCanvas)({svg:svgForClientSideExport,canvas:canvas,x:0,y:0,width:paper.width,height:paper.height,useCanvas:useCanvas},(function(){var dataURI;switch(exportFormat){case _exportUtils.EXPORTFORMAT.PNG:dataURI=canvas.toDataURL(\"image/png\");break;case _exportUtils.EXPORTFORMAT.JPEG:dataURI=canvas.toDataURL(\"image/jpeg\");break;case _exportUtils.EXPORTFORMAT.PDF:(0,_jpegToPdf.addImage)(canvas.toDataURL(\"image/jpeg\"),paper.height,paper.width);dataURI=(0,_jpegToPdf.getDataUrl)();break;default:dataURI=canvas.toDataURL(\"image/jpeg\");break}exportPostData=createPostDataForExport(IMAGEDATA,dataURI);(0,_libSvgToCanvas.downloadCharts)(null,null,null,exportPostData,exportOptionObject)}))}}else{noPrepareAndExportData(svgToExport)}},getImageDataUrl=function getImageDataUrl(type,callback,exportOptions){var canvas;canvas=doc.createElement(\"canvas\");canvas.width=paper.width;canvas.height=paper.height;(0,_libSvgToCanvas.drawSvgOnCanvas)({svg:svgForClientSideExport,canvas:canvas,x:0,y:0,width:paper.width,height:paper.height,useCanvas:useCanvas},(function(){switch(type){case _exportUtils.EXPORTFORMAT.PNG:callback(type,canvas.toDataURL(\"image/png\"),exportFileName,exportOptions);break;case _exportUtils.EXPORTFORMAT.JPEG:callback(type,canvas.toDataURL(\"image/jpeg\"),exportFileName,exportOptions);break;case _exportUtils.EXPORTFORMAT.PDF:callback(type,canvas.toDataURL(\"image/jpeg\"),exportFileName,exportOptions);break;default:callback(type,canvas.toDataURL(\"image/jpeg\"),exportFileName,exportOptions);break}}))},prepareClientSideDownload=function prepareClientSideDownload(exportFrmt,userImageUrl,exprtFileName,downloadOptions,mode){var imageUrl=userImageUrl;if(exportFrmt===_exportUtils.EXPORTFORMAT.PDF){(0,_jpegToPdf.addImage)(imageUrl,paper.height,paper.width);imageUrl=(0,_jpegToPdf.getDataUrl)()}if(mode===_exportUtils.EXPORTMODE.AUTO){postData=createPostDataForExport(IMAGEDATA,imageUrl)}else{postData=null}(0,_libSvgToCanvas.downloadCharts)(\"url\",imageUrl,exprtFileName+\".\"+exportFrmt,postData,downloadOptions)},saveAfterProcessingAtClientSide=function saveAfterProcessingAtClientSide(svgToExport,exportOptions,callback){var svgDataURI,callbackModified;if(exportFormat===_exportUtils.EXPORTFORMAT.SVG){svgDataURI=(0,_exportUtils.svgStrToDataUrl)(svgToExport);callback(svgDataURI,exportOptions)}else{callbackModified=function callbackModified(){callback(arguments[1],exportOptions)};getImageDataUrl(exportFormat,callbackModified,exportOptions)}},exportAtClientSide=function exportAtClientSide(svgToBeExported,exportOptions,mode){var svgDataURI,prepareClientSideDownloadModified;if(exportFormat===_exportUtils.EXPORTFORMAT.SVG){svgDataURI=(0,_exportUtils.svgStrToDataUrl)(svgToBeExported);if(mode===_exportUtils.EXPORTMODE.AUTO){postData=createPostDataForExport(IMAGEDATA,svgDataURI)}else{postData=null}(0,_libSvgToCanvas.downloadCharts)(\"url\",svgDataURI,exportFileName+\".\"+exportFormat,postData,exportOptions)}else{prepareClientSideDownloadModified=function prepareClientSideDownloadModified(){prepareClientSideDownload(arguments[0],arguments[1],arguments[2],arguments[3],mode)};getImageDataUrl(exportFormat,prepareClientSideDownloadModified,exportOptions)}},createXlsArr=function createXlsArr(){var count=0;xlsArr=[];csv.replace(/[^\\r\\n]+/g,(function(match){xlsArr[count]=[];xlsArr[count]=match.split(/,(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/).map((function(x){return x.replace(/\"/g,_lib.BLANKSTRING)}));count+=1}))},raiseEventExportDataReady=fireExportDataReadyEventOnChart,logSeparatelyIfLogModeCLient=function logSeparatelyIfLogModeCLient(mode){if(mode===_exportUtils.LOGMODE.CLIENT){(0,_exportUtils.logCharts)(createPostDataForLog(),exportOptionObject)}},handleCSVandXLSXexport=function handleCSVandXLSXexport(uri,encodeStr){browserCanSelfDownload=typeof win.btoa!==\"undefined\"&&(_libSvgToCanvas.browserDetails.name===\"Chrome\"||_libSvgToCanvas.browserDetails.name===\"Firefox\"||_libSvgToCanvas.browserDetails.name===\"Safari\"||_libSvgToCanvas.browserDetails.name===\"Edge\"||_libSvgToCanvas.browserDetails.name===\"ie\");if(exportMode!==\"server\"&&browserCanSelfDownload){if(exportAction===_exportUtils.EXPORTACTION.DOWNLOAD||exportAction===_exportUtils.EXPORTACTION.DOWNLOADSAVE){(0,_libSvgToCanvas.downloadCharts)(\"blob\",uri,exportFileName+\".\"+exportFormat,null,exportOptionObject);chart.fireChartInstanceEvent(\"exported\",clientSideExportedEventsParam)}if(exportAction===_exportUtils.EXPORTACTION.SAVE||exportAction===_exportUtils.EXPORTACTION.DOWNLOADSAVE){configuredExportAction=exportAction;if(exportAction===_exportUtils.EXPORTACTION.DOWNLOADSAVE){exportAction=_exportUtils.EXPORTACTION.SAVE}postData=createPostDataForExport(IMAGEDATA,uri,configuredExportAction);(0,_libSvgToCanvas.downloadCharts)(null,null,null,postData,exportOptionObject);logSeparatelyIfLogModeCLient(logMode)}else if(logMode!==_exportUtils.LOGMODE.SERVER){(0,_exportUtils.logCharts)(createPostDataForLog(),exportOptionObject)}}else{var fileReader=new FileReader;fileReader.onload=function serverSideExport(e){var tempUintArrayStr=_lib.BLANKSTRING,bytes=new Uint8Array(e.target.result),length=bytes.byteLength;for(var i=0;i<length;i++){tempUintArrayStr+=String.fromCharCode(bytes[i])}tempUintArrayStr=encodeStr+win.btoa(tempUintArrayStr);(0,_libSvgToCanvas.downloadCharts)(null,null,null,createPostDataForExport(IMAGEDATA,tempUintArrayStr),exportOptionObject);logSeparatelyIfLogModeCLient(logMode)};fileReader.readAsArrayBuffer(uri)}},browserCanSelfDownload,configuredExportAction,exportJSONtoEXCEL,dontCacheImages;if(exportFormat===\"xlsx\"){if(typeof win.btoa!==\"undefined\"){csv=chartInstance.getCSVData()}else{chart.fireChartInstanceEvent(\"exportCancelled\",optionsExport);return false}raiseEventExportDataReady();createXlsArr();exportJSONtoEXCEL=(0,_index2.getDep)(\"ExcelExport\");exportJSONtoEXCEL&&exportJSONtoEXCEL(xlsArr).then((function(content){handleCSVandXLSXexport(content,\"data:application/vnd.ms-excel;base64,\")}))}else if(exportFormat===\"csv\"){if(typeof win.btoa!==\"undefined\"){csv=chartInstance.getCSVData()}else{chart.fireChartInstanceEvent(\"exportCancelled\",optionsExport);return false}raiseEventExportDataReady();csvUri=new Blob([csv],{type:\"text/csv;base64;\"});handleCSVandXLSXexport(csvUri,\"data:text/csv;base64,\")}else{containerGroup=hamBurger.getChild(\"listContainer\").getLinkedParent().getGraphicalElement(\"button\",\"button\");containerGroup&&containerGroup.attr(\"visibility\",\"hidden\");svg=paper.toSVG(exportWithImages);svgForClientSideExport=paper.toSVG(exportWithImages&&(0,_libSvgToCanvas.isCanvasElemSupported)());svgForClientSideExport=svgForClientSideExport.replace(/&nbsp;/gi,\" \");containerGroup&&containerGroup.attr(\"visibility\",\"visible\");svg=svg.replace(/(\\sd\\s*=\\s*[\"'])[M\\s\\d\\.]*([\"'])/gi,\"$1M 0 0 L 0 0$2\");svg=svg.replace(/NS\\d+:/gi,\"xlink:\");svg=svg.replace(/&nbsp;/gi,\" \");svgForClientSideExport=svgForClientSideExport.replace(/NS\\d+:/gi,\"xlink:\");svgForClientSideExport=svgForClientSideExport.replace(/(\\sd\\s*=\\s*[\"'])[M\\s\\d\\.]*([\"'])/gi,\"$1M 0 0 L 0 0$2\");svgForClientSideExport=svgForClientSideExport.replace(/(xlink:title\\s*=\\s*)['\"].*?[\"']/gi,\"\");svg=svg.replace(/[\\w\\-]+\\=\\\"undefined\\\"/gi,\"\");svg=svg.replace(/(xlink:title\\s*=\\s*)['\"].*?[\"']/gi,\"\");svg=svg.replace(/rgba\\(([^\\)]+)\\)/gi,(function(RGBStr){return\"#\"+new _lib.RGBtoHex(RGBStr.split(\",\"))}));svg=svg.replace(/<svg[^>]+/i,(function(svgString){var str=svgString;if(!str.match(/height/i)&&(paper.height||self.config.chartConfig.height)){str+=' height=\"'+(paper.height||self.config.chartConfig.height)+'\"'}if(!str.match(/width/i)&&(paper.width||self.config.chartConfig.width)){str+=' width=\"'+(paper.width||self.config.chartConfig.width)+'\"'}return str}));svg=svg.replace(/(([\\w]+\\-)?opacity\\s*=\\s*)['\"][\\d\\.]+e[\\-\\+][\\d]+[\"']/gi,'$1\"0.001\"');svg=svg.replace(/(([\\w]+\\-)?opacity\\s*:\\s*)[\\d\\.]+e[\\-\\+][\\d]+/gi,\"$10.001\");svg=svg.replace(/<text[^\\>]+/gi,(function(text){var fullText=text;fullText=fullText.replace(/stroke\\=[\\\"\\']([a-z0-9\\#]+)?[\\\"\\']/gi,\"\");fullText=fullText.replace(/stroke\\s*\\:\\s*([a-z0-9\\#]+)?;?/gi,\"\");fullText=fullText.replace(/stroke-width\\=[\\\"\\']([a-z0-9\\#]+)?[\\\"\\']/gi,\"\");fullText=fullText.replace(/stroke-width\\s*\\:\\s*([a-z0-9\\#]+)?;?/gi,\"\");fullText=fullText.replace(/stroke-opacity\\=[\\\"\\']([a-z0-9\\#]+)?[\\\"\\']/gi,\"\");fullText=fullText.replace(/stroke-opacity\\s*\\:\\s*([a-z0-9\\#]+)?;?/gi,\"\");fullText=fullText.replace(/(<text[^\\>]+fill\\=)([\\\"\\'][^\\\"\\']+[\\\"\\'])([^\\>]+)/gi,'$1$2 stroke=$2 stroke-width=\"0.2\"$3');fullText=fullText.replace(/(<text[^\\>]+fill-opacity\\=)([\\\"\\'][^\\\"\\']+[\\\"\\'])([^\\>]+)/gi,\"$1$2 stroke-opacity=$2 $3\");return fullText}));svg=svg.replace(/<(\\b[^<>s\\s]+\\b)[^\\>]+?opacity\\s*=\\s*['\"][^1][^\\>]+?(\\/>|>[\\s\\r\\n]*?<\\/\\1>)/gi,(function(fullText,tagName){var recrXCommand=xAttrRegx.exec(fullText)||\"\",recrYCommand=yAttrRegx.exec(fullText)||\"\",prop;prop=' opacity=\"1\" stroke-opacity=\"1\" fill=\"#cccccc\" stroke-width=\"0\" r=\"0\" height=\"0.5\" width=\"0.5\" d=\"M 0 0 L 1 1\" />';return fullText+\"<\"+tagName+recrXCommand+recrYCommand+prop}));svg=(0,_exportUtils.makeImageUrlsAbsolute)(svg);svgForClientSideExport=(0,_exportUtils.makeImageUrlsAbsolute)(svgForClientSideExport);dontCacheImages=exportMode===_exportUtils.EXPORTMODE.SERVER;(0,_exportUtils.cacheAllImages)(svg,dontCacheImages,(function(){postData=createPostDataForExport(_exportUtils.EXPORTFORMAT.SVG,svg);raiseEventExportDataReady(postData);postData=null;var configuredExptAction,canBrowserSelfDownload=typeof win.btoa!==\"undefined\"&&(_libSvgToCanvas.browserDetails.name===\"Chrome\"||_libSvgToCanvas.browserDetails.name===\"Firefox\"||_libSvgToCanvas.browserDetails.name===\"Safari\"||_libSvgToCanvas.browserDetails.name===\"Edge\"||_libSvgToCanvas.browserDetails.name===\"ie\");if((exportMode===_exportUtils.EXPORTMODE.CLIENT||exportMode===_exportUtils.EXPORTMODE.AUTO&&!(0,_exportUtils.hasUndownloadableImage)(svg))&&canBrowserSelfDownload){svgForClientSideExport=(0,_exportUtils.replaceImagesWithNonDataUrl)(svgForClientSideExport);if(exportAction===_exportUtils.EXPORTACTION.DOWNLOAD||exportAction===_exportUtils.EXPORTACTION.DOWNLOADSAVE){exportAtClientSide(svgForClientSideExport,exportOptionObject,exportMode);chart.fireChartInstanceEvent(\"exported\",clientSideExportedEventsParam)}if(exportAction===_exportUtils.EXPORTACTION.SAVE||exportAction===_exportUtils.EXPORTACTION.DOWNLOADSAVE){configuredExptAction=exportAction;if(exportAction===_exportUtils.EXPORTACTION.DOWNLOADSAVE){exportAction=_exportUtils.EXPORTACTION.SAVE}saveAfterProcessingAtClientSide(svgForClientSideExport,exportOptionObject,(function(dataUri,exportOptionObj){postData=createPostDataForExport(IMAGEDATA,dataUri,configuredExptAction);(0,_libSvgToCanvas.downloadCharts)(null,null,null,postData,exportOptionObj);logSeparatelyIfLogModeCLient(logMode)}));chart.fireChartInstanceEvent(\"exported\",clientSideExportedEventsParam)}else if(logMode!==_exportUtils.LOGMODE.SERVER){(0,_exportUtils.logCharts)(createPostDataForLog(),exportOptionObject)}}else if(exportMode===_exportUtils.EXPORTMODE.AUTO){prepareAndExportData(svg);logSeparatelyIfLogModeCLient(logMode)}else if(exportMode===_exportUtils.EXPORTMODE.SERVER){noPrepareAndExportData(svg);logSeparatelyIfLogModeCLient(logMode)}}))}}),(function(){chart.fireChartInstanceEvent(\"exportCancelled\",optionsExport)}))};return ExportModule}(_index.ComponentInterface);exports.default=ExportModule;"]},"metadata":{},"sourceType":"script"}